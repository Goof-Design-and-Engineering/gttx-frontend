import{S as Ae,i as De,s as Ue,D as Qe,a as w,k as p,e as Be,c as R,l as d,m as h,h as s,b as k,H as Xe,g as fe,w as je,d as be,f as Je,L as Me,o as Ke,O as Ze,r as b,u as v,v as $,x as $e,P as xe,z as Ge,A as We,B as Ye,Q as et,C as qe,R as tt,n as le,p as A,G as a,T as lt,U as ot,q as rt,V as Ce,M as me,W as Fe,X as Ve,Y as at,N as it}from"../chunks/index.d8729f0b.js";import{u as nt}from"../chunks/useForm.f7d2ec9d.js";import{v as st,r as ut}from"../chunks/validators.6e79bf68.js";import{c as ft,p as ue}from"../chunks/pocketbase.f160ef4f.js";import{g as Ee}from"../chunks/navigation.9bfe8c8c.js";import{M as ct}from"../chunks/Modal.0c83b870.js";function Le(u,e,l){const t=u.slice();return t[20]=e[l],t[22]=l,t}function He(u){let e;return{c(){e=b(u[2])},l(l){e=v(l,u[2])},m(l,t){k(l,e,t)},p(l,t){t&4&&$(e,l[2])},d(l){l&&s(e)}}}function _t(u){return{c:le,l:le,m:le,p:le,d:le}}function pt(u){let e,l,t,_=(u[0]||"Organization Name")+"",r,i,o,n,c,f,E,N,B,O,L,M,I,y,g,U,Y,T,H,C,S,oe,x,D,J,q,K,W,re,Z,ee,G=[],j=new Map,F,V,z,ie,te,ne,ae=u[1];const Q=m=>m[20].id;for(let m=0;m<ae.length;m+=1){let P=Le(u,ae,m),X=Q(P);j.set(X,G[m]=Se(X,P))}return{c(){e=p("header"),l=p("hgroup"),t=p("h1"),r=b(_),i=w(),o=p("h2"),n=b("Time for a change?"),c=w(),f=p("details"),E=p("summary"),N=b("Invite Codes"),B=w(),O=p("ul"),L=p("li"),M=p("p"),I=p("b"),y=b("Participant"),g=b(": "),U=b(u[3]),Y=w(),T=p("li"),H=p("p"),C=p("b"),S=b("Observer"),oe=b(": "),x=b(u[5]),D=w(),J=p("li"),q=p("p"),K=p("b"),W=b("Facilitator"),re=b(": "),Z=b(u[4]),ee=w();for(let m=0;m<G.length;m+=1)G[m].c();F=w(),V=p("footer"),z=p("br"),ie=w(),te=p("button"),ne=b("Save Changes"),this.h()},l(m){e=d(m,"HEADER",{});var P=h(e);l=d(P,"HGROUP",{});var X=h(l);t=d(X,"H1",{});var Oe=h(t);r=v(Oe,_),Oe.forEach(s),i=R(X),o=d(X,"H2",{});var ke=h(o);n=v(ke,"Time for a change?"),ke.forEach(s),X.forEach(s),P.forEach(s),c=R(m),f=d(m,"DETAILS",{});var ce=h(f);E=d(ce,"SUMMARY",{role:!0,class:!0});var ye=h(E);N=v(ye,"Invite Codes"),ye.forEach(s),B=R(ce),O=d(ce,"UL",{});var se=h(O);L=d(se,"LI",{});var Te=h(L);M=d(Te,"P",{id:!0});var _e=h(M);I=d(_e,"B",{});var ge=h(I);y=v(ge,"Participant"),ge.forEach(s),g=v(_e,": "),U=v(_e,u[3]),_e.forEach(s),Te.forEach(s),Y=R(se),T=d(se,"LI",{});var Pe=h(T);H=d(Pe,"P",{id:!0});var pe=h(H);C=d(pe,"B",{});var we=h(C);S=v(we,"Observer"),we.forEach(s),oe=v(pe,": "),x=v(pe,u[5]),pe.forEach(s),Pe.forEach(s),D=R(se),J=d(se,"LI",{});var Re=h(J);q=d(Re,"P",{id:!0});var de=h(q);K=d(de,"B",{});var Ie=h(K);W=v(Ie,"Facilitator"),Ie.forEach(s),re=v(de,": "),Z=v(de,u[4]),de.forEach(s),Re.forEach(s),se.forEach(s),ce.forEach(s),ee=R(m);for(let ve=0;ve<G.length;ve+=1)G[ve].l(m);F=R(m),V=d(m,"FOOTER",{});var he=h(V);z=d(he,"BR",{}),ie=R(he),te=d(he,"BUTTON",{});var Ne=h(te);ne=v(Ne,"Save Changes"),Ne.forEach(s),he.forEach(s),this.h()},h(){A(E,"role","button"),A(E,"class","secondary"),A(M,"id","p_code"),A(H,"id","o_code"),A(q,"id","f_code"),f.open=!0},m(m,P){k(m,e,P),a(e,l),a(l,t),a(t,r),a(l,i),a(l,o),a(o,n),k(m,c,P),k(m,f,P),a(f,E),a(E,N),a(f,B),a(f,O),a(O,L),a(L,M),a(M,I),a(I,y),a(M,g),a(M,U),a(O,Y),a(O,T),a(T,H),a(H,C),a(C,S),a(H,oe),a(H,x),a(O,D),a(O,J),a(J,q),a(q,K),a(K,W),a(q,re),a(q,Z),k(m,ee,P);for(let X=0;X<G.length;X+=1)G[X].m(m,P);k(m,F,P),k(m,V,P),a(V,z),a(V,ie),a(V,te),a(te,ne)},p(m,P){P&1&&_!==(_=(m[0]||"Organization Name")+"")&&$(r,_),P&8&&$(U,m[3]),P&32&&$(x,m[5]),P&16&&$(Z,m[4]),P&4610&&(ae=m[1],G=lt(G,P,Q,1,m,ae,j,F.parentNode,ot,Se,F,Le))},d(m){m&&s(e),m&&s(c),m&&s(f),m&&s(ee);for(let P=0;P<G.length;P+=1)G[P].d(m);m&&s(F),m&&s(V)}}}function dt(u){let e=u[20].username+"",l;return{c(){l=b(e)},l(t){l=v(t,e)},m(t,_){k(t,l,_)},p(t,_){_&2&&e!==(e=t[20].username+"")&&$(l,e)},d(t){t&&s(l)}}}function ht(u){let e,l=u[20].username+"",t,_;return{c(){e=p("b"),t=b(l),_=b(" (that's you!)")},l(r){e=d(r,"B",{});var i=h(e);t=v(i,l),_=v(i," (that's you!)"),i.forEach(s)},m(r,i){k(r,e,i),a(e,t),a(e,_)},p(r,i){i&2&&l!==(l=r[20].username+"")&&$(t,l)},d(r){r&&s(e)}}}function mt(u){let e,l,t,_,r,i;function o(f,E){return f[20].role=="facilitator"?Ot:f[20].role=="participant"?Et:vt}let n=o(u),c=n(u);return{c(){e=p("select"),c.c(),l=w(),t=p("button"),_=b("Remove"),this.h()},l(f){e=d(f,"SELECT",{});var E=h(e);c.l(E),E.forEach(s),l=R(f),t=d(f,"BUTTON",{class:!0});var N=h(t);_=v(N,"Remove"),N.forEach(s),this.h()},h(){A(t,"class","primary")},m(f,E){k(f,e,E),c.m(e,null),k(f,l,E),k(f,t,E),a(t,_),r||(i=me(t,"click",function(){Ve(u[12](u[20]))&&u[12](u[20]).apply(this,arguments)}),r=!0)},p(f,E){u=f,n!==(n=o(u))&&(c.d(1),c=n(u),c&&(c.c(),c.m(e,null)))},d(f){f&&s(e),c.d(),f&&s(l),f&&s(t),r=!1,i()}}}function bt(u){let e,l,t,_,r,i;return{c(){e=p("select"),l=p("option"),t=b("Facilitator"),_=w(),r=p("button"),i=b("Remove"),this.h()},l(o){e=d(o,"SELECT",{});var n=h(e);l=d(n,"OPTION",{});var c=h(l);t=v(c,"Facilitator"),c.forEach(s),n.forEach(s),_=R(o),r=d(o,"BUTTON",{class:!0});var f=h(r);i=v(f,"Remove"),f.forEach(s),this.h()},h(){l.__value="facilitator",l.value=l.__value,e.disabled=!0,A(r,"class","primary"),r.disabled="true"},m(o,n){k(o,e,n),a(e,l),a(l,t),k(o,_,n),k(o,r,n),a(r,i)},p:le,d(o){o&&s(e),o&&s(_),o&&s(r)}}}function vt(u){let e,l,t,_,r,i;return{c(){e=p("option"),l=b("Facilitator"),t=p("option"),_=b("Participant"),r=p("option"),i=b("Observer"),this.h()},l(o){e=d(o,"OPTION",{});var n=h(e);l=v(n,"Facilitator"),n.forEach(s),t=d(o,"OPTION",{});var c=h(t);_=v(c,"Participant"),c.forEach(s),r=d(o,"OPTION",{});var f=h(r);i=v(f,"Observer"),f.forEach(s),this.h()},h(){e.__value="facilitator",e.value=e.__value,t.__value="participant",t.value=t.__value,r.__value="observer",r.value=r.__value,r.selected=!0},m(o,n){k(o,e,n),a(e,l),k(o,t,n),a(t,_),k(o,r,n),a(r,i)},d(o){o&&s(e),o&&s(t),o&&s(r)}}}function Et(u){let e,l,t,_,r,i;return{c(){e=p("option"),l=b("Facilitator"),t=p("option"),_=b("Participant"),r=p("option"),i=b("Observer"),this.h()},l(o){e=d(o,"OPTION",{});var n=h(e);l=v(n,"Facilitator"),n.forEach(s),t=d(o,"OPTION",{});var c=h(t);_=v(c,"Participant"),c.forEach(s),r=d(o,"OPTION",{});var f=h(r);i=v(f,"Observer"),f.forEach(s),this.h()},h(){e.__value="facilitator",e.value=e.__value,t.__value="participant",t.value=t.__value,t.selected=!0,r.__value="observer",r.value=r.__value},m(o,n){k(o,e,n),a(e,l),k(o,t,n),a(t,_),k(o,r,n),a(r,i)},d(o){o&&s(e),o&&s(t),o&&s(r)}}}function Ot(u){let e,l,t,_,r,i;return{c(){e=p("option"),l=b("Facilitator"),t=p("option"),_=b("Participant"),r=p("option"),i=b("Observer"),this.h()},l(o){e=d(o,"OPTION",{});var n=h(e);l=v(n,"Facilitator"),n.forEach(s),t=d(o,"OPTION",{});var c=h(t);_=v(c,"Participant"),c.forEach(s),r=d(o,"OPTION",{});var f=h(r);i=v(f,"Observer"),f.forEach(s),this.h()},h(){e.__value="facilitator",e.value=e.__value,e.selected=!0,t.__value="participant",t.value=t.__value,r.__value="observer",r.value=r.__value},m(o,n){k(o,e,n),a(e,l),k(o,t,n),a(t,_),k(o,r,n),a(r,i)},d(o){o&&s(e),o&&s(t),o&&s(r)}}}function Se(u,e){let l,t,_,r,i,o,n,c,f,E;function N(y,g){return y[20].id==y[9].id?ht:dt}let B=N(e),O=B(e);function L(y,g){return y[20].id==y[9].id?bt:mt}let M=L(e),I=M(e);return{key:u,first:null,c(){l=p("div"),O.c(),t=w(),_=p("hr"),r=w(),i=p("div"),o=p("input"),c=w(),I.c(),f=w(),E=p("br"),this.h()},l(y){l=d(y,"DIV",{});var g=h(l);O.l(g),t=R(g),_=d(g,"HR",{}),r=R(g),i=d(g,"DIV",{class:!0});var U=h(i);o=d(U,"INPUT",{type:!0,"aria-invalid":!0}),c=R(U),I.l(U),U.forEach(s),g.forEach(s),f=R(y),E=d(y,"BR",{}),this.h()},h(){A(o,"type","text"),o.value=n=e[20].email,A(o,"aria-invalid","false"),o.disabled=!0,A(i,"class","grid"),this.first=l},m(y,g){k(y,l,g),O.m(l,null),a(l,t),a(l,_),a(l,r),a(l,i),a(i,o),a(i,c),I.m(i,null),k(y,f,g),k(y,E,g)},p(y,g){e=y,B===(B=N(e))&&O?O.p(e,g):(O.d(1),O=B(e),O&&(O.c(),O.m(l,t))),g&2&&n!==(n=e[20].email)&&o.value!==n&&(o.value=n),M===(M=L(e))&&I?I.p(e,g):(I.d(1),I=M(e),I&&(I.c(),I.m(i,null)))},d(y){y&&s(l),O.d(),I.d(),y&&s(f),y&&s(E)}}}function kt(u){let e,l,t,_,r,i,o,n,c;return{c(){e=p("center"),l=p("br"),t=w(),_=p("hgroup"),r=p("h1"),i=b("Loading..."),o=w(),n=p("h2"),c=b("Give it a second..."),this.h()},l(f){e=d(f,"CENTER",{});var E=h(e);l=d(E,"BR",{}),t=R(E),_=d(E,"HGROUP",{});var N=h(_);r=d(N,"H1",{"aria-busy":!0});var B=h(r);i=v(B,"Loading..."),B.forEach(s),o=R(N),n=d(N,"H2",{});var O=h(n);c=v(O,"Give it a second..."),O.forEach(s),N.forEach(s),E.forEach(s),this.h()},h(){A(r,"aria-busy","true")},m(f,E){k(f,e,E),a(e,l),a(e,t),a(e,_),a(_,r),a(r,i),a(_,o),a(_,n),a(n,c)},p:le,d(f){f&&s(e)}}}function ze(u){let e,l,t;function _(i){u[17](i)}let r={$$slots:{default:[yt]},$$scope:{ctx:u}};return u[6]!==void 0&&(r.showModal=u[6]),e=new ct({props:r}),$e.push(()=>xe(e,"showModal",_)),{c(){Ge(e.$$.fragment)},l(i){We(e.$$.fragment,i)},m(i,o){Ye(e,i,o),t=!0},p(i,o){const n={};o&8390016&&(n.$$scope={dirty:o,ctx:i}),!l&&o&64&&(l=!0,n.showModal=i[6],et(()=>l=!1)),e.$set(n)},i(i){t||(fe(e.$$.fragment,i),t=!0)},o(i){be(e.$$.fragment,i),t=!1},d(i){qe(e,i)}}}function yt(u){let e,l,t,_,r,i,o,n=u[7].username+"",c,f,E,N,B,O,L=u[7].username+"",M,I,y,g,U,Y,T,H,C,S,oe,x,D,J,q,K,W,re,Z,ee,G;return{c(){e=p("article"),l=p("h3"),t=b("Woah there!"),_=w(),r=p("p"),i=b("Are you sure that you want to remove "),o=p("b"),c=b(n),f=b(` from your
				organization?
				`),E=p("br"),N=p("br"),B=b(`
				If you change your mind, you'll have to send `),O=p("b"),M=b(L),I=b(` another
				invite.
				`),y=p("br"),g=p("br"),U=w(),Y=p("b"),T=b("This action can not be undone!"),H=w(),C=p("footer"),S=p("form"),oe=p("br"),x=w(),D=p("input"),J=w(),q=p("br"),K=w(),W=p("button"),re=b("Confirm"),this.h()},l(j){e=d(j,"ARTICLE",{});var F=h(e);l=d(F,"H3",{});var V=h(l);t=v(V,"Woah there!"),V.forEach(s),_=R(F),r=d(F,"P",{});var z=h(r);i=v(z,"Are you sure that you want to remove "),o=d(z,"B",{});var ie=h(o);c=v(ie,n),ie.forEach(s),f=v(z,` from your
				organization?
				`),E=d(z,"BR",{}),N=d(z,"BR",{}),B=v(z,`
				If you change your mind, you'll have to send `),O=d(z,"B",{});var te=h(O);M=v(te,L),te.forEach(s),I=v(z,` another
				invite.
				`),y=d(z,"BR",{}),g=d(z,"BR",{}),U=R(z),Y=d(z,"B",{style:!0});var ne=h(Y);T=v(ne,"This action can not be undone!"),ne.forEach(s),z.forEach(s),H=R(F),C=d(F,"FOOTER",{});var ae=h(C);S=d(ae,"FORM",{method:!0});var Q=h(S);oe=d(Q,"BR",{}),x=R(Q),D=d(Q,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),J=R(Q),q=d(Q,"BR",{}),K=R(Q),W=d(Q,"BUTTON",{"data-target":!0});var m=h(W);re=v(m,"Confirm"),m.forEach(s),Q.forEach(s),ae.forEach(s),F.forEach(s),this.h()},h(){rt(Y,"color","red"),A(D,"type","password"),A(D,"name","del_confirm_pass"),A(D,"id","del_confrim_pass"),A(D,"placeholder","Your current password, please!"),A(W,"data-target","modal-example"),W.disabled=Z=!u[10].valid,A(S,"method","POST")},m(j,F){k(j,e,F),a(e,l),a(l,t),a(e,_),a(e,r),a(r,i),a(r,o),a(o,c),a(r,f),a(r,E),a(r,N),a(r,B),a(r,O),a(O,M),a(r,I),a(r,y),a(r,g),a(r,U),a(r,Y),a(Y,T),a(e,H),a(e,C),a(C,S),a(S,oe),a(S,x),a(S,D),Ce(D,u[8]),a(S,J),a(S,q),a(S,K),a(S,W),a(W,re),ee||(G=[me(D,"input",u[16]),Fe(st.call(null,D,[ut])),me(W,"click",function(){Ve(u[14](u[7].id))&&u[14](u[7].id).apply(this,arguments)}),Fe(u[11].call(null,S)),me(S,"submit",at(u[15]))],ee=!0)},p(j,F){u=j,F&128&&n!==(n=u[7].username+"")&&$(c,n),F&128&&L!==(L=u[7].username+"")&&$(M,L),F&256&&D.value!==u[8]&&Ce(D,u[8]),F&1024&&Z!==(Z=!u[10].valid)&&(W.disabled=Z)},d(j){j&&s(e),ee=!1,it(G)}}}function Tt(u){let e,l,t,_,r,i=u[2]!=""&&He(u),o={ctx:u,current:null,token:null,hasCatch:!1,pending:kt,then:pt,catch:_t};Qe(u[13](),o);let n=u[6]&&ze(u);return{c(){i&&i.c(),e=w(),l=p("article"),o.block.c(),t=w(),n&&n.c(),_=Be()},l(c){i&&i.l(c),e=R(c),l=d(c,"ARTICLE",{});var f=h(l);o.block.l(f),f.forEach(s),t=R(c),n&&n.l(c),_=Be()},m(c,f){i&&i.m(c,f),k(c,e,f),k(c,l,f),o.block.m(l,o.anchor=null),o.mount=()=>l,o.anchor=null,k(c,t,f),n&&n.m(c,f),k(c,_,f),r=!0},p(c,[f]){u=c,u[2]!=""?i?i.p(u,f):(i=He(u),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null),Xe(o,u,f),u[6]?n?(n.p(u,f),f&64&&fe(n,1)):(n=ze(u),n.c(),fe(n,1),n.m(_.parentNode,_)):n&&(je(),be(n,1,1,()=>{n=null}),Je())},i(c){r||(fe(n),r=!0)},o(c){be(n),r=!1},d(c){i&&i.d(c),c&&s(e),c&&s(l),o.block.d(),o.token=null,o=null,c&&s(t),n&&n.d(c),c&&s(_)}}}function gt(u,e,l){let t,_;Me(u,ft,T=>l(9,t=T));const r=nt();Me(u,r,T=>l(10,_=T));let i,o,n=[],c="",f="",E="",N="",B=!1,O;var L="";function M(T){l(7,O=T),l(6,B=!0)}Ke(async()=>{if(t==null){Ee("createorg");return}if((t==null?void 0:t.org)==""){Ee("createorg");return}if(t.role!="facilitator"){Ee("/dashboard");return}}),Ze(()=>{i==null||i()});async function I(){const T=await ue.collection("organization").getOne(t==null?void 0:t.org,{expand:"members"});l(1,n=[...n,...T.expand.members]),l(0,o=T.name),l(3,f=T.participant_code),l(4,E=T.facilitator_code),l(5,N=T.observer_code),i=await ue.collection("organization").subscribe(t==null?void 0:t.org,async function(H){console.log(H.record);const C=await ue.collection("organization").getOne(H.record.id,{expand:"members"});l(1,n=C.expand.members)})}async function y(T){try{await ue.collection("users").authWithPassword(t.email,L)}catch{alert("Your password was incorrect!");return}try{await ue.collection("users").update(T,{org:""})}catch(C){deleting=!1,console.log(C),alert("Something went wrong, please try again!");return}const H=n.filter(C=>C.id!==T);console.log(H),ue.collection("organization").update(t==null?void 0:t.org,{members:H.map(C=>C.id)})}function g(T){tt.call(this,u,T)}function U(){L=this.value,l(8,L)}function Y(T){B=T,l(6,B)}return[o,n,c,f,E,N,B,O,L,t,_,r,M,I,y,g,U,Y]}class Pt extends Ae{constructor(e){super(),De(this,e,gt,Tt,Ue,{})}}function wt(u){let e,l;return e=new Pt({}),{c(){Ge(e.$$.fragment)},l(t){We(e.$$.fragment,t)},m(t,_){Ye(e,t,_),l=!0},p:le,i(t){l||(fe(e.$$.fragment,t),l=!0)},o(t){be(e.$$.fragment,t),l=!1},d(t){qe(e,t)}}}class Ft extends Ae{constructor(e){super(),De(this,e,null,wt,Ue,{})}}export{Ft as default};
