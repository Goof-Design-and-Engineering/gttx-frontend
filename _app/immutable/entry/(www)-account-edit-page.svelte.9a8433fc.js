import{S as Tt,i as Bt,s as Nt,D as Ot,e as ot,b as h,H as Pt,g as $,d as rt,h as i,L as pt,o as It,R as Lt,n as w,k as f,a as R,r as M,l as d,m as k,c as U,u as z,p as b,G as u,w as St,f as Dt,x as Gt,P as Yt,z as Rt,A as Ut,q as lt,V as ut,B as At,M as Q,W as at,v as Mt,Q as Ft,C as zt,N as _t,Y as Wt}from"../chunks/index.f25a3516.js";import{u as qt,v as st,r as ct}from"../chunks/validators.75e44f34.js";import{c as Ct,a as jt,p as Z}from"../chunks/pocketbase.026f421a.js";import{g as it}from"../chunks/navigation.aabaf4cf.js";import{M as Vt}from"../chunks/Modal.5439fec8.js";function Qt(n){return{c:w,l:w,m:w,p:w,i:w,o:w,d:w}}function Jt(n){let e,l,t={ctx:n,current:null,token:null,hasCatch:!1,pending:le,then:Xt,catch:Kt,value:21,blocks:[,,,]};return Ot(Ct,t),{c(){e=ot(),t.block.c()},l(o){e=ot(),t.block.l(o)},m(o,a){h(o,e,a),t.block.m(o,t.anchor=a),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,a){n=o,Pt(t,n,a)},i(o){l||($(t.block),l=!0)},o(o){for(let a=0;a<3;a+=1){const r=t.blocks[a];rt(r)}l=!1},d(o){o&&i(e),t.block.d(o),t.token=null,t=null}}}function Kt(n){return{c:w,l:w,m:w,p:w,i:w,o:w,d:w}}function Xt(n){let e,l,t=n[6]&&wt(n);return{c(){t&&t.c(),e=ot()},l(o){t&&t.l(o),e=ot()},m(o,a){t&&t.m(o,a),h(o,e,a),l=!0},p(o,a){o[6]?t?(t.p(o,a),a&64&&$(t,1)):(t=wt(o),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(St(),rt(t,1,1,()=>{t=null}),Dt())},i(o){l||($(t),l=!0)},o(o){rt(t),l=!1},d(o){t&&t.d(o),o&&i(e)}}}function wt(n){let e,l,t,o=n[6].username+"",a,r,s,m,E,y,_,p,g,B,G,O,Y,V,T,W,q,j,L,v,A,x,F,S,P,C,H,tt,J,I,et,D,ft,mt;function Ht(c){n[19](c)}let bt={$$slots:{default:[ee]},$$scope:{ctx:n}};return n[0]!==void 0&&(bt.showModal=n[0]),I=new Vt({props:bt}),Gt.push(()=>Yt(I,"showModal",Ht)),{c(){e=f("hgroup"),l=f("h1"),t=M("Edit settings for "),a=M(o),r=R(),s=f("h2"),m=M("Express yourself!"),E=R(),y=f("label"),_=M(`Username
				
				`),p=f("input"),g=M(`

				Email Address
				
				`),B=f("input"),O=R(),Y=f("label"),V=M(`Profile Picture
					`),T=f("input"),W=R(),q=f("br"),j=R(),L=f("div"),v=f("button"),A=M("Back to Settings"),x=R(),F=f("button"),S=M("Submit"),P=R(),C=f("center"),H=f("button"),tt=M("Delete Account"),J=R(),Rt(I.$$.fragment),this.h()},l(c){e=d(c,"HGROUP",{});var N=k(e);l=d(N,"H1",{style:!0});var K=k(l);t=z(K,"Edit settings for "),a=z(K,o),K.forEach(i),r=U(N),s=d(N,"H2",{});var ht=k(s);m=z(ht,"Express yourself!"),ht.forEach(i),N.forEach(i),E=U(c),y=d(c,"LABEL",{});var X=k(y);_=z(X,`Username
				
				`),p=d(X,"INPUT",{type:!0,name:!0,id:!0}),g=z(X,`

				Email Address
				
				`),B=d(X,"INPUT",{type:!0,name:!0,id:!0}),O=U(X),Y=d(X,"LABEL",{for:!0});var dt=k(Y);V=z(dt,`Profile Picture
					`),T=d(dt,"INPUT",{type:!0,id:!0,name:!0,accept:!0}),dt.forEach(i),X.forEach(i),W=U(c),q=d(c,"BR",{}),j=U(c),L=d(c,"DIV",{class:!0});var nt=k(L);v=d(nt,"BUTTON",{class:!0});var kt=k(v);A=z(kt,"Back to Settings"),kt.forEach(i),x=U(nt),F=d(nt,"BUTTON",{});var yt=k(F);S=z(yt,"Submit"),yt.forEach(i),nt.forEach(i),P=U(c),C=d(c,"CENTER",{});var vt=k(C);H=d(vt,"BUTTON",{class:!0,"data-target":!0,style:!0,"data-tooltip":!0});var Et=k(H);tt=z(Et,"Delete Account"),Et.forEach(i),vt.forEach(i),J=U(c),Ut(I.$$.fragment,c),this.h()},h(){lt(l,"font-size","40px"),b(p,"type","text"),b(p,"name","new_username"),b(p,"id","new_username"),b(B,"type","text"),b(B,"name","new_emailaddr"),b(B,"id","new_emailaddr"),B.value=G=n[6].email,B.disabled=!0,b(T,"type","file"),b(T,"id","pfp"),b(T,"name","pfp"),b(T,"accept","image/*"),T.disabled=!0,b(Y,"for","file"),b(v,"class","secondary"),b(L,"class","grid"),b(H,"class","outline contrast"),b(H,"data-target","modal-example"),lt(H,"width","50%"),b(H,"data-tooltip","This button is dangerous!")},m(c,N){h(c,e,N),u(e,l),u(l,t),u(l,a),u(e,r),u(e,s),u(s,m),h(c,E,N),h(c,y,N),u(y,_),u(y,p),ut(p,n[3]),u(y,g),u(y,B),u(y,O),u(y,Y),u(Y,V),u(Y,T),h(c,W,N),h(c,q,N),h(c,j,N),h(c,L,N),u(L,v),u(v,A),u(L,x),u(L,F),u(F,S),h(c,P,N),h(c,C,N),u(C,H),u(H,tt),h(c,J,N),At(I,c,N),D=!0,ft||(mt=[Q(p,"input",n[15]),at(st.call(null,p,[ct])),at(st.call(null,B,[ct])),Q(T,"change",n[16]),Q(v,"click",n[11]),Q(F,"click",n[10]),Q(H,"click",n[17])],ft=!0)},p(c,N){(!D||N&64)&&o!==(o=c[6].username+"")&&Mt(a,o),N&8&&p.value!==c[3]&&ut(p,c[3]),(!D||N&64&&G!==(G=c[6].email)&&B.value!==G)&&(B.value=G);const K={};N&4194790&&(K.$$scope={dirty:N,ctx:c}),!et&&N&1&&(et=!0,K.showModal=c[0],Ft(()=>et=!1)),I.$set(K)},i(c){D||($(I.$$.fragment,c),D=!0)},o(c){rt(I.$$.fragment,c),D=!1},d(c){c&&i(e),c&&i(E),c&&i(y),c&&i(W),c&&i(q),c&&i(j),c&&i(L),c&&i(P),c&&i(C),c&&i(J),zt(I,c),ft=!1,_t(mt)}}}function gt(n){let e,l,t;function o(s,m){return s[6].role!="facilitator"?$t:Zt}let a=o(n),r=a(n);return{c(){r.c(),e=R(),l=f("br"),t=f("br")},l(s){r.l(s),e=U(s),l=d(s,"BR",{}),t=d(s,"BR",{})},m(s,m){r.m(s,m),h(s,e,m),h(s,l,m),h(s,t,m)},p(s,m){a===(a=o(s))&&r?r.p(s,m):(r.d(1),r=a(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&i(e),s&&i(l),s&&i(t)}}}function Zt(n){let e,l,t,o;return{c(){e=M('As the facilitator, your organization "'),l=f("b"),t=M(n[1]),o=M('" will be deleted as well!')},l(a){e=z(a,'As the facilitator, your organization "'),l=d(a,"B",{});var r=k(l);t=z(r,n[1]),r.forEach(i),o=z(a,'" will be deleted as well!')},m(a,r){h(a,e,r),h(a,l,r),u(l,t),h(a,o,r)},p(a,r){r&2&&Mt(t,a[1])},d(a){a&&i(e),a&&i(l),a&&i(o)}}}function $t(n){let e;return{c(){e=M("You'll need another invite code to join back into your organization.")},l(l){e=z(l,"You'll need another invite code to join back into your organization.")},m(l,t){h(l,e,t)},p:w,d(l){l&&i(e)}}}function xt(n){let e,l,t,o,a,r,s,m,E,y;return{c(){e=f("fieldset"),l=f("label"),t=f("input"),o=M(`
										I will take responsibility for my actions.`),a=R(),r=f("button"),s=M("Confirm"),this.h()},l(_){e=d(_,"FIELDSET",{});var p=k(e);l=d(p,"LABEL",{for:!0,style:!0});var g=k(l);t=d(g,"INPUT",{type:!0,id:!0,name:!0}),o=z(g,`
										I will take responsibility for my actions.`),g.forEach(i),p.forEach(i),a=U(_),r=d(_,"BUTTON",{"aria-busy":!0,"data-target":!0});var B=k(r);s=z(B,"Confirm"),B.forEach(i),this.h()},h(){b(t,"type","checkbox"),b(t,"id","org_confirm"),b(t,"name","terms"),b(l,"for","org_confirm"),lt(l,"text-align","center"),b(r,"aria-busy",n[2]),b(r,"data-target","modal-example"),r.disabled=m=!n[8].valid},m(_,p){h(_,e,p),u(e,l),u(l,t),u(l,o),h(_,a,p),h(_,r,p),u(r,s),E||(y=[at(st.call(null,t,[ct])),Q(r,"click",n[12])],E=!0)},p(_,p){p&4&&b(r,"aria-busy",_[2]),p&256&&m!==(m=!_[8].valid)&&(r.disabled=m)},d(_){_&&i(e),_&&i(a),_&&i(r),E=!1,_t(y)}}}function te(n){let e,l,t,o,a;return{c(){e=f("button"),l=M("Confirm"),this.h()},l(r){e=d(r,"BUTTON",{"data-target":!0});var s=k(e);l=z(s,"Confirm"),s.forEach(i),this.h()},h(){b(e,"data-target","modal-example"),e.disabled=t=!n[8].valid},m(r,s){h(r,e,s),u(e,l),o||(a=Q(e,"click",n[12]),o=!0)},p(r,s){s&256&&t!==(t=!r[8].valid)&&(e.disabled=t)},d(r){r&&i(e),o=!1,a()}}}function ee(n){let e,l,t,o,a,r,s,m,E,y,_,p,g,B,G,O,Y,V,T,W,q,j,L,v,A=n[7]&&gt(n);function x(P,C){return P[6].role!="facilitator"?te:xt}let F=x(n),S=F(n);return{c(){e=f("article"),l=f("hgroup"),t=f("h1"),o=M("Woah there!"),a=R(),r=f("h4"),s=M("Are you sure that you want to delete your account?"),m=R(),E=f("h5"),y=f("br"),_=R(),A&&A.c(),p=R(),g=f("input"),B=R(),G=f("footer"),O=f("form"),Y=f("br"),V=R(),T=f("input"),W=R(),q=f("br"),j=R(),S.c(),this.h()},l(P){e=d(P,"ARTICLE",{});var C=k(e);l=d(C,"HGROUP",{});var H=k(l);t=d(H,"H1",{});var tt=k(t);o=z(tt,"Woah there!"),tt.forEach(i),a=U(H),r=d(H,"H4",{});var J=k(r);s=z(J,"Are you sure that you want to delete your account?"),J.forEach(i),m=U(H),E=d(H,"H5",{});var I=k(E);y=d(I,"BR",{}),_=U(I),A&&A.l(I),p=U(I),g=d(I,"INPUT",{style:!0,type:!0}),I.forEach(i),H.forEach(i),B=U(C),G=d(C,"FOOTER",{});var et=k(G);O=d(et,"FORM",{method:!0});var D=k(O);Y=d(D,"BR",{}),V=U(D),T=d(D,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),W=U(D),q=d(D,"BR",{}),j=U(D),S.l(D),D.forEach(i),et.forEach(i),C.forEach(i),this.h()},h(){lt(g,"border","2px solid red"),lt(g,"border-radius","5px"),lt(g,"text-align","center"),b(g,"type","text"),g.value="This action can not be undone!",g.readOnly=!0,b(T,"type","password"),b(T,"name","del_confirm_pass"),b(T,"id","del_confrim_pass"),b(T,"placeholder","Your current password, please!"),b(O,"method","POST")},m(P,C){h(P,e,C),u(e,l),u(l,t),u(t,o),u(l,a),u(l,r),u(r,s),u(l,m),u(l,E),u(E,y),u(E,_),A&&A.m(E,null),u(E,p),u(E,g),u(e,B),u(e,G),u(G,O),u(O,Y),u(O,V),u(O,T),ut(T,n[5]),u(O,W),u(O,q),u(O,j),S.m(O,null),L||(v=[Q(T,"input",n[18]),at(st.call(null,T,[ct])),at(n[9].call(null,O)),Q(O,"submit",Wt(n[14]))],L=!0)},p(P,C){P[7]?A?A.p(P,C):(A=gt(P),A.c(),A.m(E,p)):A&&(A.d(1),A=null),C&32&&T.value!==P[5]&&ut(T,P[5]),F===(F=x(P))&&S?S.p(P,C):(S.d(1),S=F(P),S&&(S.c(),S.m(O,null)))},d(P){P&&i(e),A&&A.d(),S.d(),L=!1,_t(v)}}}function le(n){return{c:w,l:w,m:w,p:w,i:w,o:w,d:w}}function oe(n){let e,l,t,o,a,r,s,m,E;return{c(){e=f("center"),l=f("br"),t=R(),o=f("hgroup"),a=f("h1"),r=M("Loading..."),s=R(),m=f("h2"),E=M("Give it a second..."),this.h()},l(y){e=d(y,"CENTER",{});var _=k(e);l=d(_,"BR",{}),t=U(_),o=d(_,"HGROUP",{});var p=k(o);a=d(p,"H1",{"aria-busy":!0});var g=k(a);r=z(g,"Loading..."),g.forEach(i),s=U(p),m=d(p,"H2",{});var B=k(m);E=z(B,"Give it a second..."),B.forEach(i),p.forEach(i),_.forEach(i),this.h()},h(){b(a,"aria-busy","true")},m(y,_){h(y,e,_),u(e,l),u(e,t),u(e,o),u(o,a),u(a,r),u(o,s),u(o,m),u(m,E)},p:w,i:w,o:w,d(y){y&&i(e)}}}function re(n){let e,l,t={ctx:n,current:null,token:null,hasCatch:!1,pending:oe,then:Jt,catch:Qt,blocks:[,,,]};return Ot(n[13](),t),{c(){e=ot(),t.block.c()},l(o){e=ot(),t.block.l(o)},m(o,a){h(o,e,a),t.block.m(o,t.anchor=a),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,[a]){n=o,Pt(t,n,a)},i(o){l||($(t.block),l=!0)},o(o){for(let a=0;a<3;a+=1){const r=t.blocks[a];rt(r)}l=!1},d(o){o&&i(e),t.block.d(o),t.token=null,t=null}}}function ae(n,e,l){let t,o,a;pt(n,Ct,v=>l(6,t=v)),pt(n,jt,v=>l(7,o=v));let r=!1,s,m=!1;const E=qt();pt(n,E,v=>l(8,a=v));const y=new FormData;var _="",p="",g="";async function B(){try{await Z.collection("users").update(t.id,{username:_}),p!=""&&(y.append("documents",p),Z.collection("users").update(t.id,y)),it("/account")}catch(v){console.log(v),alert("Something went wrong, please try again!")}}async function G(){it("/account")}async function O(){try{l(2,m=!0),await Z.collection("users").authWithPassword(t.email,g)}catch{l(2,m=!1),alert("Your password was incorrect!");return}try{t.role=="facilitator"?await Z.collection("organization").delete(o):await Z.collection("users").delete(t.id)}catch(v){l(2,m=!1),console.log(v),alert("Something went wrong, please try again!")}Z.authStore.clear(),it("/")}async function Y(){if(o){const v=await Z.collection("organization").getOne(t==null?void 0:t.org);l(1,s=v.name)}}It(()=>{t?l(3,_=t.username):it("/login")});function V(v){Lt.call(this,n,v)}function T(){_=this.value,l(3,_)}function W(){p=this.value,l(4,p)}const q=()=>l(0,r=!0);function j(){g=this.value,l(5,g)}function L(v){r=v,l(0,r)}return[r,s,m,_,p,g,t,o,a,E,B,G,O,Y,V,T,W,q,j,L]}class ne extends Tt{constructor(e){super(),Bt(this,e,ae,re,Nt,{})}}function ie(n){let e,l,t,o,a;return l=new ne({}),{c(){e=f("body"),Rt(l.$$.fragment),t=R(),o=f("pre")},l(r){e=d(r,"BODY",{});var s=k(e);Ut(l.$$.fragment,s),s.forEach(i),t=U(r),o=d(r,"PRE",{}),k(o).forEach(i)},m(r,s){h(r,e,s),At(l,e,null),h(r,t,s),h(r,o,s),a=!0},p:w,i(r){a||($(l.$$.fragment,r),a=!0)},o(r){rt(l.$$.fragment,r),a=!1},d(r){r&&i(e),zt(l),r&&i(t),r&&i(o)}}}class pe extends Tt{constructor(e){super(),Bt(this,e,null,ie,Nt,{})}}export{pe as default};
