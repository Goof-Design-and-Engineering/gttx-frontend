import{S as Pe,i as Re,s as Ie,D as Le,a as B,k as p,e as fe,c as M,l as d,m as h,h as u,b as g,H as ze,g as se,w as He,d as ce,f as Ae,L as ve,o as Se,O as De,r as E,u as y,v as $,x as Ge,P as Ve,z as Ne,A as Be,B as Me,Q as We,C as Ce,R as Ye,T as qe,n as K,p as z,q as de,G as s,U as Ue,V as Qe,W as Ee,M as le,X as ye,Y as he,Z as Xe,N as Fe,_ as Ze,$ as ke}from"../chunks/index.4fc2f4c3.js";import{u as je}from"../chunks/useForm.24789db4.js";import{v as Je,r as Ke}from"../chunks/validators.c512e31b.js";import{c as $e,p as J}from"../chunks/pocketbase.9bdecf86.js";import{g as pe}from"../chunks/navigation.8b1ad434.js";import{M as xe}from"../chunks/Modal.d827c1df.js";function ge(o,e,l){const t=o.slice();return t[22]=e[l],t[23]=e,t[24]=l,t}function Oe(o){let e;return{c(){e=E(o[2])},l(l){e=y(l,o[2])},m(l,t){g(l,e,t)},p(l,t){t&4&&$(e,l[2])},d(l){l&&u(e)}}}function et(o){return{c:K,l:K,m:K,p:K,d:K}}function tt(o){let e,l,t,c=(o[0]||"Organization Name")+"",r,i,a,n,f,_,m,O,N,k,I,C,w,T,P,Y,q,Z,Q,V,b,W,D,F,X,H=[],te=new Map,A,j=o[1];const x=v=>v[22].id;for(let v=0;v<j.length;v+=1){let R=ge(o,j,v),L=x(R);te.set(L,H[v]=Te(L,R))}return{c(){e=p("header"),l=p("hgroup"),t=p("h1"),r=E(c),i=B(),a=p("h2"),n=E("Time for a change?"),f=B(),_=p("details"),m=p("summary"),O=E("Invite Codes"),N=B(),k=p("div"),I=p("ul"),C=p("li"),w=p("p"),T=p("b"),P=E("Participant"),Y=E(": "),q=E(o[3]),Z=B(),Q=p("li"),V=p("p"),b=p("b"),W=E("Observer"),D=E(": "),F=E(o[4]),X=B();for(let v=0;v<H.length;v+=1)H[v].c();A=fe(),this.h()},l(v){e=d(v,"HEADER",{});var R=h(e);l=d(R,"HGROUP",{});var L=h(l);t=d(L,"H1",{});var G=h(t);r=y(G,c),G.forEach(u),i=M(L),a=d(L,"H2",{});var oe=h(a);n=y(oe,"Time for a change?"),oe.forEach(u),L.forEach(u),R.forEach(u),f=M(v),_=d(v,"DETAILS",{});var S=h(_);m=d(S,"SUMMARY",{role:!0,class:!0});var ae=h(m);O=y(ae,"Invite Codes"),ae.forEach(u),N=M(S),k=d(S,"DIV",{class:!0,style:!0});var re=h(k);I=d(re,"UL",{});var ee=h(I);C=d(ee,"LI",{});var ne=h(C);w=d(ne,"P",{id:!0});var U=h(w);T=d(U,"B",{});var ie=h(T);P=y(ie,"Participant"),ie.forEach(u),Y=y(U,": "),q=y(U,o[3]),U.forEach(u),ne.forEach(u),Z=M(ee),Q=d(ee,"LI",{});var me=h(Q);V=d(me,"P",{id:!0});var ue=h(V);b=d(ue,"B",{});var be=h(b);W=y(be,"Observer"),be.forEach(u),D=y(ue,": "),F=y(ue,o[4]),ue.forEach(u),me.forEach(u),ee.forEach(u),re.forEach(u),S.forEach(u),X=M(v);for(let _e=0;_e<H.length;_e+=1)H[_e].l(v);A=fe(),this.h()},h(){z(m,"role","button"),z(m,"class","secondary"),z(w,"id","p_code"),z(V,"id","o_code"),z(k,"class","scenario-box"),de(k,"margin-bottom","30px"),de(k,"padding-bottom","0"),_.open=!0},m(v,R){g(v,e,R),s(e,l),s(l,t),s(t,r),s(l,i),s(l,a),s(a,n),g(v,f,R),g(v,_,R),s(_,m),s(m,O),s(_,N),s(_,k),s(k,I),s(I,C),s(C,w),s(w,T),s(T,P),s(w,Y),s(w,q),s(I,Z),s(I,Q),s(Q,V),s(V,b),s(b,W),s(V,D),s(V,F),g(v,X,R);for(let L=0;L<H.length;L+=1)H[L].m(v,R);g(v,A,R)},p(v,R){R&1&&c!==(c=(v[0]||"Organization Name")+"")&&$(r,c),R&8&&$(q,v[3]),R&16&&$(F,v[4]),R&75266&&(j=v[1],H=Ue(H,R,x,1,v,j,te,A.parentNode,Qe,Te,A,ge))},d(v){v&&u(e),v&&u(f),v&&u(_),v&&u(X);for(let R=0;R<H.length;R+=1)H[R].d(v);v&&u(A)}}}function lt(o){let e=o[22].username+"",l;return{c(){l=E(e)},l(t){l=y(t,e)},m(t,c){g(t,l,c)},p(t,c){c&2&&e!==(e=t[22].username+"")&&$(l,e)},d(t){t&&u(l)}}}function ot(o){let e,l=o[22].username+"",t,c;return{c(){e=p("b"),t=E(l),c=E(" (that's you!)")},l(r){e=d(r,"B",{});var i=h(e);t=y(i,l),c=y(i," (that's you!)"),i.forEach(u)},m(r,i){g(r,e,i),s(e,t),s(e,c)},p(r,i){i&2&&l!==(l=r[22].username+"")&&$(t,l)},d(r){r&&u(e)}}}function at(o){let e,l,t,c,r,i;function a(m,O){return m[22].role=="facilitator"?st:m[22].role=="participant"?it:nt}let n=a(o),f=n(o);function _(){o[18].call(e,o[24])}return{c(){e=p("select"),f.c(),l=B(),t=p("button"),c=E("Remove"),this.h()},l(m){e=d(m,"SELECT",{});var O=h(e);f.l(O),O.forEach(u),l=M(m),t=d(m,"BUTTON",{class:!0});var N=h(t);c=y(N,"Remove"),N.forEach(u),this.h()},h(){o[9][o[24]]===void 0&&Ze(_),z(t,"class","primary")},m(m,O){g(m,e,O),f.m(e,null),ke(e,o[9][o[24]]),g(m,l,O),g(m,t,O),s(t,c),r||(i=[le(e,"change",_),le(e,"change",function(){he(o[16](o[22].id,o[24]))&&o[16](o[22].id,o[24]).apply(this,arguments)}),le(t,"click",function(){he(o[13](o[22]))&&o[13](o[22]).apply(this,arguments)})],r=!0)},p(m,O){o=m,n!==(n=a(o))&&(f.d(1),f=n(o),f&&(f.c(),f.m(e,null))),O&514&&ke(e,o[9][o[24]])},d(m){m&&u(e),f.d(),m&&u(l),m&&u(t),r=!1,Fe(i)}}}function rt(o){let e,l,t,c,r,i;return{c(){e=p("select"),l=p("option"),t=E("Facilitator"),c=B(),r=p("button"),i=E("Remove"),this.h()},l(a){e=d(a,"SELECT",{});var n=h(e);l=d(n,"OPTION",{});var f=h(l);t=y(f,"Facilitator"),f.forEach(u),n.forEach(u),c=M(a),r=d(a,"BUTTON",{class:!0});var _=h(r);i=y(_,"Remove"),_.forEach(u),this.h()},h(){l.__value="facilitator",l.value=l.__value,e.disabled=!0,z(r,"class","primary"),r.disabled="true"},m(a,n){g(a,e,n),s(e,l),s(l,t),g(a,c,n),g(a,r,n),s(r,i)},p:K,d(a){a&&u(e),a&&u(c),a&&u(r)}}}function nt(o){let e,l,t,c,r,i;return{c(){e=p("option"),l=E("Observer"),t=p("option"),c=E("Facilitator"),r=p("option"),i=E("Participant"),this.h()},l(a){e=d(a,"OPTION",{});var n=h(e);l=y(n,"Observer"),n.forEach(u),t=d(a,"OPTION",{});var f=h(t);c=y(f,"Facilitator"),f.forEach(u),r=d(a,"OPTION",{});var _=h(r);i=y(_,"Participant"),_.forEach(u),this.h()},h(){e.__value="observer",e.value=e.__value,e.selected=!0,t.__value="facilitator",t.value=t.__value,r.__value="participant",r.value=r.__value},m(a,n){g(a,e,n),s(e,l),g(a,t,n),s(t,c),g(a,r,n),s(r,i)},d(a){a&&u(e),a&&u(t),a&&u(r)}}}function it(o){let e,l,t,c,r,i;return{c(){e=p("option"),l=E("Participant"),t=p("option"),c=E("Facilitator"),r=p("option"),i=E("Observer"),this.h()},l(a){e=d(a,"OPTION",{});var n=h(e);l=y(n,"Participant"),n.forEach(u),t=d(a,"OPTION",{});var f=h(t);c=y(f,"Facilitator"),f.forEach(u),r=d(a,"OPTION",{});var _=h(r);i=y(_,"Observer"),_.forEach(u),this.h()},h(){e.__value="participant",e.value=e.__value,e.selected=!0,t.__value="facilitator",t.value=t.__value,r.__value="observer",r.value=r.__value},m(a,n){g(a,e,n),s(e,l),g(a,t,n),s(t,c),g(a,r,n),s(r,i)},d(a){a&&u(e),a&&u(t),a&&u(r)}}}function st(o){let e,l,t,c,r,i;return{c(){e=p("option"),l=E("Facilitator"),t=p("option"),c=E("Participant"),r=p("option"),i=E("Observer"),this.h()},l(a){e=d(a,"OPTION",{});var n=h(e);l=y(n,"Facilitator"),n.forEach(u),t=d(a,"OPTION",{});var f=h(t);c=y(f,"Participant"),f.forEach(u),r=d(a,"OPTION",{});var _=h(r);i=y(_,"Observer"),_.forEach(u),this.h()},h(){e.__value="facilitator",e.value=e.__value,e.selected=!0,t.__value="participant",t.value=t.__value,r.__value="observer",r.value=r.__value},m(a,n){g(a,e,n),s(e,l),g(a,t,n),s(t,c),g(a,r,n),s(r,i)},d(a){a&&u(e),a&&u(t),a&&u(r)}}}function Te(o,e){let l,t,c,r,i,a,n,f,_,m;function O(T,P){return T[22].id==T[10].id?ot:lt}let N=O(e),k=N(e);function I(T,P){return T[22].id==T[10].id?rt:at}let C=I(e),w=C(e);return{key:o,first:null,c(){l=p("div"),k.c(),t=B(),c=p("hr"),r=B(),i=p("div"),a=p("input"),f=B(),w.c(),_=B(),m=p("br"),this.h()},l(T){l=d(T,"DIV",{});var P=h(l);k.l(P),t=M(P),c=d(P,"HR",{}),r=M(P),i=d(P,"DIV",{class:!0});var Y=h(i);a=d(Y,"INPUT",{type:!0,"aria-invalid":!0}),f=M(Y),w.l(Y),Y.forEach(u),P.forEach(u),_=M(T),m=d(T,"BR",{}),this.h()},h(){z(a,"type","text"),a.value=n=e[22].email,z(a,"aria-invalid","false"),a.disabled=!0,z(i,"class","grid"),this.first=l},m(T,P){g(T,l,P),k.m(l,null),s(l,t),s(l,c),s(l,r),s(l,i),s(i,a),s(i,f),w.m(i,null),g(T,_,P),g(T,m,P)},p(T,P){e=T,N===(N=O(e))&&k?k.p(e,P):(k.d(1),k=N(e),k&&(k.c(),k.m(l,t))),P&2&&n!==(n=e[22].email)&&a.value!==n&&(a.value=n),C===(C=I(e))&&w?w.p(e,P):(w.d(1),w=C(e),w&&(w.c(),w.m(i,null)))},d(T){T&&u(l),k.d(),w.d(),T&&u(_),T&&u(m)}}}function ut(o){let e,l,t,c,r,i,a,n,f;return{c(){e=p("center"),l=p("br"),t=B(),c=p("hgroup"),r=p("h1"),i=E("Loading..."),a=B(),n=p("h2"),f=E("Give it a second..."),this.h()},l(_){e=d(_,"CENTER",{});var m=h(e);l=d(m,"BR",{}),t=M(m),c=d(m,"HGROUP",{});var O=h(c);r=d(O,"H1",{"aria-busy":!0});var N=h(r);i=y(N,"Loading..."),N.forEach(u),a=M(O),n=d(O,"H2",{});var k=h(n);f=y(k,"Give it a second..."),k.forEach(u),O.forEach(u),m.forEach(u),this.h()},h(){z(r,"aria-busy","true")},m(_,m){g(_,e,m),s(e,l),s(e,t),s(e,c),s(c,r),s(r,i),s(c,a),s(c,n),s(n,f)},p:K,d(_){_&&u(e)}}}function we(o){let e,l,t;function c(i){o[20](i)}let r={$$slots:{default:[ft]},$$scope:{ctx:o}};return o[5]!==void 0&&(r.showModal=o[5]),e=new xe({props:r}),Ge.push(()=>Ve(e,"showModal",c)),{c(){Ne(e.$$.fragment)},l(i){Be(e.$$.fragment,i)},m(i,a){Me(e,i,a),t=!0},p(i,a){const n={};a&33556928&&(n.$$scope={dirty:a,ctx:i}),!l&&a&32&&(l=!0,n.showModal=i[5],We(()=>l=!1)),e.$set(n)},i(i){t||(se(e.$$.fragment,i),t=!0)},o(i){ce(e.$$.fragment,i),t=!1},d(i){Ce(e,i)}}}function ft(o){let e,l,t,c,r,i,a,n=o[6].username+"",f,_,m,O,N,k,I=o[6].username+"",C,w,T,P,Y,q,Z,Q,V,b,W,D,F,X,H,te,A,j,x,v,R;return{c(){e=p("article"),l=p("h3"),t=E("Woah there!"),c=B(),r=p("p"),i=E("Are you sure that you want to remove "),a=p("b"),f=E(n),_=E(` from your
				organization?
				`),m=p("br"),O=p("br"),N=E(`
				If you change your mind, you'll have to send `),k=p("b"),C=E(I),w=E(` another
				invite.
				`),T=p("br"),P=p("br"),Y=B(),q=p("b"),Z=E("This action can not be undone!"),Q=B(),V=p("footer"),b=p("form"),W=p("br"),D=B(),F=p("input"),X=B(),H=p("br"),te=B(),A=p("button"),j=E("Confirm"),this.h()},l(L){e=d(L,"ARTICLE",{});var G=h(e);l=d(G,"H3",{});var oe=h(l);t=y(oe,"Woah there!"),oe.forEach(u),c=M(G),r=d(G,"P",{});var S=h(r);i=y(S,"Are you sure that you want to remove "),a=d(S,"B",{});var ae=h(a);f=y(ae,n),ae.forEach(u),_=y(S,` from your
				organization?
				`),m=d(S,"BR",{}),O=d(S,"BR",{}),N=y(S,`
				If you change your mind, you'll have to send `),k=d(S,"B",{});var re=h(k);C=y(re,I),re.forEach(u),w=y(S,` another
				invite.
				`),T=d(S,"BR",{}),P=d(S,"BR",{}),Y=M(S),q=d(S,"B",{style:!0});var ee=h(q);Z=y(ee,"This action can not be undone!"),ee.forEach(u),S.forEach(u),Q=M(G),V=d(G,"FOOTER",{});var ne=h(V);b=d(ne,"FORM",{method:!0});var U=h(b);W=d(U,"BR",{}),D=M(U),F=d(U,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),X=M(U),H=d(U,"BR",{}),te=M(U),A=d(U,"BUTTON",{"data-target":!0,"aria-busy":!0});var ie=h(A);j=y(ie,"Confirm"),ie.forEach(u),U.forEach(u),ne.forEach(u),G.forEach(u),this.h()},h(){de(q,"color","red"),z(F,"type","password"),z(F,"name","del_confirm_pass"),z(F,"id","del_confrim_pass"),z(F,"placeholder","Your current password, please!"),z(A,"data-target","modal-example"),A.disabled=x=!o[11].valid||o[8],z(A,"aria-busy",o[8]),z(b,"method","POST")},m(L,G){g(L,e,G),s(e,l),s(l,t),s(e,c),s(e,r),s(r,i),s(r,a),s(a,f),s(r,_),s(r,m),s(r,O),s(r,N),s(r,k),s(k,C),s(r,w),s(r,T),s(r,P),s(r,Y),s(r,q),s(q,Z),s(e,Q),s(e,V),s(V,b),s(b,W),s(b,D),s(b,F),Ee(F,o[7]),s(b,X),s(b,H),s(b,te),s(b,A),s(A,j),v||(R=[le(F,"input",o[19]),ye(Je.call(null,F,[Ke])),le(A,"click",function(){he(o[15](o[6].id))&&o[15](o[6].id).apply(this,arguments)}),ye(o[12].call(null,b)),le(b,"submit",Xe(o[17]))],v=!0)},p(L,G){o=L,G&64&&n!==(n=o[6].username+"")&&$(f,n),G&64&&I!==(I=o[6].username+"")&&$(C,I),G&128&&F.value!==o[7]&&Ee(F,o[7]),G&2304&&x!==(x=!o[11].valid||o[8])&&(A.disabled=x),G&256&&z(A,"aria-busy",o[8])},d(L){L&&u(e),v=!1,Fe(R)}}}function ct(o){let e,l,t,c,r,i=o[2]!=""&&Oe(o),a={ctx:o,current:null,token:null,hasCatch:!1,pending:ut,then:tt,catch:et};Le(o[14](),a);let n=o[5]&&we(o);return{c(){i&&i.c(),e=B(),l=p("article"),a.block.c(),t=B(),n&&n.c(),c=fe()},l(f){i&&i.l(f),e=M(f),l=d(f,"ARTICLE",{});var _=h(l);a.block.l(_),_.forEach(u),t=M(f),n&&n.l(f),c=fe()},m(f,_){i&&i.m(f,_),g(f,e,_),g(f,l,_),a.block.m(l,a.anchor=null),a.mount=()=>l,a.anchor=null,g(f,t,_),n&&n.m(f,_),g(f,c,_),r=!0},p(f,[_]){o=f,o[2]!=""?i?i.p(o,_):(i=Oe(o),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null),ze(a,o,_),o[5]?n?(n.p(o,_),_&32&&se(n,1)):(n=we(o),n.c(),se(n,1),n.m(c.parentNode,c)):n&&(He(),ce(n,1,1,()=>{n=null}),Ae())},i(f){r||(se(n),r=!0)},o(f){ce(n),r=!1},d(f){i&&i.d(f),f&&u(e),f&&u(l),a.block.d(),a.token=null,a=null,f&&u(t),n&&n.d(f),f&&u(c)}}}function _t(o,e,l){let t,c;ve(o,$e,b=>l(10,t=b));const r=je();ve(o,r,b=>l(11,c=b));let i,a,n=[],f="",_="",m="",O=!1,N;var k="";let I=!1,C=[];function w(b){l(6,N=b),l(5,O=!0)}Se(async()=>{if(t==null){pe("createorg");return}if((t==null?void 0:t.org)==""){pe("createorg");return}if(t.role!="facilitator"){pe("/dashboard");return}}),De(()=>{i==null||i()});async function T(){const b=await J.collection("organization").getOne(t==null?void 0:t.org,{expand:"members"});l(1,n=[...n,...b.expand.members]),l(0,a=b.name),l(3,_=b.participant_code),l(4,m=b.observer_code),i=await J.collection("organization").subscribe(t==null?void 0:t.org,async function(W){console.log(W.record);const D=await J.collection("organization").getOne(W.record.id,{expand:"members"});l(1,n=D.expand.members)})}async function P(b){l(8,I=!0);try{await J.collection("users").authWithPassword(t.email,k)}catch{alert("Your password was incorrect!"),l(8,I=!1);return}try{await J.collection("users").update(b,{org:""})}catch(D){deleting=!1,console.log(D),alert("Something went wrong, please try again!"),l(8,I=!1);return}const W=n.filter(D=>D.id!==b);console.log(W),J.collection("organization").update(t==null?void 0:t.org,{members:W.map(D=>D.id)}),l(8,I=!1),l(5,O=!1)}async function Y(b,W){const F={role:C[W]};try{const H=await J.collection("users").update(b,F)}catch(H){l(2,f=H);return}const X=await J.collection("organization").getOne(t==null?void 0:t.org,{expand:"members"});l(1,n=X.expand.members)}function q(b){Ye.call(this,o,b)}function Z(b){C[b]=qe(this),l(9,C)}function Q(){k=this.value,l(7,k)}function V(b){O=b,l(5,O)}return[a,n,f,_,m,O,N,k,I,C,t,c,r,w,T,P,Y,q,Z,Q,V]}class pt extends Pe{constructor(e){super(),Re(this,e,_t,ct,Ie,{})}}function dt(o){let e,l;return e=new pt({}),{c(){Ne(e.$$.fragment)},l(t){Be(e.$$.fragment,t)},m(t,c){Me(e,t,c),l=!0},p:K,i(t){l||(se(e.$$.fragment,t),l=!0)},o(t){ce(e.$$.fragment,t),l=!1},d(t){Ce(e,t)}}}class kt extends Pe{constructor(e){super(),Re(this,e,null,dt,Ie,{})}}export{kt as default};
