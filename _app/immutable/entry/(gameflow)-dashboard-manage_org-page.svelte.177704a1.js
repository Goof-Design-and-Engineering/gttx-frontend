import{S as Pe,i as Re,s as Ie,D as Le,a as B,k as p,e as fe,c as M,l as d,m as h,h as u,b as O,H as ze,g as se,w as He,d as ce,f as Ae,L as ve,o as Se,O as De,r as E,u as y,v as $,x as Ge,P as Ve,z as Ne,A as Be,B as Me,Q as We,C as Ce,R as Ye,T as qe,n as K,p as z,q as de,G as s,U as Ue,V as Qe,W as Ee,M as le,X as ye,Y as he,Z as Xe,N as Fe,_ as Ze,$ as ke}from"../chunks/index.4fc2f4c3.js";import{u as je}from"../chunks/useForm.24789db4.js";import{v as Je,r as Ke}from"../chunks/validators.c512e31b.js";import{c as $e,p as J}from"../chunks/pocketbase.cc5ca80f.js";import{g as pe}from"../chunks/navigation.3dc8513e.js";import{M as xe}from"../chunks/Modal.d827c1df.js";function Oe(o,e,l){const t=o.slice();return t[22]=e[l],t[23]=e,t[24]=l,t}function ge(o){let e;return{c(){e=E(o[2])},l(l){e=y(l,o[2])},m(l,t){O(l,e,t)},p(l,t){t&4&&$(e,l[2])},d(l){l&&u(e)}}}function et(o){return{c:K,l:K,m:K,p:K,d:K}}function tt(o){let e,l,t,c=(o[0]||"Organization Name")+"",r,n,a,i,f,_,m,g,N,k,I,C,w,T,P,W,Y,Z,Q,G,b,q,V,F,X,H=[],te=new Map,A,j=o[1];const x=v=>v[22].id;for(let v=0;v<j.length;v+=1){let R=Oe(o,j,v),L=x(R);te.set(L,H[v]=Te(L,R))}return{c(){e=p("header"),l=p("hgroup"),t=p("h1"),r=E(c),n=B(),a=p("h2"),i=E("Time for a change?"),f=B(),_=p("details"),m=p("summary"),g=E("Invite Codes"),N=B(),k=p("div"),I=p("ul"),C=p("li"),w=p("p"),T=p("b"),P=E("Participant"),W=E(": "),Y=E(o[3]),Z=B(),Q=p("li"),G=p("p"),b=p("b"),q=E("Observer"),V=E(": "),F=E(o[4]),X=B();for(let v=0;v<H.length;v+=1)H[v].c();A=fe(),this.h()},l(v){e=d(v,"HEADER",{});var R=h(e);l=d(R,"HGROUP",{});var L=h(l);t=d(L,"H1",{});var D=h(t);r=y(D,c),D.forEach(u),n=M(L),a=d(L,"H2",{});var oe=h(a);i=y(oe,"Time for a change?"),oe.forEach(u),L.forEach(u),R.forEach(u),f=M(v),_=d(v,"DETAILS",{});var S=h(_);m=d(S,"SUMMARY",{role:!0,class:!0});var ae=h(m);g=y(ae,"Invite Codes"),ae.forEach(u),N=M(S),k=d(S,"DIV",{class:!0,style:!0});var re=h(k);I=d(re,"UL",{});var ee=h(I);C=d(ee,"LI",{});var ie=h(C);w=d(ie,"P",{id:!0});var U=h(w);T=d(U,"B",{});var ne=h(T);P=y(ne,"Participant"),ne.forEach(u),W=y(U,": "),Y=y(U,o[3]),U.forEach(u),ie.forEach(u),Z=M(ee),Q=d(ee,"LI",{});var me=h(Q);G=d(me,"P",{id:!0});var ue=h(G);b=d(ue,"B",{});var be=h(b);q=y(be,"Observer"),be.forEach(u),V=y(ue,": "),F=y(ue,o[4]),ue.forEach(u),me.forEach(u),ee.forEach(u),re.forEach(u),S.forEach(u),X=M(v);for(let _e=0;_e<H.length;_e+=1)H[_e].l(v);A=fe(),this.h()},h(){z(m,"role","button"),z(m,"class","secondary"),z(w,"id","p_code"),z(G,"id","o_code"),z(k,"class","scenario-box"),de(k,"margin-bottom","30px"),de(k,"padding-bottom","0"),_.open=!0},m(v,R){O(v,e,R),s(e,l),s(l,t),s(t,r),s(l,n),s(l,a),s(a,i),O(v,f,R),O(v,_,R),s(_,m),s(m,g),s(_,N),s(_,k),s(k,I),s(I,C),s(C,w),s(w,T),s(T,P),s(w,W),s(w,Y),s(I,Z),s(I,Q),s(Q,G),s(G,b),s(b,q),s(G,V),s(G,F),O(v,X,R);for(let L=0;L<H.length;L+=1)H[L].m(v,R);O(v,A,R)},p(v,R){R&1&&c!==(c=(v[0]||"Organization Name")+"")&&$(r,c),R&8&&$(Y,v[3]),R&16&&$(F,v[4]),R&75266&&(j=v[1],H=Ue(H,R,x,1,v,j,te,A.parentNode,Qe,Te,A,Oe))},d(v){v&&u(e),v&&u(f),v&&u(_),v&&u(X);for(let R=0;R<H.length;R+=1)H[R].d(v);v&&u(A)}}}function lt(o){let e=o[22].username+"",l;return{c(){l=E(e)},l(t){l=y(t,e)},m(t,c){O(t,l,c)},p(t,c){c&2&&e!==(e=t[22].username+"")&&$(l,e)},d(t){t&&u(l)}}}function ot(o){let e,l=o[22].username+"",t,c;return{c(){e=p("b"),t=E(l),c=E(" (that's you!)")},l(r){e=d(r,"B",{});var n=h(e);t=y(n,l),c=y(n," (that's you!)"),n.forEach(u)},m(r,n){O(r,e,n),s(e,t),s(e,c)},p(r,n){n&2&&l!==(l=r[22].username+"")&&$(t,l)},d(r){r&&u(e)}}}function at(o){let e,l,t,c,r,n;function a(m,g){return m[22].role=="facilitator"?st:m[22].role=="participant"?nt:it}let i=a(o),f=i(o);function _(){o[18].call(e,o[24])}return{c(){e=p("select"),f.c(),l=B(),t=p("button"),c=E("Remove"),this.h()},l(m){e=d(m,"SELECT",{});var g=h(e);f.l(g),g.forEach(u),l=M(m),t=d(m,"BUTTON",{class:!0});var N=h(t);c=y(N,"Remove"),N.forEach(u),this.h()},h(){o[9][o[24]]===void 0&&Ze(_),z(t,"class","primary")},m(m,g){O(m,e,g),f.m(e,null),ke(e,o[9][o[24]]),O(m,l,g),O(m,t,g),s(t,c),r||(n=[le(e,"change",_),le(e,"change",function(){he(o[16](o[22].id,o[24]))&&o[16](o[22].id,o[24]).apply(this,arguments)}),le(t,"click",function(){he(o[13](o[22]))&&o[13](o[22]).apply(this,arguments)})],r=!0)},p(m,g){o=m,i!==(i=a(o))&&(f.d(1),f=i(o),f&&(f.c(),f.m(e,null))),g&514&&ke(e,o[9][o[24]])},d(m){m&&u(e),f.d(),m&&u(l),m&&u(t),r=!1,Fe(n)}}}function rt(o){let e,l,t,c,r,n;return{c(){e=p("select"),l=p("option"),t=E("Facilitator"),c=B(),r=p("button"),n=E("Remove"),this.h()},l(a){e=d(a,"SELECT",{});var i=h(e);l=d(i,"OPTION",{});var f=h(l);t=y(f,"Facilitator"),f.forEach(u),i.forEach(u),c=M(a),r=d(a,"BUTTON",{class:!0});var _=h(r);n=y(_,"Remove"),_.forEach(u),this.h()},h(){l.__value="facilitator",l.value=l.__value,e.disabled=!0,z(r,"class","primary"),r.disabled="true"},m(a,i){O(a,e,i),s(e,l),s(l,t),O(a,c,i),O(a,r,i),s(r,n)},p:K,d(a){a&&u(e),a&&u(c),a&&u(r)}}}function it(o){let e,l,t,c,r,n;return{c(){e=p("option"),l=E("Observer"),t=p("option"),c=E("Facilitator"),r=p("option"),n=E("Participant"),this.h()},l(a){e=d(a,"OPTION",{});var i=h(e);l=y(i,"Observer"),i.forEach(u),t=d(a,"OPTION",{});var f=h(t);c=y(f,"Facilitator"),f.forEach(u),r=d(a,"OPTION",{});var _=h(r);n=y(_,"Participant"),_.forEach(u),this.h()},h(){e.__value="observer",e.value=e.__value,e.selected=!0,t.__value="facilitator",t.value=t.__value,r.__value="participant",r.value=r.__value},m(a,i){O(a,e,i),s(e,l),O(a,t,i),s(t,c),O(a,r,i),s(r,n)},d(a){a&&u(e),a&&u(t),a&&u(r)}}}function nt(o){let e,l,t,c,r,n;return{c(){e=p("option"),l=E("Participant"),t=p("option"),c=E("Facilitator"),r=p("option"),n=E("Observer"),this.h()},l(a){e=d(a,"OPTION",{});var i=h(e);l=y(i,"Participant"),i.forEach(u),t=d(a,"OPTION",{});var f=h(t);c=y(f,"Facilitator"),f.forEach(u),r=d(a,"OPTION",{});var _=h(r);n=y(_,"Observer"),_.forEach(u),this.h()},h(){e.__value="participant",e.value=e.__value,e.selected=!0,t.__value="facilitator",t.value=t.__value,r.__value="observer",r.value=r.__value},m(a,i){O(a,e,i),s(e,l),O(a,t,i),s(t,c),O(a,r,i),s(r,n)},d(a){a&&u(e),a&&u(t),a&&u(r)}}}function st(o){let e,l,t,c,r,n;return{c(){e=p("option"),l=E("Facilitator"),t=p("option"),c=E("Participant"),r=p("option"),n=E("Observer"),this.h()},l(a){e=d(a,"OPTION",{});var i=h(e);l=y(i,"Facilitator"),i.forEach(u),t=d(a,"OPTION",{});var f=h(t);c=y(f,"Participant"),f.forEach(u),r=d(a,"OPTION",{});var _=h(r);n=y(_,"Observer"),_.forEach(u),this.h()},h(){e.__value="facilitator",e.value=e.__value,e.selected=!0,t.__value="participant",t.value=t.__value,r.__value="observer",r.value=r.__value},m(a,i){O(a,e,i),s(e,l),O(a,t,i),s(t,c),O(a,r,i),s(r,n)},d(a){a&&u(e),a&&u(t),a&&u(r)}}}function Te(o,e){let l,t,c,r,n,a,i,f,_,m;function g(T,P){return T[22].id==T[10].id?ot:lt}let N=g(e),k=N(e);function I(T,P){return T[22].id==T[10].id?rt:at}let C=I(e),w=C(e);return{key:o,first:null,c(){l=p("div"),k.c(),t=B(),c=p("hr"),r=B(),n=p("div"),a=p("input"),f=B(),w.c(),_=B(),m=p("br"),this.h()},l(T){l=d(T,"DIV",{});var P=h(l);k.l(P),t=M(P),c=d(P,"HR",{}),r=M(P),n=d(P,"DIV",{class:!0});var W=h(n);a=d(W,"INPUT",{type:!0,"aria-invalid":!0}),f=M(W),w.l(W),W.forEach(u),P.forEach(u),_=M(T),m=d(T,"BR",{}),this.h()},h(){z(a,"type","text"),a.value=i=e[22].email,z(a,"aria-invalid","false"),a.disabled=!0,z(n,"class","grid"),this.first=l},m(T,P){O(T,l,P),k.m(l,null),s(l,t),s(l,c),s(l,r),s(l,n),s(n,a),s(n,f),w.m(n,null),O(T,_,P),O(T,m,P)},p(T,P){e=T,N===(N=g(e))&&k?k.p(e,P):(k.d(1),k=N(e),k&&(k.c(),k.m(l,t))),P&2&&i!==(i=e[22].email)&&a.value!==i&&(a.value=i),C===(C=I(e))&&w?w.p(e,P):(w.d(1),w=C(e),w&&(w.c(),w.m(n,null)))},d(T){T&&u(l),k.d(),w.d(),T&&u(_),T&&u(m)}}}function ut(o){let e,l,t,c,r,n,a,i,f;return{c(){e=p("center"),l=p("br"),t=B(),c=p("hgroup"),r=p("h1"),n=E("Loading..."),a=B(),i=p("h2"),f=E("Give it a second..."),this.h()},l(_){e=d(_,"CENTER",{});var m=h(e);l=d(m,"BR",{}),t=M(m),c=d(m,"HGROUP",{});var g=h(c);r=d(g,"H1",{"aria-busy":!0});var N=h(r);n=y(N,"Loading..."),N.forEach(u),a=M(g),i=d(g,"H2",{});var k=h(i);f=y(k,"Give it a second..."),k.forEach(u),g.forEach(u),m.forEach(u),this.h()},h(){z(r,"aria-busy","true")},m(_,m){O(_,e,m),s(e,l),s(e,t),s(e,c),s(c,r),s(r,n),s(c,a),s(c,i),s(i,f)},p:K,d(_){_&&u(e)}}}function we(o){let e,l,t;function c(n){o[20](n)}let r={$$slots:{default:[ft]},$$scope:{ctx:o}};return o[5]!==void 0&&(r.showModal=o[5]),e=new xe({props:r}),Ge.push(()=>Ve(e,"showModal",c)),{c(){Ne(e.$$.fragment)},l(n){Be(e.$$.fragment,n)},m(n,a){Me(e,n,a),t=!0},p(n,a){const i={};a&33556928&&(i.$$scope={dirty:a,ctx:n}),!l&&a&32&&(l=!0,i.showModal=n[5],We(()=>l=!1)),e.$set(i)},i(n){t||(se(e.$$.fragment,n),t=!0)},o(n){ce(e.$$.fragment,n),t=!1},d(n){Ce(e,n)}}}function ft(o){let e,l,t,c,r,n,a,i=o[6].username+"",f,_,m,g,N,k,I=o[6].username+"",C,w,T,P,W,Y,Z,Q,G,b,q,V,F,X,H,te,A,j,x,v,R;return{c(){e=p("article"),l=p("h3"),t=E("Woah there!"),c=B(),r=p("p"),n=E("Are you sure that you want to remove "),a=p("b"),f=E(i),_=E(` from your
				organization?
				`),m=p("br"),g=p("br"),N=E(`
				If you change your mind, you'll have to send `),k=p("b"),C=E(I),w=E(` another
				invite.
				`),T=p("br"),P=p("br"),W=B(),Y=p("b"),Z=E("This action can not be undone!"),Q=B(),G=p("footer"),b=p("form"),q=p("br"),V=B(),F=p("input"),X=B(),H=p("br"),te=B(),A=p("button"),j=E("Confirm"),this.h()},l(L){e=d(L,"ARTICLE",{});var D=h(e);l=d(D,"H3",{});var oe=h(l);t=y(oe,"Woah there!"),oe.forEach(u),c=M(D),r=d(D,"P",{});var S=h(r);n=y(S,"Are you sure that you want to remove "),a=d(S,"B",{});var ae=h(a);f=y(ae,i),ae.forEach(u),_=y(S,` from your
				organization?
				`),m=d(S,"BR",{}),g=d(S,"BR",{}),N=y(S,`
				If you change your mind, you'll have to send `),k=d(S,"B",{});var re=h(k);C=y(re,I),re.forEach(u),w=y(S,` another
				invite.
				`),T=d(S,"BR",{}),P=d(S,"BR",{}),W=M(S),Y=d(S,"B",{style:!0});var ee=h(Y);Z=y(ee,"This action can not be undone!"),ee.forEach(u),S.forEach(u),Q=M(D),G=d(D,"FOOTER",{});var ie=h(G);b=d(ie,"FORM",{method:!0});var U=h(b);q=d(U,"BR",{}),V=M(U),F=d(U,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),X=M(U),H=d(U,"BR",{}),te=M(U),A=d(U,"BUTTON",{"data-target":!0,"aria-busy":!0});var ne=h(A);j=y(ne,"Confirm"),ne.forEach(u),U.forEach(u),ie.forEach(u),D.forEach(u),this.h()},h(){de(Y,"color","red"),z(F,"type","password"),z(F,"name","del_confirm_pass"),z(F,"id","del_confrim_pass"),z(F,"placeholder","Your current password, please!"),z(A,"data-target","modal-example"),A.disabled=x=!o[11].valid||o[8],z(A,"aria-busy",o[8]),z(b,"method","POST")},m(L,D){O(L,e,D),s(e,l),s(l,t),s(e,c),s(e,r),s(r,n),s(r,a),s(a,f),s(r,_),s(r,m),s(r,g),s(r,N),s(r,k),s(k,C),s(r,w),s(r,T),s(r,P),s(r,W),s(r,Y),s(Y,Z),s(e,Q),s(e,G),s(G,b),s(b,q),s(b,V),s(b,F),Ee(F,o[7]),s(b,X),s(b,H),s(b,te),s(b,A),s(A,j),v||(R=[le(F,"input",o[19]),ye(Je.call(null,F,[Ke])),le(A,"click",function(){he(o[15](o[6].id))&&o[15](o[6].id).apply(this,arguments)}),ye(o[12].call(null,b)),le(b,"submit",Xe(o[17]))],v=!0)},p(L,D){o=L,D&64&&i!==(i=o[6].username+"")&&$(f,i),D&64&&I!==(I=o[6].username+"")&&$(C,I),D&128&&F.value!==o[7]&&Ee(F,o[7]),D&2304&&x!==(x=!o[11].valid||o[8])&&(A.disabled=x),D&256&&z(A,"aria-busy",o[8])},d(L){L&&u(e),v=!1,Fe(R)}}}function ct(o){let e,l,t,c,r,n=o[2]!=""&&ge(o),a={ctx:o,current:null,token:null,hasCatch:!1,pending:ut,then:tt,catch:et};Le(o[14](),a);let i=o[5]&&we(o);return{c(){n&&n.c(),e=B(),l=p("article"),a.block.c(),t=B(),i&&i.c(),c=fe()},l(f){n&&n.l(f),e=M(f),l=d(f,"ARTICLE",{});var _=h(l);a.block.l(_),_.forEach(u),t=M(f),i&&i.l(f),c=fe()},m(f,_){n&&n.m(f,_),O(f,e,_),O(f,l,_),a.block.m(l,a.anchor=null),a.mount=()=>l,a.anchor=null,O(f,t,_),i&&i.m(f,_),O(f,c,_),r=!0},p(f,[_]){o=f,o[2]!=""?n?n.p(o,_):(n=ge(o),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null),ze(a,o,_),o[5]?i?(i.p(o,_),_&32&&se(i,1)):(i=we(o),i.c(),se(i,1),i.m(c.parentNode,c)):i&&(He(),ce(i,1,1,()=>{i=null}),Ae())},i(f){r||(se(i),r=!0)},o(f){ce(i),r=!1},d(f){n&&n.d(f),f&&u(e),f&&u(l),a.block.d(),a.token=null,a=null,f&&u(t),i&&i.d(f),f&&u(c)}}}function _t(o,e,l){let t,c;ve(o,$e,b=>l(10,t=b));const r=je();ve(o,r,b=>l(11,c=b));let n,a,i=[],f="",_="",m="",g=!1,N;var k="";let I=!1,C=[];function w(b){l(6,N=b),l(5,g=!0)}Se(async()=>{if(t==null){pe("createorg");return}if((t==null?void 0:t.org)==""){pe("createorg");return}if(t.role!="facilitator"){pe("/dashboard");return}}),De(()=>{n==null||n()});async function T(){const b=await J.collection("organization").getOne(t==null?void 0:t.org,{expand:"members"});l(1,i=[...i,...b.expand.members]),l(0,a=b.name),l(3,_=b.participant_code),l(4,m=b.observer_code),n=await J.collection("organization").subscribe(t==null?void 0:t.org,async function(q){const V=await J.collection("organization").getOne(q.record.id,{expand:"members"});l(1,i=V.expand.members)})}async function P(b){l(8,I=!0);try{await J.collection("users").authWithPassword(t.email,k)}catch{alert("Your password was incorrect!"),l(8,I=!1);return}try{await J.collection("users").update(b,{org:""})}catch{deleting=!1,alert("Something went wrong, please try again!"),l(8,I=!1);return}const q=i.filter(V=>V.id!==b);J.collection("organization").update(t==null?void 0:t.org,{members:q.map(V=>V.id)}),l(8,I=!1),l(5,g=!1)}async function W(b,q){const F={role:C[q]};try{const H=await J.collection("users").update(b,F)}catch(H){l(2,f=H);return}const X=await J.collection("organization").getOne(t==null?void 0:t.org,{expand:"members"});l(1,i=X.expand.members)}function Y(b){Ye.call(this,o,b)}function Z(b){C[b]=qe(this),l(9,C)}function Q(){k=this.value,l(7,k)}function G(b){g=b,l(5,g)}return[a,i,f,_,m,g,N,k,I,C,t,c,r,w,T,P,W,Y,Z,Q,G]}class pt extends Pe{constructor(e){super(),Re(this,e,_t,ct,Ie,{})}}function dt(o){let e,l;return e=new pt({}),{c(){Ne(e.$$.fragment)},l(t){Be(e.$$.fragment,t)},m(t,c){Me(e,t,c),l=!0},p:K,i(t){l||(se(e.$$.fragment,t),l=!0)},o(t){ce(e.$$.fragment,t),l=!1},d(t){Ce(e,t)}}}class kt extends Pe{constructor(e){super(),Re(this,e,null,dt,Ie,{})}}export{kt as default};
