import{S as Tt,i as Bt,s as Pt,D as zt,e as ut,b as k,H as St,g as at,d as rt,h as u,L as _t,o as It,Y as Ct,n as M,w as Lt,f as Dt,x as $t,Q as Yt,k as f,r as B,a as O,z as Ut,l as d,m as g,u as P,c as R,A as Nt,q as pt,p as _,G as n,O as ct,B as Ot,M as Q,a4 as nt,v as Rt,R as Ft,C as At,N as bt,a5 as Ht}from"../chunks/index.b95161bf.js";import{u as qt,v as ft,r as dt}from"../chunks/validators.c220a831.js";import{c as Mt,b as Wt,p as lt}from"../chunks/pocketbase.c09fd52b.js";import{g as st}from"../chunks/navigation.7a5a56af.js";import{M as jt}from"../chunks/Modal.8c1f07ca.js";function Gt(s){return{c:M,l:M,m:M,p:M,i:M,o:M,d:M}}function Qt(s){let e,l,t=s[4]&&gt(s);return{c(){t&&t.c(),e=ut()},l(o){t&&t.l(o),e=ut()},m(o,r){t&&t.m(o,r),k(o,e,r),l=!0},p(o,r){o[4]?t?(t.p(o,r),r&16&&at(t,1)):(t=gt(o),t.c(),at(t,1),t.m(e.parentNode,e)):t&&(Lt(),rt(t,1,1,()=>{t=null}),Dt())},i(o){l||(at(t),l=!0)},o(o){rt(t),l=!1},d(o){t&&t.d(o),o&&u(e)}}}function gt(s){let e,l,t,o=s[4].username+"",r,a,c,z,U,h,p,b,D,w,Y,W,S,T,I,H,m,V,$,F,K,x,j,J,A,G,C,L,y,v,tt,N,et,ot;function q(i){s[16](i)}let ht={$$slots:{default:[Zt]},$$scope:{ctx:s}};return s[0]!==void 0&&(ht.showModal=s[0]),v=new jt({props:ht}),$t.push(()=>Yt(v,"showModal",q)),{c(){e=f("hgroup"),l=f("h1"),t=B("Edit settings for "),r=B(o),a=O(),c=f("h2"),z=B("Express yourself!"),U=O(),h=f("label"),p=B(`Username
			
			`),b=f("input"),D=B(`

			Email Address
			
			`),w=f("input"),W=O(),S=f("label"),T=B(`Profile Picture
				`),I=f("input"),H=O(),m=f("br"),V=O(),$=f("div"),F=f("button"),K=B("Back to Settings"),x=O(),j=f("button"),J=B("Submit"),A=O(),G=f("center"),C=f("button"),L=B("Delete Account"),y=O(),Ut(v.$$.fragment),this.h()},l(i){e=d(i,"HGROUP",{});var E=g(e);l=d(E,"H1",{style:!0});var X=g(l);t=P(X,"Edit settings for "),r=P(X,o),X.forEach(u),a=R(E),c=d(E,"H2",{});var vt=g(c);z=P(vt,"Express yourself!"),vt.forEach(u),E.forEach(u),U=R(i),h=d(i,"LABEL",{});var Z=g(h);p=P(Z,`Username
			
			`),b=d(Z,"INPUT",{type:!0,name:!0,id:!0}),D=P(Z,`

			Email Address
			
			`),w=d(Z,"INPUT",{type:!0,name:!0,id:!0}),W=R(Z),S=d(Z,"LABEL",{for:!0});var mt=g(S);T=P(mt,`Profile Picture
				`),I=d(mt,"INPUT",{type:!0,id:!0,name:!0,accept:!0}),mt.forEach(u),Z.forEach(u),H=R(i),m=d(i,"BR",{}),V=R(i),$=d(i,"DIV",{class:!0});var it=g($);F=d(it,"BUTTON",{class:!0});var kt=g(F);K=P(kt,"Back to Settings"),kt.forEach(u),x=R(it),j=d(it,"BUTTON",{});var wt=g(j);J=P(wt,"Submit"),wt.forEach(u),it.forEach(u),A=R(i),G=d(i,"CENTER",{});var yt=g(G);C=d(yt,"BUTTON",{class:!0,"data-target":!0,style:!0,"data-tooltip":!0});var Et=g(C);L=P(Et,"Delete Account"),Et.forEach(u),yt.forEach(u),y=R(i),Nt(v.$$.fragment,i),this.h()},h(){pt(l,"font-size","40px"),_(b,"type","text"),_(b,"name","new_username"),_(b,"id","new_username"),_(w,"type","text"),_(w,"name","new_emailaddr"),_(w,"id","new_emailaddr"),w.value=Y=s[4].email,w.disabled=!0,_(I,"type","file"),_(I,"id","pfp"),_(I,"name","pfp"),_(I,"accept","image/*"),I.disabled=!0,_(S,"for","file"),_(F,"class","secondary"),_($,"class","grid"),_(C,"class","outline contrast"),_(C,"data-target","modal-example"),pt(C,"width","50%"),_(C,"data-tooltip","This button is dangerous!")},m(i,E){k(i,e,E),n(e,l),n(l,t),n(l,r),n(e,a),n(e,c),n(c,z),k(i,U,E),k(i,h,E),n(h,p),n(h,b),ct(b,s[1]),n(h,D),n(h,w),n(h,W),n(h,S),n(S,T),n(S,I),k(i,H,E),k(i,m,E),k(i,V,E),k(i,$,E),n($,F),n(F,K),n($,x),n($,j),n(j,J),k(i,A,E),k(i,G,E),n(G,C),n(C,L),k(i,y,E),Ot(v,i,E),N=!0,et||(ot=[Q(b,"input",s[12]),nt(ft.call(null,b,[dt])),nt(ft.call(null,w,[dt])),Q(I,"change",s[13]),Q(F,"click",s[9]),Q(j,"click",s[8]),Q(C,"click",s[14])],et=!0)},p(i,E){(!N||E&16)&&o!==(o=i[4].username+"")&&Rt(r,o),E&2&&b.value!==i[1]&&ct(b,i[1]),(!N||E&16&&Y!==(Y=i[4].email)&&w.value!==Y)&&(w.value=Y);const X={};E&524408&&(X.$$scope={dirty:E,ctx:i}),!tt&&E&1&&(tt=!0,X.showModal=i[0],Ft(()=>tt=!1)),v.$set(X)},i(i){N||(at(v.$$.fragment,i),N=!0)},o(i){rt(v.$$.fragment,i),N=!1},d(i){i&&u(e),i&&u(U),i&&u(h),i&&u(H),i&&u(m),i&&u(V),i&&u($),i&&u(A),i&&u(G),i&&u(y),At(v,i),et=!1,bt(ot)}}}function Vt(s){let e,l,t=s[5].name+"",o,r;return{c(){e=B('As the facilitator, your organization "'),l=f("b"),o=B(t),r=B(`" will be
						deleted as well!`)},l(a){e=P(a,'As the facilitator, your organization "'),l=d(a,"B",{});var c=g(l);o=P(c,t),c.forEach(u),r=P(a,`" will be
						deleted as well!`)},m(a,c){k(a,e,c),k(a,l,c),n(l,o),k(a,r,c)},p(a,c){c&32&&t!==(t=a[5].name+"")&&Rt(o,t)},d(a){a&&u(e),a&&u(l),a&&u(r)}}}function Jt(s){let e;return{c(){e=B("You'll need another invite code to join back into your organization.")},l(l){e=P(l,"You'll need another invite code to join back into your organization.")},m(l,t){k(l,e,t)},p:M,d(l){l&&u(e)}}}function Kt(s){let e,l,t,o,r,a,c,z,U,h;return{c(){e=f("fieldset"),l=f("label"),t=f("input"),o=B(`
									I acknowlege that my organization will be deleted as well!`),r=O(),a=f("button"),c=B("Confirm"),this.h()},l(p){e=d(p,"FIELDSET",{});var b=g(e);l=d(b,"LABEL",{for:!0});var D=g(l);t=d(D,"INPUT",{type:!0,id:!0,name:!0}),o=P(D,`
									I acknowlege that my organization will be deleted as well!`),D.forEach(u),b.forEach(u),r=R(p),a=d(p,"BUTTON",{href:!0,"data-target":!0});var w=g(a);c=P(w,"Confirm"),w.forEach(u),this.h()},h(){_(t,"type","checkbox"),_(t,"id","org_confirm"),_(t,"name","terms"),_(l,"for","org_confirm"),_(a,"href","#confirm"),_(a,"data-target","modal-example"),a.disabled=z=!s[6].valid},m(p,b){k(p,e,b),n(e,l),n(l,t),n(l,o),k(p,r,b),k(p,a,b),n(a,c),U||(h=[nt(ft.call(null,t,[dt])),Q(a,"click",s[10])],U=!0)},p(p,b){b&64&&z!==(z=!p[6].valid)&&(a.disabled=z)},d(p){p&&u(e),p&&u(r),p&&u(a),U=!1,bt(h)}}}function Xt(s){let e,l,t,o,r;return{c(){e=f("button"),l=B("Confirm"),this.h()},l(a){e=d(a,"BUTTON",{href:!0,"data-target":!0});var c=g(e);l=P(c,"Confirm"),c.forEach(u),this.h()},h(){_(e,"href","#confirm"),_(e,"data-target","modal-example"),e.disabled=t=!s[6].valid},m(a,c){k(a,e,c),n(e,l),o||(r=Q(e,"click",s[10]),o=!0)},p(a,c){c&64&&t!==(t=!a[6].valid)&&(e.disabled=t)},d(a){a&&u(e),o=!1,r()}}}function Zt(s){let e,l,t,o,r,a,c,z,U,h,p,b,D,w,Y,W,S,T,I,H,m,V,$,F,K,x;function j(y,v){return y[4].role!="facilitator"?Jt:Vt}let J=j(s),A=J(s);function G(y,v){return y[4].role!="facilitator"?Xt:Kt}let C=G(s),L=C(s);return{c(){e=f("article"),l=f("h3"),t=B("Woah there!"),o=O(),r=f("p"),a=B(`Are you sure that you want to delete your account?
					`),c=f("br"),z=f("br"),U=O(),A.c(),h=O(),p=f("br"),b=f("br"),D=O(),w=f("b"),Y=B("This action can not be undone!"),W=O(),S=f("footer"),T=f("form"),I=f("br"),H=O(),m=f("input"),V=O(),$=f("br"),F=O(),L.c(),this.h()},l(y){e=d(y,"ARTICLE",{});var v=g(e);l=d(v,"H3",{});var tt=g(l);t=P(tt,"Woah there!"),tt.forEach(u),o=R(v),r=d(v,"P",{});var N=g(r);a=P(N,`Are you sure that you want to delete your account?
					`),c=d(N,"BR",{}),z=d(N,"BR",{}),U=R(N),A.l(N),h=R(N),p=d(N,"BR",{}),b=d(N,"BR",{}),D=R(N),w=d(N,"B",{style:!0});var et=g(w);Y=P(et,"This action can not be undone!"),et.forEach(u),N.forEach(u),W=R(v),S=d(v,"FOOTER",{});var ot=g(S);T=d(ot,"FORM",{method:!0});var q=g(T);I=d(q,"BR",{}),H=R(q),m=d(q,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),V=R(q),$=d(q,"BR",{}),F=R(q),L.l(q),q.forEach(u),ot.forEach(u),v.forEach(u),this.h()},h(){pt(w,"color","red"),_(m,"type","password"),_(m,"name","del_confirm_pass"),_(m,"id","del_confrim_pass"),_(m,"placeholder","Your current password, please!"),_(T,"method","POST")},m(y,v){k(y,e,v),n(e,l),n(l,t),n(e,o),n(e,r),n(r,a),n(r,c),n(r,z),n(r,U),A.m(r,null),n(r,h),n(r,p),n(r,b),n(r,D),n(r,w),n(w,Y),n(e,W),n(e,S),n(S,T),n(T,I),n(T,H),n(T,m),ct(m,s[3]),n(T,V),n(T,$),n(T,F),L.m(T,null),K||(x=[Q(m,"input",s[15]),nt(ft.call(null,m,[dt])),nt(s[7].call(null,T)),Q(T,"submit",Ht(s[11]))],K=!0)},p(y,v){J===(J=j(y))&&A?A.p(y,v):(A.d(1),A=J(y),A&&(A.c(),A.m(r,h))),v&8&&m.value!==y[3]&&ct(m,y[3]),C===(C=G(y))&&L?L.p(y,v):(L.d(1),L=C(y),L&&(L.c(),L.m(T,null)))},d(y){y&&u(e),A.d(),L.d(),K=!1,bt(x)}}}function xt(s){return{c:M,l:M,m:M,p:M,i:M,o:M,d:M}}function te(s){let e,l,t={ctx:s,current:null,token:null,hasCatch:!1,pending:xt,then:Qt,catch:Gt,value:18,blocks:[,,,]};return zt(Mt,t),{c(){e=ut(),t.block.c()},l(o){e=ut(),t.block.l(o)},m(o,r){k(o,e,r),t.block.m(o,t.anchor=r),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,[r]){s=o,St(t,s,r)},i(o){l||(at(t.block),l=!0)},o(o){for(let r=0;r<3;r+=1){const a=t.blocks[r];rt(a)}l=!1},d(o){o&&u(e),t.block.d(o),t.token=null,t=null}}}function ee(s,e,l){let t,o,r;_t(s,Mt,m=>l(4,t=m)),_t(s,Wt,m=>l(5,o=m));let a=!1;const c=qt();_t(s,c,m=>l(6,r=m));const z=new FormData;var U="",h="",p="";async function b(){try{await lt.collection("users").update(t.id,{username:U}),h!=""&&(z.append("documents",h),lt.collection("users").update(t.id,z)),st("/account")}catch(m){console.log(m),alert("Something went wrong, please try again!")}}async function D(){st("/account")}async function w(){try{await lt.collection("users").authWithPassword(t.email,p)}catch{alert("Your password was incorrect!");return}try{t.role=="facilitator"?await lt.collection("organization").delete(o):await lt.collection("users").delete(t.id)}catch(m){console.log(m),alert("Something went wrong, please try again!")}toggleModal,lt.authStore.clear(),st("/")}It(()=>{t?l(1,U=t.username):st("/login")});function Y(m){Ct.call(this,s,m)}function W(){U=this.value,l(1,U)}function S(){h=this.value,l(2,h)}const T=()=>l(0,a=!0);function I(){p=this.value,l(3,p)}function H(m){a=m,l(0,a)}return[a,U,h,p,t,o,r,c,b,D,w,Y,W,S,T,I,H]}class le extends Tt{constructor(e){super(),Bt(this,e,ee,te,Pt,{})}}function ae(s){let e,l,t,o,r;return l=new le({}),{c(){e=f("body"),Ut(l.$$.fragment),t=O(),o=f("pre")},l(a){e=d(a,"BODY",{});var c=g(e);Nt(l.$$.fragment,c),c.forEach(u),t=R(a),o=d(a,"PRE",{}),g(o).forEach(u)},m(a,c){k(a,e,c),Ot(l,e,null),k(a,t,c),k(a,o,c),r=!0},p:M,i(a){r||(at(l.$$.fragment,a),r=!0)},o(a){rt(l.$$.fragment,a),r=!1},d(a){a&&u(e),At(l),a&&u(t),a&&u(o)}}}class ue extends Tt{constructor(e){super(),Bt(this,e,null,ae,Pt,{})}}export{ue as default};
