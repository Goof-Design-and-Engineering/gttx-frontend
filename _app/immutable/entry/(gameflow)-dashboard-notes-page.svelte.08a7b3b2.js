import{S as x,i as ee,s as G,D as A,a as $,k as E,r as w,e as q,c as P,l as v,m as y,u as N,h as _,b as k,G as h,H as B,n as f,L as j,o as re,O as ce,p as R,V as W,M as X,N as ae,v as D,a1 as se,g as H,d as M,w as ue,f as ie,z as te,A as le,B as oe,C as ne}from"../chunks/index.f25a3516.js";import{c as fe,p as L,b as _e}from"../chunks/pocketbase.026f421a.js";import{g as V}from"../chunks/navigation.aabaf4cf.js";import{p as me}from"../chunks/stores.fc47c20a.js";import{N as pe}from"../chunks/NotesFac.5c2a9e43.js";function J(n,e,l){const t=n.slice();return t[4]=e[l],t}function be(n){let e,l,t=n[22].message+"",o;return{c(){e=E("p"),l=w("Error: "),o=w(t)},l(c){e=v(c,"P",{});var r=y(e);l=N(r,"Error: "),o=N(r,t),r.forEach(_)},m(c,r){k(c,e,r),h(e,l),h(e,o)},p:f,d(c){c&&_(e)}}}function de(n){let e,l,t,o,c,r,b=n[1],i,s,a,u,p,I,S,T,U,C,g={ctx:n,current:null,token:null,hasCatch:!1,pending:ve,then:ke,catch:he,value:23};A(n[6](),g);let O=Y(n);return{c(){e=E("form"),l=E("h2"),t=w("Request for comment"),o=$(),c=E("p"),g.block.c(),r=$(),O.c(),i=$(),s=E("label"),a=E("textarea"),u=$(),p=E("input"),I=$(),S=E("button"),T=w("Submit"),this.h()},l(m){e=v(m,"FORM",{});var d=y(e);l=v(d,"H2",{});var F=y(l);t=N(F,"Request for comment"),F.forEach(_),o=P(d),c=v(d,"P",{id:!0});var Q=y(c);g.block.l(Q),Q.forEach(_),r=P(d),O.l(d),i=P(d),s=v(d,"LABEL",{for:!0});var z=y(s);a=v(z,"TEXTAREA",{name:!0,id:!0,cols:!0,rows:!0}),y(a).forEach(_),z.forEach(_),u=P(d),p=v(d,"INPUT",{type:!0,id:!0,name:!0}),I=P(d),S=v(d,"BUTTON",{type:!0,id:!0});var K=y(S);T=N(K,"Submit"),K.forEach(_),d.forEach(_),this.h()},h(){R(c,"id","curr_question"),R(a,"name","notes"),R(a,"id","notes"),R(a,"cols","50"),R(a,"rows","4"),R(s,"for","notes"),R(p,"type","hidden"),R(p,"id","roomid"),R(p,"name","roomid"),p.value=n[0],R(S,"type","submit"),R(S,"id","submit_answer")},m(m,d){k(m,e,d),h(e,l),h(l,t),h(e,o),h(e,c),g.block.m(c,g.anchor=null),g.mount=()=>c,g.anchor=null,h(e,r),O.m(e,null),h(e,i),h(e,s),h(s,a),W(a,n[4]),h(e,u),h(e,p),h(e,I),h(e,S),h(S,T),U||(C=[X(a,"input",n[8]),X(S,"click",n[7])],U=!0)},p(m,d){n=m,B(g,n,d),d&2&&G(b,b=n[1])?(O.d(1),O=Y(n),O.c(),O.m(e,i)):O.p(n,d),d&16&&W(a,n[4]),d&1&&(p.value=n[0])},d(m){m&&_(e),g.block.d(),g.token=null,g=null,O.d(m),U=!1,ae(C)}}}function he(n){return{c:f,l:f,m:f,p:f,d:f}}function ke(n){let e;function l(c,r){return c[2]!=""?Ee:ge}let t=l(n),o=t(n);return{c(){o.c(),e=q()},l(c){o.l(c),e=q()},m(c,r){o.m(c,r),k(c,e,r)},p(c,r){t===(t=l(c))&&o?o.p(c,r):(o.d(1),o=t(c),o&&(o.c(),o.m(e.parentNode,e)))},d(c){o.d(c),c&&_(e)}}}function ge(n){let e=n[23]+"",l;return{c(){l=w(e)},l(t){l=N(t,e)},m(t,o){k(t,l,o)},p:f,d(t){t&&_(l)}}}function Ee(n){let e;return{c(){e=w(n[2])},l(l){e=N(l,n[2])},m(l,t){k(l,e,t)},p(l,t){t&4&&D(e,l[2])},d(l){l&&_(e)}}}function ve(n){return{c:f,l:f,m:f,p:f,d:f}}function Y(n){let e;return{c(){e=w(n[1])},l(l){e=N(l,n[1])},m(l,t){k(l,e,t)},p(l,t){t&2&&D(e,l[1])},d(l){l&&_(e)}}}function ye(n){let e,l;return{c(){e=E("p"),l=w("Loading...")},l(t){e=v(t,"P",{});var o=y(e);l=N(o,"Loading..."),o.forEach(_)},m(t,o){k(t,e,o),h(e,l)},p:f,d(t){t&&_(e)}}}function we(n){let e=n[22]+"",l;return{c(){l=w(e)},l(t){l=N(t,e)},m(t,o){k(t,l,o)},p(t,o){o&8&&e!==(e=t[22]+"")&&D(l,e)},d(t){t&&_(l)}}}function Ne(n){let e,l=n[19],t=[];for(let o=0;o<l.length;o+=1)t[o]=Z(J(n,l,o));return{c(){e=E("li");for(let o=0;o<t.length;o+=1)t[o].c()},l(o){e=v(o,"LI",{});var c=y(e);for(let r=0;r<t.length;r+=1)t[r].l(c);c.forEach(_)},m(o,c){k(o,e,c);for(let r=0;r<t.length;r+=1)t[r].m(e,null)},p(o,c){if(c&8){l=o[19];let r;for(r=0;r<l.length;r+=1){const b=J(o,l,r);t[r]?t[r].p(b,c):(t[r]=Z(b),t[r].c(),t[r].m(e,null))}for(;r<t.length;r+=1)t[r].d(1);t.length=l.length}},d(o){o&&_(e),se(t,o)}}}function Z(n){let e,l=n[4].question+"",t,o,c,r=n[4].content+"",b,i;return{c(){e=E("h3"),t=w(l),o=$(),c=E("p"),b=w(r),i=$()},l(s){e=v(s,"H3",{});var a=y(e);t=N(a,l),a.forEach(_),o=P(s),c=v(s,"P",{});var u=y(c);b=N(u,r),i=P(u),u.forEach(_)},m(s,a){k(s,e,a),h(e,t),k(s,o,a),k(s,c,a),h(c,b),h(c,i)},p(s,a){a&8&&l!==(l=s[4].question+"")&&D(t,l),a&8&&r!==(r=s[4].content+"")&&D(b,r)},d(s){s&&_(e),s&&_(o),s&&_(c)}}}function Oe(n){return{c:f,l:f,m:f,p:f,d:f}}function Re(n){let e,l,t,o,c,r,b,i,s={ctx:n,current:null,token:null,hasCatch:!0,pending:ye,then:de,catch:be,error:22};A(n[5](),s);let a={ctx:n,current:null,token:null,hasCatch:!0,pending:Oe,then:Ne,catch:we,value:19,error:22};return A(i=n[3],a),{c(){s.block.c(),e=$(),l=E("hr"),t=$(),o=E("h2"),c=w("PREVIOUS NOTES"),r=$(),b=q(),a.block.c()},l(u){s.block.l(u),e=P(u),l=v(u,"HR",{}),t=P(u),o=v(u,"H2",{});var p=y(o);c=N(p,"PREVIOUS NOTES"),p.forEach(_),r=P(u),b=q(),a.block.l(u)},m(u,p){s.block.m(u,s.anchor=p),s.mount=()=>e.parentNode,s.anchor=e,k(u,e,p),k(u,l,p),k(u,t,p),k(u,o,p),h(o,c),k(u,r,p),k(u,b,p),a.block.m(u,a.anchor=p),a.mount=()=>b.parentNode,a.anchor=b},p(u,[p]){n=u,B(s,n,p),a.ctx=n,p&8&&i!==(i=n[3])&&A(i,a)||B(a,n,p)},i:f,o:f,d(u){s.block.d(u),s.token=null,s=null,u&&_(e),u&&_(l),u&&_(t),u&&_(o),u&&_(r),u&&_(b),a.block.d(u),a.token=null,a=null}}}function Se(n,e,l){let t,o;j(n,fe,m=>l(12,t=m)),j(n,me,m=>l(13,o=m));let c="",r;const b=o.url;let{roomID:i=b.searchParams.get("roomid")||"FAILURE"}=e,s="",a,u,p="",I=[];function S(){V("/dashboard")}re(async()=>{a=await L.collection("room").subscribe(i,async function(m){l(2,p=await U())}),u=await L.collection("notes").subscribe("*",async function(m){l(3,I=await g())}),l(3,I=await g()),t||V("/login"),t.org||V("/createorg")}),ce(async()=>{a==null||a(),u==null||u()});async function T(){i==""&&S();try{const m=await L.collection("room").getOne(i,{expand:"scenarios"},{$cancelKey:"scenario"})}catch(m){alert(m),V("/dashboard")}r=result.expand.scenarios.contents}async function U(){r==null&&T();const m=await L.collection("room").getOne(i);return r.modules[m.module].questions[m.question]}async function C(){const m=await L.collection("room").getOne(i);console.log(t.id),console.log(t.org);const d={user:t.id,org:t.org,question:r.modules[m.module].questions[m.question],content:c,room:i};await L.collection("notes").create(d)!=Object?l(1,s="PREVIOUS MESSAGE WAS SENT PROPER"):console.log(m)}async function g(){let m=`(org='${t.org}' && user='${t.id}')`;return console.log(m),(await L.collection("notes").getList(1,50,{filter:m})).items}function O(){c=this.value,l(4,c)}return n.$$set=m=>{"roomID"in m&&l(0,i=m.roomID)},[i,s,p,I,c,T,U,C,O]}class $e extends x{constructor(e){super(),ee(this,e,Se,Re,G,{roomID:0})}}function Pe(n){return{c:f,l:f,m:f,p:f,i:f,o:f,d:f}}function qe(n){let e,l,t,o;const c=[Le,Ie],r=[];function b(i,s){return i[1]=="facilitator"?0:1}return e=b(n),l=r[e]=c[e](n),{c(){l.c(),t=q()},l(i){l.l(i),t=q()},m(i,s){r[e].m(i,s),k(i,t,s),o=!0},p(i,s){let a=e;e=b(i),e!==a&&(ue(),M(r[a],1,1,()=>{r[a]=null}),ie(),l=r[e],l||(l=r[e]=c[e](i),l.c()),H(l,1),l.m(t.parentNode,t))},i(i){o||(H(l),o=!0)},o(i){M(l),o=!1},d(i){r[e].d(i),i&&_(t)}}}function Ie(n){let e,l;return e=new $e({}),{c(){te(e.$$.fragment)},l(t){le(e.$$.fragment,t)},m(t,o){oe(e,t,o),l=!0},i(t){l||(H(e.$$.fragment,t),l=!0)},o(t){M(e.$$.fragment,t),l=!1},d(t){ne(e,t)}}}function Le(n){let e,l;return e=new pe({}),{c(){te(e.$$.fragment)},l(t){le(e.$$.fragment,t)},m(t,o){oe(e,t,o),l=!0},i(t){l||(H(e.$$.fragment,t),l=!0)},o(t){M(e.$$.fragment,t),l=!1},d(t){ne(e,t)}}}function Te(n){return{c:f,l:f,m:f,p:f,i:f,o:f,d:f}}function Ue(n){let e,l,t,o={ctx:n,current:null,token:null,hasCatch:!1,pending:Te,then:qe,catch:Pe,value:1,blocks:[,,,]};return A(l=n[0],o),{c(){e=q(),o.block.c()},l(c){e=q(),o.block.l(c)},m(c,r){k(c,e,r),o.block.m(c,o.anchor=r),o.mount=()=>e.parentNode,o.anchor=e,t=!0},p(c,[r]){n=c,o.ctx=n,r&1&&l!==(l=n[0])&&A(l,o)||B(o,n,r)},i(c){t||(H(o.block),t=!0)},o(c){for(let r=0;r<3;r+=1){const b=o.blocks[r];M(b)}t=!1},d(c){c&&_(e),o.block.d(c),o.token=null,o=null}}}function Ae(n,e,l){let t;return j(n,_e,o=>l(0,t=o)),[t]}class Be extends x{constructor(e){super(),ee(this,e,Ae,Ue,G,{})}}export{Be as default};
