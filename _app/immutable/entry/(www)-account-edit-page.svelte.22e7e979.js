import{S as Nt,i as Ot,s as Pt,D as Rt,e as rt,b as v,H as Ut,g as x,d as at,h as i,L as _t,o as St,R as Dt,n as w,k as d,a as O,r as U,l as p,m as y,c as P,u as A,p as b,G as u,w as Gt,f as Yt,x as Ft,P as Wt,z as At,A as Ct,q as ot,V as st,B as It,M as J,W as nt,v as Lt,Q as qt,C as Mt,N as mt,Y as jt}from"../chunks/index.d8729f0b.js";import{u as Vt}from"../chunks/useForm.f7d2ec9d.js";import{v as ct,r as ft}from"../chunks/validators.6e79bf68.js";import{c as zt,a as Qt,p as $}from"../chunks/pocketbase.f160ef4f.js";import{g as ut}from"../chunks/navigation.40f10652.js";import{M as Jt}from"../chunks/Modal.0c83b870.js";function Kt(n){return{c:w,l:w,m:w,p:w,i:w,o:w,d:w}}function Xt(n){let e,l,t={ctx:n,current:null,token:null,hasCatch:!1,pending:re,then:$t,catch:Zt,value:21,blocks:[,,,]};return Rt(zt,t),{c(){e=rt(),t.block.c()},l(o){e=rt(),t.block.l(o)},m(o,a){v(o,e,a),t.block.m(o,t.anchor=a),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,a){n=o,Ut(t,n,a)},i(o){l||(x(t.block),l=!0)},o(o){for(let a=0;a<3;a+=1){const r=t.blocks[a];at(r)}l=!1},d(o){o&&i(e),t.block.d(o),t.token=null,t=null}}}function Zt(n){return{c:w,l:w,m:w,p:w,i:w,o:w,d:w}}function $t(n){let e,l,t=n[6]&&Tt(n);return{c(){t&&t.c(),e=rt()},l(o){t&&t.l(o),e=rt()},m(o,a){t&&t.m(o,a),v(o,e,a),l=!0},p(o,a){o[6]?t?(t.p(o,a),a&64&&x(t,1)):(t=Tt(o),t.c(),x(t,1),t.m(e.parentNode,e)):t&&(Gt(),at(t,1,1,()=>{t=null}),Yt())},i(o){l||(x(t),l=!0)},o(o){at(t),l=!1},d(o){t&&t.d(o),o&&i(e)}}}function Tt(n){let e,l,t,o=n[6].username+"",a,r,s,m,E,N,f,h,_,z,C,T,Q,S,I,H,q,j,V,k,g,tt,K,L,R,M,D,G,et,W,Y,F,lt,dt,bt;function Ht(c){n[19](c)}let ht={$$slots:{default:[oe]},$$scope:{ctx:n}};return n[0]!==void 0&&(ht.showModal=n[0]),Y=new Jt({props:ht}),Ft.push(()=>Wt(Y,"showModal",Ht)),{c(){e=d("hgroup"),l=d("h1"),t=U("Edit settings for "),a=U(o),r=O(),s=d("h2"),m=U("Express yourself!"),E=O(),N=d("article"),f=d("label"),h=U(`Username
					`),_=d("input"),z=U(`

					Email Address
					`),C=d("input"),Q=O(),S=d("label"),I=U(`Profile Picture
						`),H=d("input"),q=O(),j=d("br"),V=O(),k=d("div"),g=d("button"),tt=U("Back to Settings"),K=O(),L=d("button"),R=U("Submit"),M=O(),D=d("center"),G=d("button"),et=U("Delete Account"),W=O(),At(Y.$$.fragment),this.h()},l(c){e=p(c,"HGROUP",{});var B=y(e);l=p(B,"H1",{style:!0});var X=y(l);t=A(X,"Edit settings for "),a=A(X,o),X.forEach(i),r=P(B),s=p(B,"H2",{});var kt=y(s);m=A(kt,"Express yourself!"),kt.forEach(i),B.forEach(i),E=P(c),N=p(c,"ARTICLE",{});var yt=y(N);f=p(yt,"LABEL",{});var Z=y(f);h=A(Z,`Username
					`),_=p(Z,"INPUT",{type:!0,name:!0,id:!0}),z=A(Z,`

					Email Address
					`),C=p(Z,"INPUT",{type:!0,name:!0,id:!0}),Q=P(Z),S=p(Z,"LABEL",{for:!0});var pt=y(S);I=A(pt,`Profile Picture
						`),H=p(pt,"INPUT",{type:!0,id:!0,name:!0,accept:!0}),pt.forEach(i),Z.forEach(i),yt.forEach(i),q=P(c),j=p(c,"BR",{}),V=P(c),k=p(c,"DIV",{class:!0});var it=y(k);g=p(it,"BUTTON",{class:!0});var vt=y(g);tt=A(vt,"Back to Settings"),vt.forEach(i),K=P(it),L=p(it,"BUTTON",{});var Et=y(L);R=A(Et,"Submit"),Et.forEach(i),it.forEach(i),M=P(c),D=p(c,"CENTER",{});var wt=y(D);G=p(wt,"BUTTON",{class:!0,"data-target":!0,style:!0,"data-tooltip":!0});var gt=y(G);et=A(gt,"Delete Account"),gt.forEach(i),wt.forEach(i),W=P(c),Ct(Y.$$.fragment,c),this.h()},h(){ot(l,"font-size","40px"),b(_,"type","text"),b(_,"name","new_username"),b(_,"id","new_username"),b(C,"type","text"),b(C,"name","new_emailaddr"),b(C,"id","new_emailaddr"),C.value=T=n[6].email,C.disabled=!0,b(H,"type","file"),b(H,"id","pfp"),b(H,"name","pfp"),b(H,"accept","image/*"),H.disabled=!0,b(S,"for","file"),b(g,"class","secondary"),b(k,"class","grid"),b(G,"class","outline contrast"),b(G,"data-target","modal-example"),ot(G,"width","50%"),b(G,"data-tooltip","This button is dangerous!")},m(c,B){v(c,e,B),u(e,l),u(l,t),u(l,a),u(e,r),u(e,s),u(s,m),v(c,E,B),v(c,N,B),u(N,f),u(f,h),u(f,_),st(_,n[3]),u(f,z),u(f,C),u(f,Q),u(f,S),u(S,I),u(S,H),v(c,q,B),v(c,j,B),v(c,V,B),v(c,k,B),u(k,g),u(g,tt),u(k,K),u(k,L),u(L,R),v(c,M,B),v(c,D,B),u(D,G),u(G,et),v(c,W,B),It(Y,c,B),lt=!0,dt||(bt=[J(_,"input",n[15]),nt(ct.call(null,_,[ft])),nt(ct.call(null,C,[ft])),J(H,"change",n[16]),J(g,"click",n[11]),J(L,"click",n[10]),J(G,"click",n[17])],dt=!0)},p(c,B){(!lt||B&64)&&o!==(o=c[6].username+"")&&Lt(a,o),B&8&&_.value!==c[3]&&st(_,c[3]),(!lt||B&64&&T!==(T=c[6].email)&&C.value!==T)&&(C.value=T);const X={};B&4194790&&(X.$$scope={dirty:B,ctx:c}),!F&&B&1&&(F=!0,X.showModal=c[0],qt(()=>F=!1)),Y.$set(X)},i(c){lt||(x(Y.$$.fragment,c),lt=!0)},o(c){at(Y.$$.fragment,c),lt=!1},d(c){c&&i(e),c&&i(E),c&&i(N),c&&i(q),c&&i(j),c&&i(V),c&&i(k),c&&i(M),c&&i(D),c&&i(W),Mt(Y,c),dt=!1,mt(bt)}}}function Bt(n){let e,l,t;function o(s,m){return s[6].role!="facilitator"?te:xt}let a=o(n),r=a(n);return{c(){r.c(),e=O(),l=d("br"),t=d("br")},l(s){r.l(s),e=P(s),l=p(s,"BR",{}),t=p(s,"BR",{})},m(s,m){r.m(s,m),v(s,e,m),v(s,l,m),v(s,t,m)},p(s,m){a===(a=o(s))&&r?r.p(s,m):(r.d(1),r=a(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&i(e),s&&i(l),s&&i(t)}}}function xt(n){let e,l,t,o;return{c(){e=U('As the facilitator, your organization "'),l=d("b"),t=U(n[1]),o=U(`" will be deleted
									as well!`)},l(a){e=A(a,'As the facilitator, your organization "'),l=p(a,"B",{});var r=y(l);t=A(r,n[1]),r.forEach(i),o=A(a,`" will be deleted
									as well!`)},m(a,r){v(a,e,r),v(a,l,r),u(l,t),v(a,o,r)},p(a,r){r&2&&Lt(t,a[1])},d(a){a&&i(e),a&&i(l),a&&i(o)}}}function te(n){let e;return{c(){e=U("You'll need another invite code to join back into your organization.")},l(l){e=A(l,"You'll need another invite code to join back into your organization.")},m(l,t){v(l,e,t)},p:w,d(l){l&&i(e)}}}function ee(n){let e,l,t,o,a,r,s,m,E,N;return{c(){e=d("fieldset"),l=d("label"),t=d("input"),o=U(`
										I will take responsibility for my actions.`),a=O(),r=d("button"),s=U("Confirm"),this.h()},l(f){e=p(f,"FIELDSET",{});var h=y(e);l=p(h,"LABEL",{for:!0,style:!0});var _=y(l);t=p(_,"INPUT",{type:!0,id:!0,name:!0}),o=A(_,`
										I will take responsibility for my actions.`),_.forEach(i),h.forEach(i),a=P(f),r=p(f,"BUTTON",{"aria-busy":!0,"data-target":!0});var z=y(r);s=A(z,"Confirm"),z.forEach(i),this.h()},h(){b(t,"type","checkbox"),b(t,"id","org_confirm"),b(t,"name","terms"),b(l,"for","org_confirm"),ot(l,"text-align","center"),b(r,"aria-busy",n[2]),b(r,"data-target","modal-example"),r.disabled=m=!n[8].valid},m(f,h){v(f,e,h),u(e,l),u(l,t),u(l,o),v(f,a,h),v(f,r,h),u(r,s),E||(N=[nt(ct.call(null,t,[ft])),J(r,"click",n[12])],E=!0)},p(f,h){h&4&&b(r,"aria-busy",f[2]),h&256&&m!==(m=!f[8].valid)&&(r.disabled=m)},d(f){f&&i(e),f&&i(a),f&&i(r),E=!1,mt(N)}}}function le(n){let e,l,t,o,a;return{c(){e=d("button"),l=U("Confirm"),this.h()},l(r){e=p(r,"BUTTON",{"data-target":!0});var s=y(e);l=A(s,"Confirm"),s.forEach(i),this.h()},h(){b(e,"data-target","modal-example"),e.disabled=t=!n[8].valid},m(r,s){v(r,e,s),u(e,l),o||(a=J(e,"click",n[12]),o=!0)},p(r,s){s&256&&t!==(t=!r[8].valid)&&(e.disabled=t)},d(r){r&&i(e),o=!1,a()}}}function oe(n){let e,l,t,o,a,r,s,m,E,N,f,h,_,z,C,T,Q,S,I,H,q,j,V,k,g=n[7]&&Bt(n);function tt(R,M){return R[6].role!="facilitator"?le:ee}let K=tt(n),L=K(n);return{c(){e=d("article"),l=d("hgroup"),t=d("h1"),o=U("Woah there!"),a=O(),r=d("h4"),s=U("Are you sure that you want to delete your account?"),m=O(),E=d("h5"),N=d("br"),f=O(),g&&g.c(),h=O(),_=d("input"),z=O(),C=d("footer"),T=d("form"),Q=d("br"),S=O(),I=d("input"),H=O(),q=d("br"),j=O(),L.c(),this.h()},l(R){e=p(R,"ARTICLE",{});var M=y(e);l=p(M,"HGROUP",{});var D=y(l);t=p(D,"H1",{});var G=y(t);o=A(G,"Woah there!"),G.forEach(i),a=P(D),r=p(D,"H4",{});var et=y(r);s=A(et,"Are you sure that you want to delete your account?"),et.forEach(i),m=P(D),E=p(D,"H5",{});var W=y(E);N=p(W,"BR",{}),f=P(W),g&&g.l(W),h=P(W),_=p(W,"INPUT",{style:!0,type:!0}),W.forEach(i),D.forEach(i),z=P(M),C=p(M,"FOOTER",{});var Y=y(C);T=p(Y,"FORM",{method:!0});var F=y(T);Q=p(F,"BR",{}),S=P(F),I=p(F,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),H=P(F),q=p(F,"BR",{}),j=P(F),L.l(F),F.forEach(i),Y.forEach(i),M.forEach(i),this.h()},h(){ot(_,"border","2px solid red"),ot(_,"border-radius","5px"),ot(_,"text-align","center"),b(_,"type","text"),_.value="This action can not be undone!",_.readOnly=!0,b(I,"type","password"),b(I,"name","del_confirm_pass"),b(I,"id","del_confrim_pass"),b(I,"placeholder","Your current password, please!"),b(T,"method","POST")},m(R,M){v(R,e,M),u(e,l),u(l,t),u(t,o),u(l,a),u(l,r),u(r,s),u(l,m),u(l,E),u(E,N),u(E,f),g&&g.m(E,null),u(E,h),u(E,_),u(e,z),u(e,C),u(C,T),u(T,Q),u(T,S),u(T,I),st(I,n[5]),u(T,H),u(T,q),u(T,j),L.m(T,null),V||(k=[J(I,"input",n[18]),nt(ct.call(null,I,[ft])),nt(n[9].call(null,T)),J(T,"submit",jt(n[14]))],V=!0)},p(R,M){R[7]?g?g.p(R,M):(g=Bt(R),g.c(),g.m(E,h)):g&&(g.d(1),g=null),M&32&&I.value!==R[5]&&st(I,R[5]),K===(K=tt(R))&&L?L.p(R,M):(L.d(1),L=K(R),L&&(L.c(),L.m(T,null)))},d(R){R&&i(e),g&&g.d(),L.d(),V=!1,mt(k)}}}function re(n){return{c:w,l:w,m:w,p:w,i:w,o:w,d:w}}function ae(n){let e,l,t,o,a,r,s,m,E;return{c(){e=d("center"),l=d("br"),t=O(),o=d("hgroup"),a=d("h1"),r=U("Loading..."),s=O(),m=d("h2"),E=U("Give it a second..."),this.h()},l(N){e=p(N,"CENTER",{});var f=y(e);l=p(f,"BR",{}),t=P(f),o=p(f,"HGROUP",{});var h=y(o);a=p(h,"H1",{"aria-busy":!0});var _=y(a);r=A(_,"Loading..."),_.forEach(i),s=P(h),m=p(h,"H2",{});var z=y(m);E=A(z,"Give it a second..."),z.forEach(i),h.forEach(i),f.forEach(i),this.h()},h(){b(a,"aria-busy","true")},m(N,f){v(N,e,f),u(e,l),u(e,t),u(e,o),u(o,a),u(a,r),u(o,s),u(o,m),u(m,E)},p:w,i:w,o:w,d(N){N&&i(e)}}}function ne(n){let e,l,t={ctx:n,current:null,token:null,hasCatch:!1,pending:ae,then:Xt,catch:Kt,blocks:[,,,]};return Rt(n[13](),t),{c(){e=rt(),t.block.c()},l(o){e=rt(),t.block.l(o)},m(o,a){v(o,e,a),t.block.m(o,t.anchor=a),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,[a]){n=o,Ut(t,n,a)},i(o){l||(x(t.block),l=!0)},o(o){for(let a=0;a<3;a+=1){const r=t.blocks[a];at(r)}l=!1},d(o){o&&i(e),t.block.d(o),t.token=null,t=null}}}function ie(n,e,l){let t,o,a;_t(n,zt,k=>l(6,t=k)),_t(n,Qt,k=>l(7,o=k));let r=!1,s,m=!1;const E=Vt();_t(n,E,k=>l(8,a=k));const N=new FormData;var f="",h="",_="";async function z(){try{await $.collection("users").update(t.id,{username:f}),h!=""&&(N.append("documents",h),$.collection("users").update(t.id,N)),ut("/account")}catch(k){console.log(k),alert("Something went wrong, please try again!")}}async function C(){ut("/account")}async function T(){try{l(2,m=!0),await $.collection("users").authWithPassword(t.email,_)}catch{l(2,m=!1),alert("Your password was incorrect!");return}try{t.role=="facilitator"?await $.collection("organization").delete(o):await $.collection("users").delete(t.id)}catch(k){l(2,m=!1),console.log(k),alert("Something went wrong, please try again!")}$.authStore.clear(),ut("/")}async function Q(){if(o){const k=await $.collection("organization").getOne(t==null?void 0:t.org);l(1,s=k.name)}}St(()=>{t?l(3,f=t.username):ut("/login")});function S(k){Dt.call(this,n,k)}function I(){f=this.value,l(3,f)}function H(){h=this.value,l(4,h)}const q=()=>l(0,r=!0);function j(){_=this.value,l(5,_)}function V(k){r=k,l(0,r)}return[r,s,m,f,h,_,t,o,a,E,z,C,T,Q,S,I,H,q,j,V]}class ue extends Nt{constructor(e){super(),Ot(this,e,ie,ne,Pt,{})}}function se(n){let e,l,t,o,a;return l=new ue({}),{c(){e=d("body"),At(l.$$.fragment),t=O(),o=d("pre")},l(r){e=p(r,"BODY",{});var s=y(e);Ct(l.$$.fragment,s),s.forEach(i),t=P(r),o=p(r,"PRE",{}),y(o).forEach(i)},m(r,s){v(r,e,s),It(l,e,null),v(r,t,s),v(r,o,s),a=!0},p:w,i(r){a||(x(l.$$.fragment,r),a=!0)},o(r){at(l.$$.fragment,r),a=!1},d(r){r&&i(e),Mt(l),r&&i(t),r&&i(o)}}}class be extends Nt{constructor(e){super(),Ot(this,e,null,se,Pt,{})}}export{be as default};
