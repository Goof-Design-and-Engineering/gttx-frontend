import{S as ot,i as lt,s as ut,D as it,e as z,b as P,H as ct,n as h,h as l,L as pt,o as dt,Y as ft,k as m,r as E,a as H,l as _,m as g,u as N,c as I,q as mt,p,G as u,O as C,M as A,a4 as M,a5 as _t,v as ht,N as wt,z as bt,A as vt,B as Pt,g as kt,d as yt,C as gt}from"../chunks/index.b95161bf.js";import{u as St,v as K,r as Q}from"../chunks/validators.c220a831.js";import{c as x,p as X}from"../chunks/pocketbase.c09fd52b.js";import{g as Z}from"../chunks/navigation.7a5a56af.js";function Et(n){return{c:h,l:h,m:h,p:h,d:h}}function Nt(n){let a,t=n[3]&&nt(n);return{c(){t&&t.c(),a=z()},l(e){t&&t.l(e),a=z()},m(e,r){t&&t.m(e,r),P(e,a,r)},p(e,r){e[3]?t?t.p(e,r):(t=nt(e),t.c(),t.m(a.parentNode,a)):t&&(t.d(1),t=null)},d(e){t&&t.d(e),e&&l(a)}}}function nt(n){let a,t,e,r=n[3].username+"",c,o,d,R,T,k,w,Y,f,y,b,F,v,$,q,D,S,B,G,V,U,W,j,tt;return{c(){a=m("hgroup"),t=m("h1"),e=E("Password Change for "),c=E(r),o=H(),d=m("h2"),R=E("Be careful! Password changes are permanent!"),T=H(),k=m("form"),w=m("label"),Y=E(`Old Password
				`),f=m("input"),y=E(`

				New Password
				`),b=m("input"),F=E(`

				New Password (...Again)
				`),v=m("input"),$=H(),q=m("br"),D=H(),S=m("div"),B=m("button"),G=E("Back to Settings"),V=H(),U=m("button"),W=E("Submit"),this.h()},l(s){a=_(s,"HGROUP",{});var i=g(a);t=_(i,"H1",{style:!0});var J=g(t);e=N(J,"Password Change for "),c=N(J,r),J.forEach(l),o=I(i),d=_(i,"H2",{});var et=g(d);R=N(et,"Be careful! Password changes are permanent!"),et.forEach(l),i.forEach(l),T=I(s),k=_(s,"FORM",{method:!0});var at=g(k);w=_(at,"LABEL",{});var O=g(w);Y=N(O,`Old Password
				`),f=_(O,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),y=N(O,`

				New Password
				`),b=_(O,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),F=N(O,`

				New Password (...Again)
				`),v=_(O,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),O.forEach(l),at.forEach(l),$=I(s),q=_(s,"BR",{}),D=I(s),S=_(s,"DIV",{class:!0});var L=g(S);B=_(L,"BUTTON",{class:!0});var st=g(B);G=N(st,"Back to Settings"),st.forEach(l),V=I(L),U=_(L,"BUTTON",{});var rt=g(U);W=N(rt,"Submit"),rt.forEach(l),L.forEach(l),this.h()},h(){mt(t,"font-size","40px"),p(f,"type","password"),p(f,"name","oldpassword"),p(f,"id","password"),p(f,"placeholder","hunter2"),p(b,"type","password"),p(b,"name","oldpassword"),p(b,"id","password"),p(b,"placeholder","SuperSecure69"),p(v,"type","password"),p(v,"name","new_password_again"),p(v,"id","password"),p(v,"placeholder","SuperSecure69"),p(k,"method","POST"),p(B,"class","secondary"),p(S,"class","grid")},m(s,i){P(s,a,i),u(a,t),u(t,e),u(t,c),u(a,o),u(a,d),u(d,R),P(s,T,i),P(s,k,i),u(k,w),u(w,Y),u(w,f),C(f,n[0]),u(w,y),u(w,b),C(b,n[1]),u(w,F),u(w,v),C(v,n[2]),P(s,$,i),P(s,q,i),P(s,D,i),P(s,S,i),u(S,B),u(B,G),u(S,V),u(S,U),u(U,W),j||(tt=[A(f,"input",n[8]),M(K.call(null,f,[Q])),A(b,"input",n[9]),M(K.call(null,b,[Q])),A(v,"input",n[10]),M(K.call(null,v,[Q])),M(n[4].call(null,k)),A(k,"submit",_t(n[7])),A(B,"click",n[6]),A(U,"click",n[5])],j=!0)},p(s,i){i&8&&r!==(r=s[3].username+"")&&ht(c,r),i&1&&f.value!==s[0]&&C(f,s[0]),i&2&&b.value!==s[1]&&C(b,s[1]),i&4&&v.value!==s[2]&&C(v,s[2])},d(s){s&&l(a),s&&l(T),s&&l(k),s&&l($),s&&l(q),s&&l(D),s&&l(S),j=!1,wt(tt)}}}function Bt(n){return{c:h,l:h,m:h,p:h,d:h}}function Ot(n){let a,t={ctx:n,current:null,token:null,hasCatch:!1,pending:Bt,then:Nt,catch:Et,value:11};return it(x,t),{c(){a=z(),t.block.c()},l(e){a=z(),t.block.l(e)},m(e,r){P(e,a,r),t.block.m(e,t.anchor=r),t.mount=()=>a.parentNode,t.anchor=a},p(e,[r]){n=e,ct(t,n,r)},i:h,o:h,d(e){e&&l(a),t.block.d(e),t.token=null,t=null}}}function Tt(n,a,t){let e;pt(n,x,y=>t(3,e=y));var r="",c="",o="";const d=St();async function R(){console.log(x);try{if(await X.collection("users").authWithPassword(e.username,r),c==o&&c!=""){console.log("Passwords matched, clearing auth and updating password!");try{await X.collection("users").update(e.id,{oldPassword:r,password:c,passwordConfirm:o}),X.authStore.clear(),Z("/login")}catch(y){console.log(y),alert("Something went wrong, please try again.")}}else alert("Your passwords do not match!")}catch(y){console.log(y),alert("Your old password was not correct!")}}async function T(){Z("/account")}dt(()=>{e||Z("/login")});function k(y){ft.call(this,n,y)}function w(){r=this.value,t(0,r)}function Y(){c=this.value,t(1,c)}function f(){o=this.value,t(2,o)}return[r,c,o,e,d,R,T,k,w,Y,f]}class Ut extends ot{constructor(a){super(),lt(this,a,Tt,Ot,ut,{})}}function Ct(n){let a,t,e,r,c;return t=new Ut({}),{c(){a=m("body"),bt(t.$$.fragment),e=H(),r=m("pre")},l(o){a=_(o,"BODY",{});var d=g(a);vt(t.$$.fragment,d),d.forEach(l),e=I(o),r=_(o,"PRE",{}),g(r).forEach(l)},m(o,d){P(o,a,d),Pt(t,a,null),P(o,e,d),P(o,r,d),c=!0},p:h,i(o){c||(kt(t.$$.fragment,o),c=!0)},o(o){yt(t.$$.fragment,o),c=!1},d(o){o&&l(a),gt(t),o&&l(e),o&&l(r)}}}class Yt extends ot{constructor(a){super(),lt(this,a,null,Ct,ut,{})}}export{Yt as default};
