import{S as oe,i as ue,s as ie,D as ce,e as W,b as k,H as fe,n as b,h as o,L as le,o as de,R as me,k as _,r as B,a as H,l as h,m as g,u as O,c as I,q as _e,p as c,G as p,W as R,M as A,X as G,Z as he,v as be,N as we,z as ve,A as ke,B as ye,g as Pe,d as Se,C as ge}from"../chunks/index.4fc2f4c3.js";import{u as Ee}from"../chunks/useForm.24789db4.js";import{v as K,r as Q}from"../chunks/validators.c512e31b.js";import{c as pe,p as $}from"../chunks/pocketbase.cc5ca80f.js";import{g as x}from"../chunks/navigation.3dc8513e.js";function Ne(r){return{c:b,l:b,m:b,p:b,d:b}}function Be(r){let a,e=r[4]&&ne(r);return{c(){e&&e.c(),a=W()},l(t){e&&e.l(t),a=W()},m(t,n){e&&e.m(t,n),k(t,a,n)},p(t,n){t[4]?e?e.p(t,n):(e=ne(t),e.c(),e.m(a.parentNode,a)):e&&(e.d(1),e=null)},d(t){e&&e.d(t),t&&o(a)}}}function ne(r){let a,e,t,n=r[4].username+"",f,l,i,E,T,y,w,q,d,D,m,P,v,L,M,Y,N,U,V,X,S,Z,z,j,ee;return{c(){a=_("hgroup"),e=_("h1"),t=B("Password Change for "),f=B(n),l=H(),i=_("h2"),E=B("Be careful! Password changes are permanent!"),T=H(),y=_("form"),w=_("label"),q=B(`Old Password
				`),d=_("input"),D=B(`

				New Password
				`),m=_("input"),P=B(`

				New Password (...Again)
				`),v=_("input"),L=H(),M=_("br"),Y=H(),N=_("div"),U=_("button"),V=B("Back to Settings"),X=H(),S=_("button"),Z=B("Submit"),this.h()},l(s){a=h(s,"HGROUP",{});var u=g(a);e=h(u,"H1",{style:!0});var J=g(e);t=O(J,"Password Change for "),f=O(J,n),J.forEach(o),l=I(u),i=h(u,"H2",{});var te=g(i);E=O(te,"Be careful! Password changes are permanent!"),te.forEach(o),u.forEach(o),T=I(s),y=h(s,"FORM",{method:!0});var ae=g(y);w=h(ae,"LABEL",{});var C=g(w);q=O(C,`Old Password
				`),d=h(C,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),D=O(C,`

				New Password
				`),m=h(C,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),P=O(C,`

				New Password (...Again)
				`),v=h(C,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),C.forEach(o),ae.forEach(o),L=I(s),M=h(s,"BR",{}),Y=I(s),N=h(s,"DIV",{class:!0});var F=g(N);U=h(F,"BUTTON",{class:!0});var se=g(U);V=O(se,"Back to Settings"),se.forEach(o),X=I(F),S=h(F,"BUTTON",{"aria-busy":!0});var re=g(S);Z=O(re,"Submit"),re.forEach(o),F.forEach(o),this.h()},h(){_e(e,"font-size","40px"),c(d,"type","password"),c(d,"name","oldpassword"),c(d,"id","password"),c(d,"placeholder","hunter2"),c(m,"type","password"),c(m,"name","oldpassword"),c(m,"id","password"),c(m,"placeholder","SuperSecure69"),c(v,"type","password"),c(v,"name","new_password_again"),c(v,"id","password"),c(v,"placeholder","SuperSecure69"),c(y,"method","POST"),c(U,"class","secondary"),S.disabled=z=!r[5].valid,c(S,"aria-busy",r[3]),c(N,"class","grid")},m(s,u){k(s,a,u),p(a,e),p(e,t),p(e,f),p(a,l),p(a,i),p(i,E),k(s,T,u),k(s,y,u),p(y,w),p(w,q),p(w,d),R(d,r[0]),p(w,D),p(w,m),R(m,r[1]),p(w,P),p(w,v),R(v,r[2]),k(s,L,u),k(s,M,u),k(s,Y,u),k(s,N,u),p(N,U),p(U,V),p(N,X),p(N,S),p(S,Z),j||(ee=[A(d,"input",r[10]),G(K.call(null,d,[Q])),A(m,"input",r[11]),G(K.call(null,m,[Q])),A(v,"input",r[12]),G(K.call(null,v,[Q])),G(r[6].call(null,y)),A(y,"submit",he(r[9])),A(U,"click",r[8]),A(S,"click",r[7])],j=!0)},p(s,u){u&16&&n!==(n=s[4].username+"")&&be(f,n),u&1&&d.value!==s[0]&&R(d,s[0]),u&2&&m.value!==s[1]&&R(m,s[1]),u&4&&v.value!==s[2]&&R(v,s[2]),u&32&&z!==(z=!s[5].valid)&&(S.disabled=z),u&8&&c(S,"aria-busy",s[3])},d(s){s&&o(a),s&&o(T),s&&o(y),s&&o(L),s&&o(M),s&&o(Y),s&&o(N),j=!1,we(ee)}}}function Oe(r){return{c:b,l:b,m:b,p:b,d:b}}function Te(r){let a,e={ctx:r,current:null,token:null,hasCatch:!1,pending:Oe,then:Be,catch:Ne,value:13};return ce(pe,e),{c(){a=W(),e.block.c()},l(t){a=W(),e.block.l(t)},m(t,n){k(t,a,n),e.block.m(t,e.anchor=n),e.mount=()=>a.parentNode,e.anchor=a},p(t,[n]){r=t,fe(e,r,n)},i:b,o:b,d(t){t&&o(a),e.block.d(t),e.token=null,e=null}}}function Ue(r,a,e){let t,n;le(r,pe,P=>e(4,t=P));var f="",l="",i="";let E=!1;const T=Ee();le(r,T,P=>e(5,n=P));async function y(){try{if(e(3,E=!0),await $.collection("users").authWithPassword(t.username,f),l==i&&l!="")try{await $.collection("users").update(t.id,{oldPassword:f,password:l,passwordConfirm:i}),$.authStore.clear(),x("/login")}catch{e(3,E=!1),alert("Something went wrong, please try again.")}else e(3,E=!1),alert("Your passwords do not match!")}catch{e(3,E=!1),alert("Your old password was not correct!")}}async function w(){x("/account")}de(()=>{t||x("/login")});function q(P){me.call(this,r,P)}function d(){f=this.value,e(0,f)}function D(){l=this.value,e(1,l)}function m(){i=this.value,e(2,i)}return[f,l,i,E,t,n,T,y,w,q,d,D,m]}class Ce extends oe{constructor(a){super(),ue(this,a,Ue,Te,ie,{})}}function Re(r){let a,e,t,n,f;return e=new Ce({}),{c(){a=_("body"),ve(e.$$.fragment),t=H(),n=_("pre")},l(l){a=h(l,"BODY",{});var i=g(a);ke(e.$$.fragment,i),i.forEach(o),t=I(l),n=h(l,"PRE",{}),g(n).forEach(o)},m(l,i){k(l,a,i),ye(e,a,null),k(l,t,i),k(l,n,i),f=!0},p:b,i(l){f||(Pe(e.$$.fragment,l),f=!0)},o(l){Se(e.$$.fragment,l),f=!1},d(l){l&&o(a),ge(e),l&&o(t),l&&o(n)}}}class Le extends oe{constructor(a){super(),ue(this,a,null,Re,ie,{})}}export{Le as default};
