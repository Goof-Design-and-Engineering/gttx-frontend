import{S as Fe,i as Le,s as ze,D as We,a as M,k as _,e as pe,c as C,l as p,m as h,h as u,b as k,H as Ye,g as ue,w as qe,d as de,f as Ue,L as Pe,o as Ve,O as Qe,r as v,u as E,v as x,x as Xe,P as Ze,z as He,A as Ae,B as Se,Q as je,C as De,R as Je,T as Ke,n as le,p as H,G as i,U as $e,V as xe,q as et,W as we,M as ne,X as Re,Y as be,Z as tt,N as Ge,_ as lt,$ as Ie}from"../chunks/index.4fc2f4c3.js";import{u as ot}from"../chunks/useForm.24789db4.js";import{v as at,r as rt}from"../chunks/validators.c512e31b.js";import{c as it,p as te}from"../chunks/pocketbase.7918e77e.js";import{g as me}from"../chunks/navigation.7cb7a34e.js";import{M as nt}from"../chunks/Modal.d827c1df.js";function Ne(o,e,l){const t=o.slice();return t[23]=e[l],t[24]=e,t[25]=l,t}function Be(o){let e;return{c(){e=v(o[2])},l(l){e=E(l,o[2])},m(l,t){k(l,e,t)},p(l,t){t&4&&x(e,l[2])},d(l){l&&u(e)}}}function st(o){return{c:le,l:le,m:le,p:le,d:le}}function ut(o){let e,l,t,c=(o[0]||"Organization Name")+"",r,s,a,n,f,d,m,T,N,y,z,B,P,g,w,D,Q,Z,W,V,L,O,A,R,j,Y,X,G,oe,$,ee,q=[],K=new Map,F,ae=o[1];const S=b=>b[23].id;for(let b=0;b<ae.length;b+=1){let I=Ne(o,ae,b),U=S(I);K.set(U,q[b]=Me(U,I))}return{c(){e=_("header"),l=_("hgroup"),t=_("h1"),r=v(c),s=M(),a=_("h2"),n=v("Time for a change?"),f=M(),d=_("details"),m=_("summary"),T=v("Invite Codes"),N=M(),y=_("ul"),z=_("li"),B=_("p"),P=_("b"),g=v("Participant"),w=v(": "),D=v(o[3]),Q=M(),Z=_("li"),W=_("p"),V=_("b"),L=v("Observer"),O=v(": "),A=v(o[5]),R=M(),j=_("li"),Y=_("p"),X=_("b"),G=v("Facilitator"),oe=v(": "),$=v(o[4]),ee=M();for(let b=0;b<q.length;b+=1)q[b].c();F=pe(),this.h()},l(b){e=p(b,"HEADER",{});var I=h(e);l=p(I,"HGROUP",{});var U=h(l);t=p(U,"H1",{});var se=h(t);r=E(se,c),se.forEach(u),s=C(U),a=p(U,"H2",{});var J=h(a);n=E(J,"Time for a change?"),J.forEach(u),U.forEach(u),I.forEach(u),f=C(b),d=p(b,"DETAILS",{});var re=h(d);m=p(re,"SUMMARY",{role:!0,class:!0});var ve=h(m);T=E(ve,"Invite Codes"),ve.forEach(u),N=C(re),y=p(re,"UL",{});var ie=h(y);z=p(ie,"LI",{});var Ee=h(z);B=p(Ee,"P",{id:!0});var fe=h(B);P=p(fe,"B",{});var ye=h(P);g=E(ye,"Participant"),ye.forEach(u),w=E(fe,": "),D=E(fe,o[3]),fe.forEach(u),Ee.forEach(u),Q=C(ie),Z=p(ie,"LI",{});var ke=h(Z);W=p(ke,"P",{id:!0});var ce=h(W);V=p(ce,"B",{});var Oe=h(V);L=E(Oe,"Observer"),Oe.forEach(u),O=E(ce,": "),A=E(ce,o[5]),ce.forEach(u),ke.forEach(u),R=C(ie),j=p(ie,"LI",{});var ge=h(j);Y=p(ge,"P",{id:!0});var _e=h(Y);X=p(_e,"B",{});var Te=h(X);G=E(Te,"Facilitator"),Te.forEach(u),oe=E(_e,": "),$=E(_e,o[4]),_e.forEach(u),ge.forEach(u),ie.forEach(u),re.forEach(u),ee=C(b);for(let he=0;he<q.length;he+=1)q[he].l(b);F=pe(),this.h()},h(){H(m,"role","button"),H(m,"class","secondary"),H(B,"id","p_code"),H(W,"id","o_code"),H(Y,"id","f_code"),d.open=!0},m(b,I){k(b,e,I),i(e,l),i(l,t),i(t,r),i(l,s),i(l,a),i(a,n),k(b,f,I),k(b,d,I),i(d,m),i(m,T),i(d,N),i(d,y),i(y,z),i(z,B),i(B,P),i(P,g),i(B,w),i(B,D),i(y,Q),i(y,Z),i(Z,W),i(W,V),i(V,L),i(W,O),i(W,A),i(y,R),i(y,j),i(j,Y),i(Y,X),i(X,G),i(Y,oe),i(Y,$),k(b,ee,I);for(let U=0;U<q.length;U+=1)q[U].m(b,I);k(b,F,I)},p(b,I){I&1&&c!==(c=(b[0]||"Organization Name")+"")&&x(r,c),I&8&&x(D,b[3]),I&32&&x(A,b[5]),I&16&&x($,b[4]),I&150530&&(ae=b[1],q=$e(q,I,S,1,b,ae,K,F.parentNode,xe,Me,F,Ne))},d(b){b&&u(e),b&&u(f),b&&u(d),b&&u(ee);for(let I=0;I<q.length;I+=1)q[I].d(b);b&&u(F)}}}function ft(o){let e=o[23].username+"",l;return{c(){l=v(e)},l(t){l=E(t,e)},m(t,c){k(t,l,c)},p(t,c){c&2&&e!==(e=t[23].username+"")&&x(l,e)},d(t){t&&u(l)}}}function ct(o){let e,l=o[23].username+"",t,c;return{c(){e=_("b"),t=v(l),c=v(" (that's you!)")},l(r){e=p(r,"B",{});var s=h(e);t=E(s,l),c=E(s," (that's you!)"),s.forEach(u)},m(r,s){k(r,e,s),i(e,t),i(e,c)},p(r,s){s&2&&l!==(l=r[23].username+"")&&x(t,l)},d(r){r&&u(e)}}}function _t(o){let e,l,t,c,r,s;function a(m,T){return m[23].role=="facilitator"?mt:m[23].role=="participant"?ht:dt}let n=a(o),f=n(o);function d(){o[19].call(e,o[25])}return{c(){e=_("select"),f.c(),l=M(),t=_("button"),c=v("Remove"),this.h()},l(m){e=p(m,"SELECT",{});var T=h(e);f.l(T),T.forEach(u),l=C(m),t=p(m,"BUTTON",{class:!0});var N=h(t);c=E(N,"Remove"),N.forEach(u),this.h()},h(){o[10][o[25]]===void 0&&lt(d),H(t,"class","primary")},m(m,T){k(m,e,T),f.m(e,null),Ie(e,o[10][o[25]]),k(m,l,T),k(m,t,T),i(t,c),r||(s=[ne(e,"change",d),ne(e,"change",function(){be(o[17](o[23].id,o[25]))&&o[17](o[23].id,o[25]).apply(this,arguments)}),ne(t,"click",function(){be(o[14](o[23]))&&o[14](o[23]).apply(this,arguments)})],r=!0)},p(m,T){o=m,n!==(n=a(o))&&(f.d(1),f=n(o),f&&(f.c(),f.m(e,null))),T&1026&&Ie(e,o[10][o[25]])},d(m){m&&u(e),f.d(),m&&u(l),m&&u(t),r=!1,Ge(s)}}}function pt(o){let e,l,t,c,r,s;return{c(){e=_("select"),l=_("option"),t=v("Facilitator"),c=M(),r=_("button"),s=v("Remove"),this.h()},l(a){e=p(a,"SELECT",{});var n=h(e);l=p(n,"OPTION",{});var f=h(l);t=E(f,"Facilitator"),f.forEach(u),n.forEach(u),c=C(a),r=p(a,"BUTTON",{class:!0});var d=h(r);s=E(d,"Remove"),d.forEach(u),this.h()},h(){l.__value="facilitator",l.value=l.__value,e.disabled=!0,H(r,"class","primary"),r.disabled="true"},m(a,n){k(a,e,n),i(e,l),i(l,t),k(a,c,n),k(a,r,n),i(r,s)},p:le,d(a){a&&u(e),a&&u(c),a&&u(r)}}}function dt(o){let e,l,t,c,r,s;return{c(){e=_("option"),l=v("Observer"),t=_("option"),c=v("Facilitator"),r=_("option"),s=v("Participant"),this.h()},l(a){e=p(a,"OPTION",{});var n=h(e);l=E(n,"Observer"),n.forEach(u),t=p(a,"OPTION",{});var f=h(t);c=E(f,"Facilitator"),f.forEach(u),r=p(a,"OPTION",{});var d=h(r);s=E(d,"Participant"),d.forEach(u),this.h()},h(){e.__value="observer",e.value=e.__value,e.selected=!0,t.__value="facilitator",t.value=t.__value,r.__value="participant",r.value=r.__value},m(a,n){k(a,e,n),i(e,l),k(a,t,n),i(t,c),k(a,r,n),i(r,s)},d(a){a&&u(e),a&&u(t),a&&u(r)}}}function ht(o){let e,l,t,c,r,s;return{c(){e=_("option"),l=v("Participant"),t=_("option"),c=v("Facilitator"),r=_("option"),s=v("Observer"),this.h()},l(a){e=p(a,"OPTION",{});var n=h(e);l=E(n,"Participant"),n.forEach(u),t=p(a,"OPTION",{});var f=h(t);c=E(f,"Facilitator"),f.forEach(u),r=p(a,"OPTION",{});var d=h(r);s=E(d,"Observer"),d.forEach(u),this.h()},h(){e.__value="participant",e.value=e.__value,e.selected=!0,t.__value="facilitator",t.value=t.__value,r.__value="observer",r.value=r.__value},m(a,n){k(a,e,n),i(e,l),k(a,t,n),i(t,c),k(a,r,n),i(r,s)},d(a){a&&u(e),a&&u(t),a&&u(r)}}}function mt(o){let e,l,t,c,r,s;return{c(){e=_("option"),l=v("Facilitator"),t=_("option"),c=v("Participant"),r=_("option"),s=v("Observer"),this.h()},l(a){e=p(a,"OPTION",{});var n=h(e);l=E(n,"Facilitator"),n.forEach(u),t=p(a,"OPTION",{});var f=h(t);c=E(f,"Participant"),f.forEach(u),r=p(a,"OPTION",{});var d=h(r);s=E(d,"Observer"),d.forEach(u),this.h()},h(){e.__value="facilitator",e.value=e.__value,e.selected=!0,t.__value="participant",t.value=t.__value,r.__value="observer",r.value=r.__value},m(a,n){k(a,e,n),i(e,l),k(a,t,n),i(t,c),k(a,r,n),i(r,s)},d(a){a&&u(e),a&&u(t),a&&u(r)}}}function Me(o,e){let l,t,c,r,s,a,n,f,d,m;function T(g,w){return g[23].id==g[11].id?ct:ft}let N=T(e),y=N(e);function z(g,w){return g[23].id==g[11].id?pt:_t}let B=z(e),P=B(e);return{key:o,first:null,c(){l=_("div"),y.c(),t=M(),c=_("hr"),r=M(),s=_("div"),a=_("input"),f=M(),P.c(),d=M(),m=_("br"),this.h()},l(g){l=p(g,"DIV",{});var w=h(l);y.l(w),t=C(w),c=p(w,"HR",{}),r=C(w),s=p(w,"DIV",{class:!0});var D=h(s);a=p(D,"INPUT",{type:!0,"aria-invalid":!0}),f=C(D),P.l(D),D.forEach(u),w.forEach(u),d=C(g),m=p(g,"BR",{}),this.h()},h(){H(a,"type","text"),a.value=n=e[23].email,H(a,"aria-invalid","false"),a.disabled=!0,H(s,"class","grid"),this.first=l},m(g,w){k(g,l,w),y.m(l,null),i(l,t),i(l,c),i(l,r),i(l,s),i(s,a),i(s,f),P.m(s,null),k(g,d,w),k(g,m,w)},p(g,w){e=g,N===(N=T(e))&&y?y.p(e,w):(y.d(1),y=N(e),y&&(y.c(),y.m(l,t))),w&2&&n!==(n=e[23].email)&&a.value!==n&&(a.value=n),B===(B=z(e))&&P?P.p(e,w):(P.d(1),P=B(e),P&&(P.c(),P.m(s,null)))},d(g){g&&u(l),y.d(),P.d(),g&&u(d),g&&u(m)}}}function bt(o){let e,l,t,c,r,s,a,n,f;return{c(){e=_("center"),l=_("br"),t=M(),c=_("hgroup"),r=_("h1"),s=v("Loading..."),a=M(),n=_("h2"),f=v("Give it a second..."),this.h()},l(d){e=p(d,"CENTER",{});var m=h(e);l=p(m,"BR",{}),t=C(m),c=p(m,"HGROUP",{});var T=h(c);r=p(T,"H1",{"aria-busy":!0});var N=h(r);s=E(N,"Loading..."),N.forEach(u),a=C(T),n=p(T,"H2",{});var y=h(n);f=E(y,"Give it a second..."),y.forEach(u),T.forEach(u),m.forEach(u),this.h()},h(){H(r,"aria-busy","true")},m(d,m){k(d,e,m),i(e,l),i(e,t),i(e,c),i(c,r),i(r,s),i(c,a),i(c,n),i(n,f)},p:le,d(d){d&&u(e)}}}function Ce(o){let e,l,t;function c(s){o[21](s)}let r={$$slots:{default:[vt]},$$scope:{ctx:o}};return o[6]!==void 0&&(r.showModal=o[6]),e=new nt({props:r}),Xe.push(()=>Ze(e,"showModal",c)),{c(){He(e.$$.fragment)},l(s){Ae(e.$$.fragment,s)},m(s,a){Se(e,s,a),t=!0},p(s,a){const n={};a&67113856&&(n.$$scope={dirty:a,ctx:s}),!l&&a&64&&(l=!0,n.showModal=s[6],je(()=>l=!1)),e.$set(n)},i(s){t||(ue(e.$$.fragment,s),t=!0)},o(s){de(e.$$.fragment,s),t=!1},d(s){De(e,s)}}}function vt(o){let e,l,t,c,r,s,a,n=o[7].username+"",f,d,m,T,N,y,z=o[7].username+"",B,P,g,w,D,Q,Z,W,V,L,O,A,R,j,Y,X,G,oe,$,ee,q;return{c(){e=_("article"),l=_("h3"),t=v("Woah there!"),c=M(),r=_("p"),s=v("Are you sure that you want to remove "),a=_("b"),f=v(n),d=v(` from your
				organization?
				`),m=_("br"),T=_("br"),N=v(`
				If you change your mind, you'll have to send `),y=_("b"),B=v(z),P=v(` another
				invite.
				`),g=_("br"),w=_("br"),D=M(),Q=_("b"),Z=v("This action can not be undone!"),W=M(),V=_("footer"),L=_("form"),O=_("br"),A=M(),R=_("input"),j=M(),Y=_("br"),X=M(),G=_("button"),oe=v("Confirm"),this.h()},l(K){e=p(K,"ARTICLE",{});var F=h(e);l=p(F,"H3",{});var ae=h(l);t=E(ae,"Woah there!"),ae.forEach(u),c=C(F),r=p(F,"P",{});var S=h(r);s=E(S,"Are you sure that you want to remove "),a=p(S,"B",{});var b=h(a);f=E(b,n),b.forEach(u),d=E(S,` from your
				organization?
				`),m=p(S,"BR",{}),T=p(S,"BR",{}),N=E(S,`
				If you change your mind, you'll have to send `),y=p(S,"B",{});var I=h(y);B=E(I,z),I.forEach(u),P=E(S,` another
				invite.
				`),g=p(S,"BR",{}),w=p(S,"BR",{}),D=C(S),Q=p(S,"B",{style:!0});var U=h(Q);Z=E(U,"This action can not be undone!"),U.forEach(u),S.forEach(u),W=C(F),V=p(F,"FOOTER",{});var se=h(V);L=p(se,"FORM",{method:!0});var J=h(L);O=p(J,"BR",{}),A=C(J),R=p(J,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),j=C(J),Y=p(J,"BR",{}),X=C(J),G=p(J,"BUTTON",{"data-target":!0,"aria-busy":!0});var re=h(G);oe=E(re,"Confirm"),re.forEach(u),J.forEach(u),se.forEach(u),F.forEach(u),this.h()},h(){et(Q,"color","red"),H(R,"type","password"),H(R,"name","del_confirm_pass"),H(R,"id","del_confrim_pass"),H(R,"placeholder","Your current password, please!"),H(G,"data-target","modal-example"),G.disabled=$=!o[12].valid||o[9],H(G,"aria-busy",o[9]),H(L,"method","POST")},m(K,F){k(K,e,F),i(e,l),i(l,t),i(e,c),i(e,r),i(r,s),i(r,a),i(a,f),i(r,d),i(r,m),i(r,T),i(r,N),i(r,y),i(y,B),i(r,P),i(r,g),i(r,w),i(r,D),i(r,Q),i(Q,Z),i(e,W),i(e,V),i(V,L),i(L,O),i(L,A),i(L,R),we(R,o[8]),i(L,j),i(L,Y),i(L,X),i(L,G),i(G,oe),ee||(q=[ne(R,"input",o[20]),Re(at.call(null,R,[rt])),ne(G,"click",function(){be(o[16](o[7].id))&&o[16](o[7].id).apply(this,arguments)}),Re(o[13].call(null,L)),ne(L,"submit",tt(o[18]))],ee=!0)},p(K,F){o=K,F&128&&n!==(n=o[7].username+"")&&x(f,n),F&128&&z!==(z=o[7].username+"")&&x(B,z),F&256&&R.value!==o[8]&&we(R,o[8]),F&4608&&$!==($=!o[12].valid||o[9])&&(G.disabled=$),F&512&&H(G,"aria-busy",o[9])},d(K){K&&u(e),ee=!1,Ge(q)}}}function Et(o){let e,l,t,c,r,s=o[2]!=""&&Be(o),a={ctx:o,current:null,token:null,hasCatch:!1,pending:bt,then:ut,catch:st};We(o[15](),a);let n=o[6]&&Ce(o);return{c(){s&&s.c(),e=M(),l=_("article"),a.block.c(),t=M(),n&&n.c(),c=pe()},l(f){s&&s.l(f),e=C(f),l=p(f,"ARTICLE",{});var d=h(l);a.block.l(d),d.forEach(u),t=C(f),n&&n.l(f),c=pe()},m(f,d){s&&s.m(f,d),k(f,e,d),k(f,l,d),a.block.m(l,a.anchor=null),a.mount=()=>l,a.anchor=null,k(f,t,d),n&&n.m(f,d),k(f,c,d),r=!0},p(f,[d]){o=f,o[2]!=""?s?s.p(o,d):(s=Be(o),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),Ye(a,o,d),o[6]?n?(n.p(o,d),d&64&&ue(n,1)):(n=Ce(o),n.c(),ue(n,1),n.m(c.parentNode,c)):n&&(qe(),de(n,1,1,()=>{n=null}),Ue())},i(f){r||(ue(n),r=!0)},o(f){de(n),r=!1},d(f){s&&s.d(f),f&&u(e),f&&u(l),a.block.d(),a.token=null,a=null,f&&u(t),n&&n.d(f),f&&u(c)}}}function yt(o,e,l){let t,c;Pe(o,it,O=>l(11,t=O));const r=ot();Pe(o,r,O=>l(12,c=O));let s,a,n=[],f="",d="",m="",T="",N=!1,y;var z="";let B=!1,P=[];function g(O){l(7,y=O),l(6,N=!0)}Ve(async()=>{if(t==null){me("createorg");return}if((t==null?void 0:t.org)==""){me("createorg");return}if(t.role!="facilitator"){me("/dashboard");return}}),Qe(()=>{s==null||s()});async function w(){const O=await te.collection("organization").getOne(t==null?void 0:t.org,{expand:"members"});l(1,n=[...n,...O.expand.members]),l(0,a=O.name),l(3,d=O.participant_code),l(4,m=O.facilitator_code),l(5,T=O.observer_code),s=await te.collection("organization").subscribe(t==null?void 0:t.org,async function(A){console.log(A.record);const R=await te.collection("organization").getOne(A.record.id,{expand:"members"});l(1,n=R.expand.members)})}async function D(O){l(9,B=!0);try{await te.collection("users").authWithPassword(t.email,z)}catch{alert("Your password was incorrect!"),l(9,B=!1);return}try{await te.collection("users").update(O,{org:""})}catch(R){deleting=!1,console.log(R),alert("Something went wrong, please try again!"),l(9,B=!1);return}const A=n.filter(R=>R.id!==O);console.log(A),te.collection("organization").update(t==null?void 0:t.org,{members:A.map(R=>R.id)}),l(9,B=!1),l(6,N=!1)}async function Q(O,A){const j={role:P[A]};try{const X=await te.collection("users").update(O,j)}catch(X){l(2,f=X);return}const Y=await te.collection("organization").getOne(t==null?void 0:t.org,{expand:"members"});l(1,n=Y.expand.members)}function Z(O){Je.call(this,o,O)}function W(O){P[O]=Ke(this),l(10,P)}function V(){z=this.value,l(8,z)}function L(O){N=O,l(6,N)}return[a,n,f,d,m,T,N,y,z,B,P,t,c,r,g,w,D,Q,Z,W,V,L]}class kt extends Fe{constructor(e){super(),Le(this,e,yt,Et,ze,{})}}function Ot(o){let e,l;return e=new kt({}),{c(){He(e.$$.fragment)},l(t){Ae(e.$$.fragment,t)},m(t,c){Se(e,t,c),l=!0},p:le,i(t){l||(ue(e.$$.fragment,t),l=!0)},o(t){de(e.$$.fragment,t),l=!1},d(t){De(e,t)}}}class Nt extends Fe{constructor(e){super(),Le(this,e,null,Ot,ze,{})}}export{Nt as default};
