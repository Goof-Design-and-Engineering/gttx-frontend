import{S as Bt,i as Nt,s as Ot,D as Pt,e as at,b as k,H as Rt,g as tt,d as rt,h as i,L as pt,o as Lt,R as St,n as T,k as f,a as R,r as M,l as d,m as v,c as A,u as U,p as h,G as u,w as Dt,f as Gt,x as Yt,P as Ft,z as At,A as Mt,q as ot,V as st,B as Ut,M as K,W as nt,v as zt,Q as Wt,C as Ct,N as mt,Y as qt}from"../chunks/index.d8729f0b.js";import{u as jt}from"../chunks/useForm.f7d2ec9d.js";import{v as ct,r as ft}from"../chunks/validators.6e79bf68.js";import{c as Ht,a as Vt,p as x}from"../chunks/pocketbase.f160ef4f.js";import{g as ut}from"../chunks/navigation.d9a36482.js";import{M as Qt}from"../chunks/Modal.0c83b870.js";function Jt(n){return{c:T,l:T,m:T,p:T,i:T,o:T,d:T}}function Kt(n){let e,l,t={ctx:n,current:null,token:null,hasCatch:!1,pending:oe,then:Zt,catch:Xt,value:22,blocks:[,,,]};return Pt(Ht,t),{c(){e=at(),t.block.c()},l(o){e=at(),t.block.l(o)},m(o,r){k(o,e,r),t.block.m(o,t.anchor=r),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,r){n=o,Rt(t,n,r)},i(o){l||(tt(t.block),l=!0)},o(o){for(let r=0;r<3;r+=1){const a=t.blocks[r];rt(a)}l=!1},d(o){o&&i(e),t.block.d(o),t.token=null,t=null}}}function Xt(n){return{c:T,l:T,m:T,p:T,i:T,o:T,d:T}}function Zt(n){let e,l,t=n[7]&&gt(n);return{c(){t&&t.c(),e=at()},l(o){t&&t.l(o),e=at()},m(o,r){t&&t.m(o,r),k(o,e,r),l=!0},p(o,r){o[7]?t?(t.p(o,r),r&128&&tt(t,1)):(t=gt(o),t.c(),tt(t,1),t.m(e.parentNode,e)):t&&(Dt(),rt(t,1,1,()=>{t=null}),Gt())},i(o){l||(tt(t),l=!0)},o(o){rt(t),l=!1},d(o){t&&t.d(o),o&&i(e)}}}function gt(n){let e,l,t,o=n[7].username+"",r,a,s,b,E,y,m,_,w,g,I,O,L,J,B,j,V,Q,C,Y,p,et,S,H,P,z,D,G,lt,q,F,W,X,dt,bt;function It(c){n[20](c)}let ht={$$slots:{default:[le]},$$scope:{ctx:n}};return n[0]!==void 0&&(ht.showModal=n[0]),F=new Qt({props:ht}),Yt.push(()=>Ft(F,"showModal",It)),{c(){e=f("hgroup"),l=f("h1"),t=M("Edit settings for "),r=M(o),a=R(),s=f("h2"),b=M("Express yourself!"),E=R(),y=f("label"),m=M(`Username
				`),_=f("input"),w=M(`

				Email Address
				`),g=f("input"),O=R(),L=f("label"),J=M(`Profile Picture
					`),B=f("input"),j=R(),V=f("br"),Q=R(),C=f("div"),Y=f("button"),p=M("Back to Settings"),et=R(),S=f("button"),H=M("Submit"),z=R(),D=f("center"),G=f("button"),lt=M("Delete Account"),q=R(),At(F.$$.fragment),this.h()},l(c){e=d(c,"HGROUP",{});var N=v(e);l=d(N,"H1",{style:!0});var Z=v(l);t=U(Z,"Edit settings for "),r=U(Z,o),Z.forEach(i),a=A(N),s=d(N,"H2",{});var kt=v(s);b=U(kt,"Express yourself!"),kt.forEach(i),N.forEach(i),E=A(c),y=d(c,"LABEL",{});var $=v(y);m=U($,`Username
				`),_=d($,"INPUT",{type:!0,name:!0,id:!0}),w=U($,`

				Email Address
				`),g=d($,"INPUT",{type:!0,name:!0,id:!0}),O=A($),L=d($,"LABEL",{for:!0});var _t=v(L);J=U(_t,`Profile Picture
					`),B=d(_t,"INPUT",{type:!0,id:!0,name:!0,accept:!0}),_t.forEach(i),$.forEach(i),j=A(c),V=d(c,"BR",{}),Q=A(c),C=d(c,"DIV",{class:!0});var it=v(C);Y=d(it,"BUTTON",{class:!0});var vt=v(Y);p=U(vt,"Back to Settings"),vt.forEach(i),et=A(it),S=d(it,"BUTTON",{});var yt=v(S);H=U(yt,"Submit"),yt.forEach(i),it.forEach(i),z=A(c),D=d(c,"CENTER",{});var Et=v(D);G=d(Et,"BUTTON",{class:!0,"data-target":!0,style:!0,"data-tooltip":!0});var wt=v(G);lt=U(wt,"Delete Account"),wt.forEach(i),Et.forEach(i),q=A(c),Mt(F.$$.fragment,c),this.h()},h(){ot(l,"font-size","40px"),h(_,"type","text"),h(_,"name","new_username"),h(_,"id","new_username"),h(g,"type","text"),h(g,"name","new_emailaddr"),h(g,"id","new_emailaddr"),g.value=I=n[7].email,g.disabled=!0,h(B,"type","file"),h(B,"id","pfp"),h(B,"name","pfp"),h(B,"accept","image/*"),B.disabled=!0,h(L,"for","file"),h(Y,"class","secondary"),S.disabled=P=n[4]==n[3],h(C,"class","grid"),h(G,"class","outline contrast"),h(G,"data-target","modal-example"),ot(G,"width","50%"),h(G,"data-tooltip","This button is dangerous!")},m(c,N){k(c,e,N),u(e,l),u(l,t),u(l,r),u(e,a),u(e,s),u(s,b),k(c,E,N),k(c,y,N),u(y,m),u(y,_),st(_,n[4]),u(y,w),u(y,g),u(y,O),u(y,L),u(L,J),u(L,B),k(c,j,N),k(c,V,N),k(c,Q,N),k(c,C,N),u(C,Y),u(Y,p),u(C,et),u(C,S),u(S,H),k(c,z,N),k(c,D,N),u(D,G),u(G,lt),k(c,q,N),Ut(F,c,N),X=!0,dt||(bt=[K(_,"input",n[16]),nt(ct.call(null,_,[ft])),nt(ct.call(null,g,[ft])),K(B,"change",n[17]),K(Y,"click",n[12]),K(S,"click",n[11]),K(G,"click",n[18])],dt=!0)},p(c,N){(!X||N&128)&&o!==(o=c[7].username+"")&&zt(r,o),N&16&&_.value!==c[4]&&st(_,c[4]),(!X||N&128&&I!==(I=c[7].email)&&g.value!==I)&&(g.value=I),(!X||N&24&&P!==(P=c[4]==c[3]))&&(S.disabled=P);const Z={};N&8389574&&(Z.$$scope={dirty:N,ctx:c}),!W&&N&1&&(W=!0,Z.showModal=c[0],Wt(()=>W=!1)),F.$set(Z)},i(c){X||(tt(F.$$.fragment,c),X=!0)},o(c){rt(F.$$.fragment,c),X=!1},d(c){c&&i(e),c&&i(E),c&&i(y),c&&i(j),c&&i(V),c&&i(Q),c&&i(C),c&&i(z),c&&i(D),c&&i(q),Ct(F,c),dt=!1,mt(bt)}}}function Tt(n){let e,l,t;function o(s,b){return s[7].role!="facilitator"?xt:$t}let r=o(n),a=r(n);return{c(){a.c(),e=R(),l=f("br"),t=f("br")},l(s){a.l(s),e=A(s),l=d(s,"BR",{}),t=d(s,"BR",{})},m(s,b){a.m(s,b),k(s,e,b),k(s,l,b),k(s,t,b)},p(s,b){r===(r=o(s))&&a?a.p(s,b):(a.d(1),a=r(s),a&&(a.c(),a.m(e.parentNode,e)))},d(s){a.d(s),s&&i(e),s&&i(l),s&&i(t)}}}function $t(n){let e,l,t,o;return{c(){e=M('As the facilitator, your organization "'),l=f("b"),t=M(n[1]),o=M(`" will be deleted
									as well!`)},l(r){e=U(r,'As the facilitator, your organization "'),l=d(r,"B",{});var a=v(l);t=U(a,n[1]),a.forEach(i),o=U(r,`" will be deleted
									as well!`)},m(r,a){k(r,e,a),k(r,l,a),u(l,t),k(r,o,a)},p(r,a){a&2&&zt(t,r[1])},d(r){r&&i(e),r&&i(l),r&&i(o)}}}function xt(n){let e;return{c(){e=M("You'll need another invite code to join back into your organization.")},l(l){e=U(l,"You'll need another invite code to join back into your organization.")},m(l,t){k(l,e,t)},p:T,d(l){l&&i(e)}}}function te(n){let e,l,t,o,r,a,s,b,E,y;return{c(){e=f("fieldset"),l=f("label"),t=f("input"),o=M(`
										I will take responsibility for my actions.`),r=R(),a=f("button"),s=M("Confirm"),this.h()},l(m){e=d(m,"FIELDSET",{});var _=v(e);l=d(_,"LABEL",{for:!0,style:!0});var w=v(l);t=d(w,"INPUT",{type:!0,id:!0,name:!0}),o=U(w,`
										I will take responsibility for my actions.`),w.forEach(i),_.forEach(i),r=A(m),a=d(m,"BUTTON",{"aria-busy":!0,"data-target":!0});var g=v(a);s=U(g,"Confirm"),g.forEach(i),this.h()},h(){h(t,"type","checkbox"),h(t,"id","org_confirm"),h(t,"name","terms"),h(l,"for","org_confirm"),ot(l,"text-align","center"),h(a,"aria-busy",n[2]),h(a,"data-target","modal-example"),a.disabled=b=!n[9].valid},m(m,_){k(m,e,_),u(e,l),u(l,t),u(l,o),k(m,r,_),k(m,a,_),u(a,s),E||(y=[nt(ct.call(null,t,[ft])),K(a,"click",n[13])],E=!0)},p(m,_){_&4&&h(a,"aria-busy",m[2]),_&512&&b!==(b=!m[9].valid)&&(a.disabled=b)},d(m){m&&i(e),m&&i(r),m&&i(a),E=!1,mt(y)}}}function ee(n){let e,l,t,o,r;return{c(){e=f("button"),l=M("Confirm"),this.h()},l(a){e=d(a,"BUTTON",{"data-target":!0});var s=v(e);l=U(s,"Confirm"),s.forEach(i),this.h()},h(){h(e,"data-target","modal-example"),e.disabled=t=!n[9].valid},m(a,s){k(a,e,s),u(e,l),o||(r=K(e,"click",n[13]),o=!0)},p(a,s){s&512&&t!==(t=!a[9].valid)&&(e.disabled=t)},d(a){a&&i(e),o=!1,r()}}}function le(n){let e,l,t,o,r,a,s,b,E,y,m,_,w,g,I,O,L,J,B,j,V,Q,C,Y,p=n[8]&&Tt(n);function et(P,z){return P[7].role!="facilitator"?ee:te}let S=et(n),H=S(n);return{c(){e=f("article"),l=f("hgroup"),t=f("h1"),o=M("Woah there!"),r=R(),a=f("h4"),s=M("Are you sure that you want to delete your account?"),b=R(),E=f("h5"),y=f("br"),m=R(),p&&p.c(),_=R(),w=f("input"),g=R(),I=f("footer"),O=f("form"),L=f("br"),J=R(),B=f("input"),j=R(),V=f("br"),Q=R(),H.c(),this.h()},l(P){e=d(P,"ARTICLE",{});var z=v(e);l=d(z,"HGROUP",{});var D=v(l);t=d(D,"H1",{});var G=v(t);o=U(G,"Woah there!"),G.forEach(i),r=A(D),a=d(D,"H4",{});var lt=v(a);s=U(lt,"Are you sure that you want to delete your account?"),lt.forEach(i),b=A(D),E=d(D,"H5",{});var q=v(E);y=d(q,"BR",{}),m=A(q),p&&p.l(q),_=A(q),w=d(q,"INPUT",{style:!0,type:!0}),q.forEach(i),D.forEach(i),g=A(z),I=d(z,"FOOTER",{});var F=v(I);O=d(F,"FORM",{method:!0});var W=v(O);L=d(W,"BR",{}),J=A(W),B=d(W,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),j=A(W),V=d(W,"BR",{}),Q=A(W),H.l(W),W.forEach(i),F.forEach(i),z.forEach(i),this.h()},h(){ot(w,"border","2px solid red"),ot(w,"border-radius","5px"),ot(w,"text-align","center"),h(w,"type","text"),w.value="This action can not be undone!",w.readOnly=!0,h(B,"type","password"),h(B,"name","del_confirm_pass"),h(B,"id","del_confrim_pass"),h(B,"placeholder","Your current password, please!"),h(O,"method","POST")},m(P,z){k(P,e,z),u(e,l),u(l,t),u(t,o),u(l,r),u(l,a),u(a,s),u(l,b),u(l,E),u(E,y),u(E,m),p&&p.m(E,null),u(E,_),u(E,w),u(e,g),u(e,I),u(I,O),u(O,L),u(O,J),u(O,B),st(B,n[6]),u(O,j),u(O,V),u(O,Q),H.m(O,null),C||(Y=[K(B,"input",n[19]),nt(ct.call(null,B,[ft])),nt(n[10].call(null,O)),K(O,"submit",qt(n[15]))],C=!0)},p(P,z){P[8]?p?p.p(P,z):(p=Tt(P),p.c(),p.m(E,_)):p&&(p.d(1),p=null),z&64&&B.value!==P[6]&&st(B,P[6]),S===(S=et(P))&&H?H.p(P,z):(H.d(1),H=S(P),H&&(H.c(),H.m(O,null)))},d(P){P&&i(e),p&&p.d(),H.d(),C=!1,mt(Y)}}}function oe(n){return{c:T,l:T,m:T,p:T,i:T,o:T,d:T}}function ae(n){let e,l,t,o,r,a,s,b,E;return{c(){e=f("center"),l=f("br"),t=R(),o=f("hgroup"),r=f("h1"),a=M("Loading..."),s=R(),b=f("h2"),E=M("Give it a second..."),this.h()},l(y){e=d(y,"CENTER",{});var m=v(e);l=d(m,"BR",{}),t=A(m),o=d(m,"HGROUP",{});var _=v(o);r=d(_,"H1",{"aria-busy":!0});var w=v(r);a=U(w,"Loading..."),w.forEach(i),s=A(_),b=d(_,"H2",{});var g=v(b);E=U(g,"Give it a second..."),g.forEach(i),_.forEach(i),m.forEach(i),this.h()},h(){h(r,"aria-busy","true")},m(y,m){k(y,e,m),u(e,l),u(e,t),u(e,o),u(o,r),u(r,a),u(o,s),u(o,b),u(b,E)},p:T,i:T,o:T,d(y){y&&i(e)}}}function re(n){let e,l,t={ctx:n,current:null,token:null,hasCatch:!1,pending:ae,then:Kt,catch:Jt,blocks:[,,,]};return Pt(n[14](),t),{c(){e=at(),t.block.c()},l(o){e=at(),t.block.l(o)},m(o,r){k(o,e,r),t.block.m(o,t.anchor=r),t.mount=()=>e.parentNode,t.anchor=e,l=!0},p(o,[r]){n=o,Rt(t,n,r)},i(o){l||(tt(t.block),l=!0)},o(o){for(let r=0;r<3;r+=1){const a=t.blocks[r];rt(a)}l=!1},d(o){o&&i(e),t.block.d(o),t.token=null,t=null}}}function ne(n,e,l){let t,o,r;pt(n,Ht,p=>l(7,t=p)),pt(n,Vt,p=>l(8,o=p));let a=!1,s,b=!1;const E=jt();pt(n,E,p=>l(9,r=p));const y=new FormData;var m="",_="",w="",g="";async function I(){try{await x.collection("users").update(t.id,{username:_}),w!=""&&(y.append("documents",w),x.collection("users").update(t.id,y)),ut("/account")}catch(p){console.log(p),alert("Something went wrong, please try again!")}}async function O(){ut("/account")}async function L(){try{l(2,b=!0),await x.collection("users").authWithPassword(t.email,g)}catch{l(2,b=!1),alert("Your password was incorrect!");return}try{(t==null?void 0:t.role)=="facilitator"&&(t!=null&&t.org)?await x.collection("organization").delete(o):await x.collection("users").delete(t.id)}catch(p){l(2,b=!1),console.log(p),alert("Something went wrong, please try again!")}x.authStore.clear(),ut("/")}async function J(){if(o){const p=await x.collection("organization").getOne(t==null?void 0:t.org);l(1,s=p.name)}}Lt(()=>{t?(l(3,m=t.username),l(4,_=t.username)):ut("/login")});function B(p){St.call(this,n,p)}function j(){_=this.value,l(4,_)}function V(){w=this.value,l(5,w)}const Q=()=>l(0,a=!0);function C(){g=this.value,l(6,g)}function Y(p){a=p,l(0,a)}return[a,s,b,m,_,w,g,t,o,r,E,I,O,L,J,B,j,V,Q,C,Y]}class ie extends Bt{constructor(e){super(),Nt(this,e,ne,re,Ot,{})}}function ue(n){let e,l,t,o,r;return l=new ie({}),{c(){e=f("body"),At(l.$$.fragment),t=R(),o=f("pre")},l(a){e=d(a,"BODY",{});var s=v(e);Mt(l.$$.fragment,s),s.forEach(i),t=A(a),o=d(a,"PRE",{}),v(o).forEach(i)},m(a,s){k(a,e,s),Ut(l,e,null),k(a,t,s),k(a,o,s),r=!0},p:T,i(a){r||(tt(l.$$.fragment,a),r=!0)},o(a){rt(l.$$.fragment,a),r=!1},d(a){a&&i(e),Ct(l),a&&i(t),a&&i(o)}}}class me extends Bt{constructor(e){super(),Nt(this,e,null,ue,Ot,{})}}export{me as default};
