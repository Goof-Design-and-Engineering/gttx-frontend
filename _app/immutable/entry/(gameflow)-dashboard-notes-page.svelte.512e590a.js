import{S as x,i as ee,s as j,D as H,a as S,k as g,r as N,e as T,c as P,l as E,m as y,u as O,h as f,b as k,G as b,H as M,n as _,L as F,o as re,O as ce,p as $,V as W,M as X,N as ae,v as A,a1 as se,g as D,d as B,w as ie,f as ue,z as te,A as oe,B as le,C as ne}from"../chunks/index.f25a3516.js";import{c as fe,p as U,b as _e}from"../chunks/pocketbase.4c010b3b.js";import{g as G}from"../chunks/navigation.bb6c43b1.js";import{p as me}from"../chunks/stores.04299866.js";import{N as pe}from"../chunks/NotesFac.ff7a0791.js";function J(n,e,o){const t=n.slice();return t[4]=e[o],t}function be(n){let e,o,t=n[22].message+"",l;return{c(){e=g("p"),o=N("Error: "),l=N(t)},l(r){e=E(r,"P",{});var c=y(e);o=O(c,"Error: "),l=O(c,t),c.forEach(f)},m(r,c){k(r,e,c),b(e,o),b(e,l)},p:_,d(r){r&&f(e)}}}function he(n){let e,o,t,l,r,c,h=n[1],s,i,a,u,m,v,w,q,I,C,R={ctx:n,current:null,token:null,hasCatch:!1,pending:ve,then:ke,catch:de,value:23};H(n[6](),R);let L=Y(n);return{c(){e=g("form"),o=g("h2"),t=N("Request for comment"),l=S(),r=g("p"),R.block.c(),c=S(),L.c(),s=S(),i=g("label"),a=g("textarea"),u=S(),m=g("input"),v=S(),w=g("button"),q=N("Submit"),this.h()},l(p){e=E(p,"FORM",{});var d=y(e);o=E(d,"H2",{});var V=y(o);t=O(V,"Request for comment"),V.forEach(f),l=P(d),r=E(d,"P",{id:!0});var Q=y(r);R.block.l(Q),Q.forEach(f),c=P(d),L.l(d),s=P(d),i=E(d,"LABEL",{for:!0});var z=y(i);a=E(z,"TEXTAREA",{name:!0,id:!0,cols:!0,rows:!0}),y(a).forEach(f),z.forEach(f),u=P(d),m=E(d,"INPUT",{type:!0,id:!0,name:!0}),v=P(d),w=E(d,"BUTTON",{type:!0,id:!0});var K=y(w);q=O(K,"Submit"),K.forEach(f),d.forEach(f),this.h()},h(){$(r,"id","curr_question"),$(a,"name","notes"),$(a,"id","notes"),$(a,"cols","50"),$(a,"rows","4"),$(i,"for","notes"),$(m,"type","hidden"),$(m,"id","roomid"),$(m,"name","roomid"),m.value=n[0],$(w,"type","submit"),$(w,"id","submit_answer")},m(p,d){k(p,e,d),b(e,o),b(o,t),b(e,l),b(e,r),R.block.m(r,R.anchor=null),R.mount=()=>r,R.anchor=null,b(e,c),L.m(e,null),b(e,s),b(e,i),b(i,a),W(a,n[4]),b(e,u),b(e,m),b(e,v),b(e,w),b(w,q),I||(C=[X(a,"input",n[8]),X(w,"click",n[7])],I=!0)},p(p,d){n=p,M(R,n,d),d&2&&j(h,h=n[1])?(L.d(1),L=Y(n),L.c(),L.m(e,s)):L.p(n,d),d&16&&W(a,n[4]),d&1&&(m.value=n[0])},d(p){p&&f(e),R.block.d(),R.token=null,R=null,L.d(p),I=!1,ae(C)}}}function de(n){return{c:_,l:_,m:_,p:_,d:_}}function ke(n){let e;function o(r,c){return r[2]!=""?Ee:ge}let t=o(n),l=t(n);return{c(){l.c(),e=T()},l(r){l.l(r),e=T()},m(r,c){l.m(r,c),k(r,e,c)},p(r,c){t===(t=o(r))&&l?l.p(r,c):(l.d(1),l=t(r),l&&(l.c(),l.m(e.parentNode,e)))},d(r){l.d(r),r&&f(e)}}}function ge(n){let e=n[23]+"",o;return{c(){o=N(e)},l(t){o=O(t,e)},m(t,l){k(t,o,l)},p:_,d(t){t&&f(o)}}}function Ee(n){let e;return{c(){e=N(n[2])},l(o){e=O(o,n[2])},m(o,t){k(o,e,t)},p(o,t){t&4&&A(e,o[2])},d(o){o&&f(e)}}}function ve(n){return{c:_,l:_,m:_,p:_,d:_}}function Y(n){let e;return{c(){e=N(n[1])},l(o){e=O(o,n[1])},m(o,t){k(o,e,t)},p(o,t){t&2&&A(e,o[1])},d(o){o&&f(e)}}}function ye(n){let e,o;return{c(){e=g("p"),o=N("Loading...")},l(t){e=E(t,"P",{});var l=y(e);o=O(l,"Loading..."),l.forEach(f)},m(t,l){k(t,e,l),b(e,o)},p:_,d(t){t&&f(e)}}}function we(n){let e=n[22]+"",o;return{c(){o=N(e)},l(t){o=O(t,e)},m(t,l){k(t,o,l)},p(t,l){l&8&&e!==(e=t[22]+"")&&A(o,e)},d(t){t&&f(o)}}}function Re(n){let e,o=n[19],t=[];for(let l=0;l<o.length;l+=1)t[l]=Z(J(n,o,l));return{c(){e=g("li");for(let l=0;l<t.length;l+=1)t[l].c()},l(l){e=E(l,"LI",{});var r=y(e);for(let c=0;c<t.length;c+=1)t[c].l(r);r.forEach(f)},m(l,r){k(l,e,r);for(let c=0;c<t.length;c+=1)t[c].m(e,null)},p(l,r){if(r&8){o=l[19];let c;for(c=0;c<o.length;c+=1){const h=J(l,o,c);t[c]?t[c].p(h,r):(t[c]=Z(h),t[c].c(),t[c].m(e,null))}for(;c<t.length;c+=1)t[c].d(1);t.length=o.length}},d(l){l&&f(e),se(t,l)}}}function Z(n){let e,o=n[4].question+"",t,l,r,c=n[4].content+"",h,s;return{c(){e=g("h3"),t=N(o),l=S(),r=g("p"),h=N(c),s=S()},l(i){e=E(i,"H3",{});var a=y(e);t=O(a,o),a.forEach(f),l=P(i),r=E(i,"P",{});var u=y(r);h=O(u,c),s=P(u),u.forEach(f)},m(i,a){k(i,e,a),b(e,t),k(i,l,a),k(i,r,a),b(r,h),b(r,s)},p(i,a){a&8&&o!==(o=i[4].question+"")&&A(t,o),a&8&&c!==(c=i[4].content+"")&&A(h,c)},d(i){i&&f(e),i&&f(l),i&&f(r)}}}function Ne(n){return{c:_,l:_,m:_,p:_,d:_}}function Oe(n){let e,o,t,l,r,c,h,s,i={ctx:n,current:null,token:null,hasCatch:!0,pending:ye,then:he,catch:be,error:22};H(n[5](),i);let a={ctx:n,current:null,token:null,hasCatch:!0,pending:Ne,then:Re,catch:we,value:19,error:22};return H(s=n[3],a),{c(){i.block.c(),e=S(),o=g("hr"),t=S(),l=g("h2"),r=N("PREVIOUS NOTES"),c=S(),h=T(),a.block.c()},l(u){i.block.l(u),e=P(u),o=E(u,"HR",{}),t=P(u),l=E(u,"H2",{});var m=y(l);r=O(m,"PREVIOUS NOTES"),m.forEach(f),c=P(u),h=T(),a.block.l(u)},m(u,m){i.block.m(u,i.anchor=m),i.mount=()=>e.parentNode,i.anchor=e,k(u,e,m),k(u,o,m),k(u,t,m),k(u,l,m),b(l,r),k(u,c,m),k(u,h,m),a.block.m(u,a.anchor=m),a.mount=()=>h.parentNode,a.anchor=h},p(u,[m]){n=u,M(i,n,m),a.ctx=n,m&8&&s!==(s=n[3])&&H(s,a)||M(a,n,m)},i:_,o:_,d(u){i.block.d(u),i.token=null,i=null,u&&f(e),u&&f(o),u&&f(t),u&&f(l),u&&f(c),u&&f(h),a.block.d(u),a.token=null,a=null}}}function Se(n,e,o){let t,l;F(n,fe,p=>o(12,t=p)),F(n,me,p=>o(13,l=p));let r="",c;const h=l.url;let{roomID:s=h.searchParams.get("roomid")||"FAILURE"}=e,i="",a,u,m="",v=[];function w(){G("/dashboard")}re(async()=>{a=await U.collection("room").subscribe(s,async function(p){o(2,m=await I())}),u=await U.collection("notes").subscribe("*",async function(p){o(3,v=await R())}),o(3,v=await R()),t||G("/login"),t.org||G("/createorg")}),ce(async()=>{a==null||a(),u==null||u()});async function q(){s==""&&w();try{const p=await U.collection("room").getOne(s,{expand:"scenarios"},{$cancelKey:"scenario"})}catch(p){alert(p),G("/dashboard")}c=result.expand.scenarios.contents}async function I(){c==null&&q();const p=await U.collection("room").getOne(s);return c.modules[p.module].questions[p.question]}async function C(){const p=await U.collection("room").getOne(s);console.log(t.id),console.log(t.org);const d={user:t.id,org:t.org,question:c.modules[p.module].questions[p.question],content:r,room:s};await U.collection("notes").create(d)!=Object?o(1,i="PREVIOUS MESSAGE WAS SENT PROPER"):console.log(p)}async function R(){let p=`(org='${t.org}' && user='${t.id}')`;return console.log(p),(await U.collection("notes").getList(1,50,{filter:p})).items}function L(){r=this.value,o(4,r)}return n.$$set=p=>{"roomID"in p&&o(0,s=p.roomID)},[s,i,m,v,r,q,I,C,L]}class Pe extends x{constructor(e){super(),ee(this,e,Se,Oe,j,{roomID:0})}}function $e(n){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function Le(n){let e,o,t,l;const r=[Te,Ie,qe],c=[];function h(s,i){return s[1]=="facilitator"?0:s[1]=="participant"||s[1]=="observer"?1:2}return e=h(n),o=c[e]=r[e](n),{c(){o.c(),t=T()},l(s){o.l(s),t=T()},m(s,i){c[e].m(s,i),k(s,t,i),l=!0},p(s,i){let a=e;e=h(s),e!==a&&(ie(),B(c[a],1,1,()=>{c[a]=null}),ue(),o=c[e],o||(o=c[e]=r[e](s),o.c()),D(o,1),o.m(t.parentNode,t))},i(s){l||(D(o),l=!0)},o(s){B(o),l=!1},d(s){c[e].d(s),s&&f(t)}}}function qe(n){let e,o,t,l,r,c,h,s,i,a,u;return{c(){e=g("center"),o=g("br"),t=S(),l=g("hgroup"),r=g("h1"),c=N("Loading..."),h=S(),s=g("h2"),i=N("Give it a second..."),a=S(),u=g("br"),this.h()},l(m){e=E(m,"CENTER",{});var v=y(e);o=E(v,"BR",{}),t=P(v),l=E(v,"HGROUP",{});var w=y(l);r=E(w,"H1",{"aria-busy":!0});var q=y(r);c=O(q,"Loading..."),q.forEach(f),h=P(w),s=E(w,"H2",{});var I=y(s);i=O(I,"Give it a second..."),I.forEach(f),w.forEach(f),a=P(v),u=E(v,"BR",{}),v.forEach(f),this.h()},h(){$(r,"aria-busy","true")},m(m,v){k(m,e,v),b(e,o),b(e,t),b(e,l),b(l,r),b(r,c),b(l,h),b(l,s),b(s,i),b(e,a),b(e,u)},i:_,o:_,d(m){m&&f(e)}}}function Ie(n){let e,o;return e=new Pe({}),{c(){te(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,l){le(e,t,l),o=!0},i(t){o||(D(e.$$.fragment,t),o=!0)},o(t){B(e.$$.fragment,t),o=!1},d(t){ne(e,t)}}}function Te(n){let e,o;return e=new pe({}),{c(){te(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,l){le(e,t,l),o=!0},i(t){o||(D(e.$$.fragment,t),o=!0)},o(t){B(e.$$.fragment,t),o=!1},d(t){ne(e,t)}}}function Ue(n){return{c:_,l:_,m:_,p:_,i:_,o:_,d:_}}function He(n){let e,o,t,l={ctx:n,current:null,token:null,hasCatch:!1,pending:Ue,then:Le,catch:$e,value:1,blocks:[,,,]};return H(o=n[0],l),{c(){e=T(),l.block.c()},l(r){e=T(),l.block.l(r)},m(r,c){k(r,e,c),l.block.m(r,l.anchor=c),l.mount=()=>e.parentNode,l.anchor=e,t=!0},p(r,[c]){n=r,l.ctx=n,c&1&&o!==(o=n[0])&&H(o,l)||M(l,n,c)},i(r){t||(D(l.block),t=!0)},o(r){for(let c=0;c<3;c+=1){const h=l.blocks[c];B(h)}t=!1},d(r){r&&f(e),l.block.d(r),l.token=null,l=null}}}function Ae(n,e,o){let t;return F(n,_e,l=>o(0,t=l)),[t]}class Ve extends x{constructor(e){super(),ee(this,e,Ae,He,j,{})}}export{Ve as default};
