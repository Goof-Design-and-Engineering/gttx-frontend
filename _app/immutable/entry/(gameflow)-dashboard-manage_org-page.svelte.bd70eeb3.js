import{S as ke,i as ye,s as Te,D as Ie,a as R,k as p,e as pe,c as N,l as d,m,h as f,b as k,H as Be,g as ne,w as Me,d as ue,f as Ce,L as de,o as Fe,O as He,r as b,u as v,v as j,x as Se,P as ze,z as ge,A as Pe,B as we,Q as Ae,C as Re,R as Le,n as J,p as D,G as n,T as De,U as Ge,q as Ue,V as he,M as se,W as me,X as Ne,Y as We,N as Ye}from"../chunks/index.d8729f0b.js";import{u as qe,v as Ve,r as Qe}from"../chunks/validators.90f3610d.js";import{c as Xe,p as ae}from"../chunks/pocketbase.f160ef4f.js";import{g as ce}from"../chunks/navigation.52b67caf.js";import{M as je}from"../chunks/Modal.0c83b870.js";function be(s,e,l){const t=s.slice();return t[20]=e[l],t[22]=l,t}function ve(s){let e;return{c(){e=b(s[2])},l(l){e=v(l,s[2])},m(l,t){k(l,e,t)},p(l,t){t&4&&j(e,l[2])},d(l){l&&f(e)}}}function Je(s){return{c:J,l:J,m:J,p:J,d:J}}function Ke(s){let e,l,t,_=(s[0]||"Organization Name")+"",a,r,o,i,c,u,E,I,M,T,S,z,B,O,P,G,Y,g,W,C,F,U=[],ee=new Map,H,q,K,Z,A,$,X=s[1];const te=h=>h[20].id;for(let h=0;h<X.length;h+=1){let y=be(s,X,h),w=te(y);ee.set(w,U[h]=Ee(w,y))}return{c(){e=p("header"),l=p("hgroup"),t=p("h1"),a=b(_),r=R(),o=p("h2"),i=b("Time for a change?"),c=R(),u=p("details"),E=p("summary"),I=b("Invite Codes"),M=R(),T=p("p"),S=b("Participant: "),z=b(s[3]),B=R(),O=p("p"),P=b("Observer: "),G=b(s[5]),Y=R(),g=p("p"),W=b("Facilitator: "),C=b(s[4]),F=R();for(let h=0;h<U.length;h+=1)U[h].c();H=R(),q=p("footer"),K=p("br"),Z=R(),A=p("button"),$=b("Save Changes"),this.h()},l(h){e=d(h,"HEADER",{});var y=m(e);l=d(y,"HGROUP",{});var w=m(l);t=d(w,"H1",{});var re=m(t);a=v(re,_),re.forEach(f),r=N(w),o=d(w,"H2",{});var L=m(o);i=v(L,"Time for a change?"),L.forEach(f),w.forEach(f),y.forEach(f),c=N(h),u=d(h,"DETAILS",{});var Q=m(u);E=d(Q,"SUMMARY",{});var ie=m(E);I=v(ie,"Invite Codes"),ie.forEach(f),M=N(Q),T=d(Q,"P",{id:!0});var le=m(T);S=v(le,"Participant: "),z=v(le,s[3]),le.forEach(f),B=N(Q),O=d(Q,"P",{id:!0});var oe=m(O);P=v(oe,"Observer: "),G=v(oe,s[5]),oe.forEach(f),Y=N(Q),g=d(Q,"P",{id:!0});var V=m(g);W=v(V,"Facilitator: "),C=v(V,s[4]),V.forEach(f),Q.forEach(f),F=N(h);for(let fe=0;fe<U.length;fe+=1)U[fe].l(h);H=N(h),q=d(h,"FOOTER",{});var x=m(q);K=d(x,"BR",{}),Z=N(x),A=d(x,"BUTTON",{class:!0});var _e=m(A);$=v(_e,"Save Changes"),_e.forEach(f),x.forEach(f),this.h()},h(){D(T,"id","p_code"),D(O,"id","o_code"),D(g,"id","f_code"),u.open=!0,D(A,"class","outline")},m(h,y){k(h,e,y),n(e,l),n(l,t),n(t,a),n(l,r),n(l,o),n(o,i),k(h,c,y),k(h,u,y),n(u,E),n(E,I),n(u,M),n(u,T),n(T,S),n(T,z),n(u,B),n(u,O),n(O,P),n(O,G),n(u,Y),n(u,g),n(g,W),n(g,C),k(h,F,y);for(let w=0;w<U.length;w+=1)U[w].m(h,y);k(h,H,y),k(h,q,y),n(q,K),n(q,Z),n(q,A),n(A,$)},p(h,y){y&1&&_!==(_=(h[0]||"Organization Name")+"")&&j(a,_),y&8&&j(z,h[3]),y&32&&j(G,h[5]),y&16&&j(C,h[4]),y&4610&&(X=h[1],U=De(U,y,te,1,h,X,ee,H.parentNode,Ge,Ee,H,be))},d(h){h&&f(e),h&&f(c),h&&f(u),h&&f(F);for(let y=0;y<U.length;y+=1)U[y].d(h);h&&f(H),h&&f(q)}}}function Ze(s){let e=s[20].username+"",l;return{c(){l=b(e)},l(t){l=v(t,e)},m(t,_){k(t,l,_)},p(t,_){_&2&&e!==(e=t[20].username+"")&&j(l,e)},d(t){t&&f(l)}}}function $e(s){let e,l=s[20].username+"",t,_;return{c(){e=p("b"),t=b(l),_=b(" (that's you!)")},l(a){e=d(a,"B",{});var r=m(e);t=v(r,l),_=v(r," (that's you!)"),r.forEach(f)},m(a,r){k(a,e,r),n(e,t),n(e,_)},p(a,r){r&2&&l!==(l=a[20].username+"")&&j(t,l)},d(a){a&&f(e)}}}function xe(s){let e,l,t,_,a,r;function o(u,E){return u[20].role=="facilitator"?ot:u[20].role=="participant"?lt:tt}let i=o(s),c=i(s);return{c(){e=p("select"),c.c(),l=R(),t=p("button"),_=b("Remove"),this.h()},l(u){e=d(u,"SELECT",{});var E=m(e);c.l(E),E.forEach(f),l=N(u),t=d(u,"BUTTON",{class:!0});var I=m(t);_=v(I,"Remove"),I.forEach(f),this.h()},h(){D(t,"class","primary")},m(u,E){k(u,e,E),c.m(e,null),k(u,l,E),k(u,t,E),n(t,_),a||(r=se(t,"click",function(){Ne(s[12](s[20]))&&s[12](s[20]).apply(this,arguments)}),a=!0)},p(u,E){s=u,i!==(i=o(s))&&(c.d(1),c=i(s),c&&(c.c(),c.m(e,null)))},d(u){u&&f(e),c.d(),u&&f(l),u&&f(t),a=!1,r()}}}function et(s){let e,l,t,_,a,r;return{c(){e=p("select"),l=p("option"),t=b("Facilitator"),_=R(),a=p("button"),r=b("Remove"),this.h()},l(o){e=d(o,"SELECT",{});var i=m(e);l=d(i,"OPTION",{});var c=m(l);t=v(c,"Facilitator"),c.forEach(f),i.forEach(f),_=N(o),a=d(o,"BUTTON",{class:!0});var u=m(a);r=v(u,"Remove"),u.forEach(f),this.h()},h(){l.__value="facilitator",l.value=l.__value,e.disabled=!0,D(a,"class","primary"),a.disabled="true"},m(o,i){k(o,e,i),n(e,l),n(l,t),k(o,_,i),k(o,a,i),n(a,r)},p:J,d(o){o&&f(e),o&&f(_),o&&f(a)}}}function tt(s){let e,l,t,_,a,r;return{c(){e=p("option"),l=b("Facilitator"),t=p("option"),_=b("Participant"),a=p("option"),r=b("Observer"),this.h()},l(o){e=d(o,"OPTION",{});var i=m(e);l=v(i,"Facilitator"),i.forEach(f),t=d(o,"OPTION",{});var c=m(t);_=v(c,"Participant"),c.forEach(f),a=d(o,"OPTION",{});var u=m(a);r=v(u,"Observer"),u.forEach(f),this.h()},h(){e.__value="facilitator",e.value=e.__value,t.__value="participant",t.value=t.__value,a.__value="observer",a.value=a.__value,a.selected=!0},m(o,i){k(o,e,i),n(e,l),k(o,t,i),n(t,_),k(o,a,i),n(a,r)},d(o){o&&f(e),o&&f(t),o&&f(a)}}}function lt(s){let e,l,t,_,a,r;return{c(){e=p("option"),l=b("Facilitator"),t=p("option"),_=b("Participant"),a=p("option"),r=b("Observer"),this.h()},l(o){e=d(o,"OPTION",{});var i=m(e);l=v(i,"Facilitator"),i.forEach(f),t=d(o,"OPTION",{});var c=m(t);_=v(c,"Participant"),c.forEach(f),a=d(o,"OPTION",{});var u=m(a);r=v(u,"Observer"),u.forEach(f),this.h()},h(){e.__value="facilitator",e.value=e.__value,t.__value="participant",t.value=t.__value,t.selected=!0,a.__value="observer",a.value=a.__value},m(o,i){k(o,e,i),n(e,l),k(o,t,i),n(t,_),k(o,a,i),n(a,r)},d(o){o&&f(e),o&&f(t),o&&f(a)}}}function ot(s){let e,l,t,_,a,r;return{c(){e=p("option"),l=b("Facilitator"),t=p("option"),_=b("Participant"),a=p("option"),r=b("Observer"),this.h()},l(o){e=d(o,"OPTION",{});var i=m(e);l=v(i,"Facilitator"),i.forEach(f),t=d(o,"OPTION",{});var c=m(t);_=v(c,"Participant"),c.forEach(f),a=d(o,"OPTION",{});var u=m(a);r=v(u,"Observer"),u.forEach(f),this.h()},h(){e.__value="facilitator",e.value=e.__value,e.selected=!0,t.__value="participant",t.value=t.__value,a.__value="observer",a.value=a.__value},m(o,i){k(o,e,i),n(e,l),k(o,t,i),n(t,_),k(o,a,i),n(a,r)},d(o){o&&f(e),o&&f(t),o&&f(a)}}}function Ee(s,e){let l,t,_,a,r,o,i,c,u,E;function I(O,P){return O[20].id==O[9].id?$e:Ze}let M=I(e),T=M(e);function S(O,P){return O[20].id==O[9].id?et:xe}let z=S(e),B=z(e);return{key:s,first:null,c(){l=p("div"),T.c(),t=R(),_=p("hr"),a=R(),r=p("div"),o=p("input"),c=R(),B.c(),u=R(),E=p("br"),this.h()},l(O){l=d(O,"DIV",{});var P=m(l);T.l(P),t=N(P),_=d(P,"HR",{}),a=N(P),r=d(P,"DIV",{class:!0});var G=m(r);o=d(G,"INPUT",{type:!0,"aria-invalid":!0}),c=N(G),B.l(G),G.forEach(f),P.forEach(f),u=N(O),E=d(O,"BR",{}),this.h()},h(){D(o,"type","text"),o.value=i=e[20].email,D(o,"aria-invalid","false"),o.disabled=!0,D(r,"class","grid"),this.first=l},m(O,P){k(O,l,P),T.m(l,null),n(l,t),n(l,_),n(l,a),n(l,r),n(r,o),n(r,c),B.m(r,null),k(O,u,P),k(O,E,P)},p(O,P){e=O,M===(M=I(e))&&T?T.p(e,P):(T.d(1),T=M(e),T&&(T.c(),T.m(l,t))),P&2&&i!==(i=e[20].email)&&o.value!==i&&(o.value=i),z===(z=S(e))&&B?B.p(e,P):(B.d(1),B=z(e),B&&(B.c(),B.m(r,null)))},d(O){O&&f(l),T.d(),B.d(),O&&f(u),O&&f(E)}}}function at(s){let e,l,t,_,a,r,o,i,c;return{c(){e=p("center"),l=p("br"),t=R(),_=p("hgroup"),a=p("h1"),r=b("Loading..."),o=R(),i=p("h2"),c=b("Give it a second..."),this.h()},l(u){e=d(u,"CENTER",{});var E=m(e);l=d(E,"BR",{}),t=N(E),_=d(E,"HGROUP",{});var I=m(_);a=d(I,"H1",{"aria-busy":!0});var M=m(a);r=v(M,"Loading..."),M.forEach(f),o=N(I),i=d(I,"H2",{});var T=m(i);c=v(T,"Give it a second..."),T.forEach(f),I.forEach(f),E.forEach(f),this.h()},h(){D(a,"aria-busy","true")},m(u,E){k(u,e,E),n(e,l),n(e,t),n(e,_),n(_,a),n(a,r),n(_,o),n(_,i),n(i,c)},p:J,d(u){u&&f(e)}}}function Oe(s){let e,l,t;function _(r){s[17](r)}let a={$$slots:{default:[rt]},$$scope:{ctx:s}};return s[6]!==void 0&&(a.showModal=s[6]),e=new je({props:a}),Se.push(()=>ze(e,"showModal",_)),{c(){ge(e.$$.fragment)},l(r){Pe(e.$$.fragment,r)},m(r,o){we(e,r,o),t=!0},p(r,o){const i={};o&8390016&&(i.$$scope={dirty:o,ctx:r}),!l&&o&64&&(l=!0,i.showModal=r[6],Ae(()=>l=!1)),e.$set(i)},i(r){t||(ne(e.$$.fragment,r),t=!0)},o(r){ue(e.$$.fragment,r),t=!1},d(r){Re(e,r)}}}function rt(s){let e,l,t,_,a,r,o,i=s[7].username+"",c,u,E,I,M,T,S=s[7].username+"",z,B,O,P,G,Y,g,W,C,F,U,ee,H,q,K,Z,A,$,X,te,h;return{c(){e=p("article"),l=p("h3"),t=b("Woah there!"),_=R(),a=p("p"),r=b("Are you sure that you want to remove "),o=p("b"),c=b(i),u=b(` from your
				organization?
				`),E=p("br"),I=p("br"),M=b(`
				If you change your mind, you'll have to send `),T=p("b"),z=b(S),B=b(` another
				invite.
				`),O=p("br"),P=p("br"),G=R(),Y=p("b"),g=b("This action can not be undone!"),W=R(),C=p("footer"),F=p("form"),U=p("br"),ee=R(),H=p("input"),q=R(),K=p("br"),Z=R(),A=p("button"),$=b("Confirm"),this.h()},l(y){e=d(y,"ARTICLE",{});var w=m(e);l=d(w,"H3",{});var re=m(l);t=v(re,"Woah there!"),re.forEach(f),_=N(w),a=d(w,"P",{});var L=m(a);r=v(L,"Are you sure that you want to remove "),o=d(L,"B",{});var Q=m(o);c=v(Q,i),Q.forEach(f),u=v(L,` from your
				organization?
				`),E=d(L,"BR",{}),I=d(L,"BR",{}),M=v(L,`
				If you change your mind, you'll have to send `),T=d(L,"B",{});var ie=m(T);z=v(ie,S),ie.forEach(f),B=v(L,` another
				invite.
				`),O=d(L,"BR",{}),P=d(L,"BR",{}),G=N(L),Y=d(L,"B",{style:!0});var le=m(Y);g=v(le,"This action can not be undone!"),le.forEach(f),L.forEach(f),W=N(w),C=d(w,"FOOTER",{});var oe=m(C);F=d(oe,"FORM",{method:!0});var V=m(F);U=d(V,"BR",{}),ee=N(V),H=d(V,"INPUT",{type:!0,name:!0,id:!0,placeholder:!0}),q=N(V),K=d(V,"BR",{}),Z=N(V),A=d(V,"BUTTON",{"data-target":!0});var x=m(A);$=v(x,"Confirm"),x.forEach(f),V.forEach(f),oe.forEach(f),w.forEach(f),this.h()},h(){Ue(Y,"color","red"),D(H,"type","password"),D(H,"name","del_confirm_pass"),D(H,"id","del_confrim_pass"),D(H,"placeholder","Your current password, please!"),D(A,"data-target","modal-example"),A.disabled=X=!s[10].valid,D(F,"method","POST")},m(y,w){k(y,e,w),n(e,l),n(l,t),n(e,_),n(e,a),n(a,r),n(a,o),n(o,c),n(a,u),n(a,E),n(a,I),n(a,M),n(a,T),n(T,z),n(a,B),n(a,O),n(a,P),n(a,G),n(a,Y),n(Y,g),n(e,W),n(e,C),n(C,F),n(F,U),n(F,ee),n(F,H),he(H,s[8]),n(F,q),n(F,K),n(F,Z),n(F,A),n(A,$),te||(h=[se(H,"input",s[16]),me(Ve.call(null,H,[Qe])),se(A,"click",function(){Ne(s[14](s[7].id))&&s[14](s[7].id).apply(this,arguments)}),me(s[11].call(null,F)),se(F,"submit",We(s[15]))],te=!0)},p(y,w){s=y,w&128&&i!==(i=s[7].username+"")&&j(c,i),w&128&&S!==(S=s[7].username+"")&&j(z,S),w&256&&H.value!==s[8]&&he(H,s[8]),w&1024&&X!==(X=!s[10].valid)&&(A.disabled=X)},d(y){y&&f(e),te=!1,Ye(h)}}}function it(s){let e,l,t,_,a,r=s[2]!=""&&ve(s),o={ctx:s,current:null,token:null,hasCatch:!1,pending:at,then:Ke,catch:Je};Ie(s[13](),o);let i=s[6]&&Oe(s);return{c(){r&&r.c(),e=R(),l=p("article"),o.block.c(),t=R(),i&&i.c(),_=pe()},l(c){r&&r.l(c),e=N(c),l=d(c,"ARTICLE",{});var u=m(l);o.block.l(u),u.forEach(f),t=N(c),i&&i.l(c),_=pe()},m(c,u){r&&r.m(c,u),k(c,e,u),k(c,l,u),o.block.m(l,o.anchor=null),o.mount=()=>l,o.anchor=null,k(c,t,u),i&&i.m(c,u),k(c,_,u),a=!0},p(c,[u]){s=c,s[2]!=""?r?r.p(s,u):(r=ve(s),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),Be(o,s,u),s[6]?i?(i.p(s,u),u&64&&ne(i,1)):(i=Oe(s),i.c(),ne(i,1),i.m(_.parentNode,_)):i&&(Me(),ue(i,1,1,()=>{i=null}),Ce())},i(c){a||(ne(i),a=!0)},o(c){ue(i),a=!1},d(c){r&&r.d(c),c&&f(e),c&&f(l),o.block.d(),o.token=null,o=null,c&&f(t),i&&i.d(c),c&&f(_)}}}function nt(s,e,l){let t,_;de(s,Xe,g=>l(9,t=g));const a=qe();de(s,a,g=>l(10,_=g));let r,o,i=[],c="",u="",E="",I="",M=!1,T;var S="";function z(g){l(7,T=g),l(6,M=!0)}Fe(async()=>{if(t==null){ce("createorg");return}if((t==null?void 0:t.org)==""){ce("createorg");return}if(t.role!="facilitator"){ce("/dashboard");return}}),He(()=>{r==null||r()});async function B(){const g=await ae.collection("organization").getOne(t==null?void 0:t.org,{expand:"members"});l(1,i=[...i,...g.expand.members]),l(0,o=g.name),l(3,u=g.participant_code),l(4,E=g.facilitator_code),l(5,I=g.observer_code),r=await ae.collection("organization").subscribe(t==null?void 0:t.org,async function(W){console.log(W.record);const C=await ae.collection("organization").getOne(W.record.id,{expand:"members"});l(1,i=C.expand.members)})}async function O(g){try{await ae.collection("users").authWithPassword(t.email,S)}catch{alert("Your password was incorrect!");return}try{await ae.collection("users").update(g,{org:""})}catch(C){deleting=!1,console.log(C),alert("Something went wrong, please try again!");return}const W=i.filter(C=>C.id!==g);console.log(W),ae.collection("organization").update(t==null?void 0:t.org,{members:W.map(C=>C.id)})}function P(g){Le.call(this,s,g)}function G(){S=this.value,l(8,S)}function Y(g){M=g,l(6,M)}return[o,i,c,u,E,I,M,T,S,t,_,a,z,B,O,P,G,Y]}class st extends ke{constructor(e){super(),ye(this,e,nt,it,Te,{})}}function ut(s){let e,l;return e=new st({}),{c(){ge(e.$$.fragment)},l(t){Pe(e.$$.fragment,t)},m(t,_){we(e,t,_),l=!0},p:J,i(t){l||(ne(e.$$.fragment,t),l=!0)},o(t){ue(e.$$.fragment,t),l=!1},d(t){Re(e,t)}}}class ht extends ke{constructor(e){super(),ye(this,e,null,ut,Te,{})}}export{ht as default};
