var re=Object.defineProperty;var le=(t,e,o)=>e in t?re(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var v=(t,e,o)=>(le(t,typeof e!="symbol"?e+"":e,o),o);import{S as G,i as P,s as Q,e as F,b as O,f as g,g as J,t as k,d as K,h as N,P as j,H as ae,C as X,k as fe,l as ue,m as ce,n as I,D as Y,E as x,F as $,Q as ee,A as he,R as me}from"./index-3ad34ed6.js";import{w as de}from"./index-cdb9dc61.js";const ve=t=>({value:t&16}),B=t=>({value:t[4]});function U(t){let e,o,n=(t[7]||t[3])&&t[4]&&z(t);return{c(){n&&n.c(),e=F()},l(i){n&&n.l(i),e=F()},m(i,r){n&&n.m(i,r),O(i,e,r),o=!0},p(i,r){(i[7]||i[3])&&i[4]?n?(n.p(i,r),r&152&&g(n,1)):(n=z(i),n.c(),g(n,1),n.m(e.parentNode,e)):n&&(J(),k(n,1,1,()=>{n=null}),K())},i(i){o||(g(n),o=!0)},o(i){k(n),o=!1},d(i){n&&n.d(i),i&&N(e)}}}function z(t){let e,o,n;const i=t[16].default,r=X(i,t,t[15],B);return{c(){e=fe("div"),r&&r.c(),this.h()},l(f){e=ue(f,"DIV",{id:!0,class:!0});var u=ce(e);r&&r.l(u),u.forEach(N),this.h()},h(){I(e,"id",t[1]),I(e,"class",o="svelte-use-form-hint "+t[0])},m(f,u){O(f,e,u),r&&r.m(e,null),n=!0},p(f,u){r&&r.p&&(!n||u&32784)&&Y(r,i,f,f[15],n?$(i,f[15],u,ve):x(f[15]),B),(!n||u&2)&&I(e,"id",f[1]),(!n||u&1&&o!==(o="svelte-use-form-hint "+f[0]))&&I(e,"class",o)},i(f){n||(g(r,f),n=!0)},o(f){k(r,f),n=!1},d(f){f&&N(e),r&&r.d(f)}}}function _e(t){let e,o,n=!(t[2]&&t[5])&&!t[6]&&U(t);return{c(){n&&n.c(),e=F()},l(i){n&&n.l(i),e=F()},m(i,r){n&&n.m(i,r),O(i,e,r),o=!0},p(i,[r]){!(i[2]&&i[5])&&!i[6]?n?(n.p(i,r),r&100&&g(n,1)):(n=U(i),n.c(),g(n,1),n.m(e.parentNode,e)):n&&(J(),k(n,1,1,()=>{n=null}),K())},i(i){o||(g(n),o=!0)},o(i){k(n),o=!1},d(i){n&&n.d(i),i&&N(e)}}}function Ee(t,e,o){let n,i,r,f,u,y,{$$slots:M={},$$scope:T}=e,{for:b=""}=e,{form:m="svelte-use-form"}=e,{class:A=""}=e,{id:p=void 0}=e,{on:L=""}=e,{hideWhen:_=""}=e,{hideWhenRequired:H=!1}=e,{showWhenUntouched:w=!1}=e;b||(b=j(`${m}_hint-group-name`));const d=j(m);return ae(t,d,h=>o(14,y=h)),t.$$set=h=>{"for"in h&&o(9,b=h.for),"form"in h&&o(10,m=h.form),"class"in h&&o(0,A=h.class),"id"in h&&o(1,p=h.id),"on"in h&&o(11,L=h.on),"hideWhen"in h&&o(12,_=h.hideWhen),"hideWhenRequired"in h&&o(2,H=h.hideWhenRequired),"showWhenUntouched"in h&&o(3,w=h.showWhenUntouched),"$$scope"in h&&o(15,T=h.$$scope)},t.$$.update=()=>{var h,R;t.$$.dirty&16896&&o(7,n=((h=y[b])==null?void 0:h.touched)??{}),t.$$.dirty&16896&&o(13,i=((R=y[b])==null?void 0:R.errors)??{}),t.$$.dirty&12288&&o(6,r=_?i[_]:""),t.$$.dirty&8192&&o(5,f=i.required),t.$$.dirty&10240&&o(4,u=i[L])},[A,p,H,w,u,f,r,n,d,b,m,L,_,i,y,T,M]}class Ie extends G{constructor(e){super(),P(this,e,Ee,_e,Q,{for:9,form:10,class:0,id:1,on:11,hideWhen:12,hideWhenRequired:2,showWhenUntouched:3})}}const be=t=>({form:t&1}),D=t=>({form:t[0]});function ge(t){let e;const o=t[3].default,n=X(o,t,t[2],D);return{c(){n&&n.c()},l(i){n&&n.l(i)},m(i,r){n&&n.m(i,r),e=!0},p(i,[r]){n&&n.p&&(!e||r&5)&&Y(n,o,i,i[2],e?$(o,i[2],r,be):x(i[2]),D)},i(i){e||(g(n,i),e=!0)},o(i){k(n,i),e=!1},d(i){n&&n.d(i)}}}function ye(t,e,o){let{$$slots:n={},$$scope:i}=e,{form:r="svelte-use-form"}=e,{for:f=""}=e;return ee(`${r}_hint-group-name`,f),t.$$set=u=>{"form"in u&&o(0,r=u.form),"for"in u&&o(1,f=u.for),"$$scope"in u&&o(2,i=u.$$scope)},[r,f,i,n]}class We extends G{constructor(e){super(),P(this,e,ye,ge,Q,{form:0,for:1})}}const Le=()=>/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),te="svelte-use-form-webkit-autofill",Ce=`
@keyframes ${te} {
    from {}
}

input:-webkit-autofill {
    animation-name: svelte-use-form-webkit-autofill;
}
`;function ke(){if(document.getElementById("svelte-use-form-chrome-autofill-styles")===null){const t=document.createElement("style");t.setAttribute("id","svelte-use-form-chrome-autofill-styles"),t.setAttribute("type","text/css"),t.appendChild(document.createTextNode(Ce)),document.head.appendChild(t)}}function we(t,e,o){if(!Le())return;function n(i){i.animationName.includes(te)&&(t.value||(e.valid=!0,o()))}t.addEventListener("animationstart",n),ke()}class V{constructor(e){v(this,"validators");v(this,"errors",{});v(this,"errorMap",{});v(this,"elements",[]);v(this,"valid",!0);v(this,"_touched",!1);v(this,"initial");v(this,"formRef");v(this,"_value","");this.formRef=e.formRef,this.validators=e.validators,this.errorMap=e.errorMap,this.initial=e.value,this.elements=e.elements,this.value=e.value}get value(){return this._value}get touched(){return this._touched}set value(e){this._value=e,this.validate()}set touched(e){this._touched=e,this.elements.forEach(o=>{e?o.classList.add("touched"):o.classList.remove("touched")})}error(e){this.errors={...e,...this.errors},this.valid=!1,this.formRef()._notifyListeners()}change(e){this.value=e,this.elements.forEach(o=>o.value=e)}validate(){let e=!0;this.errors={};for(const o of this.validators){const n=o(this.value,this.formRef());if(n){e=!1;for(const i of Object.entries(n)){let[r,f]=i;const u=this.errorMap[r];u&&(f=typeof u=="function"?u(f):u),this.errors[r]=f}}}return this.valid=e,this.elements.forEach(o=>o.setCustomValidity(e?"":"Field is invalid")),e}reset({value:e}={}){const o=e??this.initial;this.elements.forEach(n=>n.value=o),this.value=o,this.touched=!1,this.formRef()._notifyListeners()}}class S{constructor(e,o){v(this,"_notifyListeners");for(const[n,i]of Object.entries(e))this._addControl(n,i.initial,i.validators,[],i.errorMap);this._notifyListeners=o}static create(e,o){return new S(e,o)}get valid(){let e=!0;return this.forEachControl(o=>{o.valid||(e=!1)}),e}get touched(){let e=!0;return this.forEachControl(o=>{o.touched||(e=!1)}),e}get values(){let e={};return this.forEachControl((o,n)=>{e[n]=o.value}),e}set touched(e){this.forEachControl(o=>{o.touched=e}),this._notifyListeners()}reset(){this.forEachControl(e=>e.reset())}_addControl(e,o="",n=[],i=[],r={}){this[e]=new V({value:o,validators:n,elements:i,errorMap:r,formRef:()=>this})}forEachControl(e){for(const[o,n]of Object.entries(this))n instanceof V&&e(n,o)}}class Z extends Error{}function Me(t){return t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement}function W(t){return t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement}function ne(t){return t.hasAttribute("data-suf-ignore")&&t.getAttribute("data-suf-ignore")==="true"||t.getAttribute("data-suf-ignore")===!0}const ie=de([]);function Fe(t={},e="svelte-use-form"){const o=[];let n=[],i=S.create(t,d),r;f.subscribe=h,f.set=oe,ee(e,f);function f(l){return u(l),ie.update(s=>[...s,{node:l,form:i,notifyListeners:d}]),{update:()=>{},destroy:()=>{A(),r.disconnect()}}}function u(l){const s=[...C(l,"input")],a=[...C(l,"textarea")],c=[...C(l,"select")],E=[...s,...a];y(E),M(c),H([...E,...c]),T(l),d()}function y(l){for(const s of l){const a=s.name;let c=i[a];if(c)c.elements.push(s),s.type==="radio"&&s instanceof HTMLInputElement&&s.checked&&(c.initial=s.value);else{const E=Te(s);i._addControl(a,E,[],[s],{}),c=i[a]}switch(s.type){case"checkbox":case"radio":m(s,"click",_);break;default:w(s,c),p(s,c),m(s,"blur",_)}m(s,"input",L)}}function M(l){for(const s of l){const a=s.name,c=i[a];if(c)c.elements.push(s),w(s,c);else{const E=s.value;i._addControl(a,E,[],[s],{})}m(s,"input",L),m(s,"input",_),m(s,"blur",_)}}function T(l){r=new MutationObserver(b),r.observe(l,{childList:!0,subtree:!0})}function b(l){for(const s of l)if(s.type==="childList"){for(const a of s.addedNodes){if(!(W(a)&&!ne(a)))continue;const c=t[a.name];!i[a.name]&&c&&i._addControl(a.name,c.initial,c.validators,[],c.errorMap),Me(a)?y([a]):a instanceof HTMLSelectElement&&M([a])}for(const a of s.removedNodes){if(!(a instanceof HTMLElement))continue;(W(a)?[a]:Ae(a)).forEach(E=>{delete i[E.name],n=n.filter(se=>se.node!==E)})}}d()}function m(l,s,a){l.addEventListener(s,a),n.push({node:l,event:s,listener:a})}function A(){for(const{node:l,event:s,listener:a}of n)l.removeEventListener(s,a)}function p(l,s){we(l,s,d);function a(){return l.value!==s.initial?(_({target:l}),!0):!1}a()||setTimeout(()=>a(),100)}function L({target:l}){if(W(l)){const s=l.name,a=i[s];if(!a)throw new Z;let c;l.type==="checkbox"&&l instanceof HTMLInputElement?c=l.checked?"checked":"":c=l.value,a.value=c,d()}}function _({target:l}){if(W(l)){const s=i[l.name];if(!s)throw new Z;s.touched||L({target:l}),s.touched=!0,l.classList.add("touched"),d()}}function H(l){for(const s of Object.keys(t)){let a=!1;for(const c of l)s===c.name&&(a=!0);a||delete i[s]}}function w(l,s){s.initial&&(l.value=s.initial)}function d(){for(const l of o)l(i)}function h(l){return o.push(l),l(i),{unsubscribe:()=>R(l)}}function R(l){const s=o.indexOf(l);o.splice(s,1)}function oe(l){i=l,d()}return f}function Te(t){let e;return t.type==="radio"&&t instanceof HTMLInputElement?e=t.checked?t.value:"":t.type==="checkbox"&&t instanceof HTMLInputElement?e=t.checked?"checked":"":e=t.value,e}function C(t,e){return Array.from(t.getElementsByTagName(e)).filter(o=>!ne(o))}function Ae(t){const e=C(t,"input"),o=C(t,"textarea"),n=C(t,"select");return[...e,...o,...n]}function Ne(t,e){o();async function o(){const n=t.form;if(!n)throw new q("HTML element doesn't have an ancestral form");await he();const i=me(ie).find(f=>f.node===n);if(!i)throw new q("HTML form doesn't have a svelte-use-form binded. (use:form)");const r=i.form[t.name];if(!(r instanceof V))throw new q(`Form Control [${t.name}] doesn't exist.`);r.validators.push(...e),r.validate(),i.notifyListeners()}}class q extends Error{}function qe(t){return t.trim()?null:{required:"Required"}}function Ve(t){return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(t)?null:{email:{}}}export{We as H,Ie as a,Ve as e,qe as r,Fe as u,Ne as v};
